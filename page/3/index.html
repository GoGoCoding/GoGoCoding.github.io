<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"gogocoding.github.io","root":"/","scheme":"Muse","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Mobile developer, also want to be a Gopher">
<meta property="og:type" content="website">
<meta property="og:title" content="GoGoCoding">
<meta property="og:url" content="https://gogocoding.github.io/page/3/index.html">
<meta property="og:site_name" content="GoGoCoding">
<meta property="og:description" content="Mobile developer, also want to be a Gopher">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Hao Qi">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://gogocoding.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>GoGoCoding</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">GoGoCoding</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Code For Art</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/15.%20Digital%20Signatures,%20ECDSA%20and%20EdDSA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/15.%20Digital%20Signatures,%20ECDSA%20and%20EdDSA/" class="post-title-link" itemprop="url">15. Digital Signatures, ECDSA and EdDSA</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:26" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:26+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a href="https://en.wikipedia.org/wiki/Digital_signature" target="_blank" rel="noopener"><strong>Digital signatures</strong></a> (æ•°å­—ç­¾å)æ˜¯ä¸€ç§ç”¨äºç­¾åæ¶ˆæ¯å¹¶éªŒè¯æ¶ˆæ¯ç­¾åçš„åŠ å¯†å·¥å…·ï¼Œä»¥ä¾¿ä¸ºæ•°å­—æ¶ˆæ¯æˆ–ç”µå­æ–‡æ¡£æä¾›çœŸå®æ€§è¯æ˜ã€‚ æ•°å­—ç­¾åæä¾›ï¼š</p>
<ul>
<li>æ¶ˆæ¯è®¤è¯ï¼šæŸäº›å·²çŸ¥å‘ä»¶äººï¼ˆå¯†é’¥æ‰€æœ‰è€…ï¼‰å·²åˆ›å»ºå¹¶ç­¾åæ¶ˆæ¯çš„è¯æ˜ã€‚</li>
<li>ä¿¡æ¯å®Œæ•´æ€§ï¼šç­¾ååæ¶ˆæ¯æœªæ›´æ”¹çš„è¯æ˜ã€‚</li>
<li>ä¸å¯å¦è®¤ï¼šç­¾åä¸€æ—¦åˆ›å»ºï¼Œç­¾åäººå°±ä¸èƒ½æ‹’ç»æ–‡æ¡£çš„ç­¾åã€‚</li>
</ul>
<p>â€‹å¦‚ä»Šï¼Œæ•°å­—ç­¾ååœ¨å•†ä¸šå’Œé‡‘èè¡Œä¸šä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚ ç”¨äºæˆæƒé“¶è¡Œä»˜æ¬¾ï¼ˆæ±‡æ¬¾ï¼‰ï¼Œäº¤æ¢å·²ç­¾åçš„ç”µå­æ–‡ä»¶ï¼Œåœ¨å…¬å…±åŒºå—é“¾ç³»ç»Ÿä¸­ç­¾ç½²äº¤æ˜“ï¼ˆä¾‹å¦‚ç¡¬å¸ï¼Œä»£å¸æˆ–å…¶ä»–æ•°å­—èµ„äº§çš„è½¬è®©ï¼‰ï¼Œç­¾ç½²æ•°å­—åˆåŒä»¥åŠè®¸å¤šå…¶ä»–æƒ…å†µã€‚</p>
<p>â€‹æ•°å­—ç­¾åæ— æ³•è¯†åˆ«åˆ°åº•æ˜¯å“ªä¸ªäººåˆ›å»ºäº†ç‰¹å®šçš„ç­¾åã€‚ä½† å¯ä»¥ç»“åˆæ•°å­—è¯ä¹¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯¥è¯ä¹¦å°†å…¬é’¥æ‰€æœ‰è€…ä¸èº«ä»½ï¼ˆäººå‘˜ï¼Œç»„ç»‡ï¼Œç½‘ç«™æˆ–å…¶ä»–ï¼‰ç»‘å®šåœ¨ä¸€èµ·ã€‚ æŒ‰ç…§è®¾è®¡ï¼Œæ•°å­—ç­¾åä¼šå°†æ¶ˆæ¯ç»‘å®šåˆ°å…¬é’¥ï¼Œè€Œä¸æ˜¯æ•°å­—èº«ä»½ã€‚</p>
<h2 id="151-ç­¾åæ¶ˆæ¯å¹¶éªŒè¯ç­¾åå¦‚ä½•å·¥ä½œ"><a class="markdownIt-Anchor" href="#151-ç­¾åæ¶ˆæ¯å¹¶éªŒè¯ç­¾åå¦‚ä½•å·¥ä½œ"></a> 15.1 ç­¾åæ¶ˆæ¯å¹¶éªŒè¯ç­¾åï¼šå¦‚ä½•å·¥ä½œï¼Ÿ</h2>
<p>â€‹æ•°å­—ç­¾åæ–¹æ¡ˆé€šå¸¸ä½¿ç”¨å…¬å…±å¯†é’¥å¯†ç ç³»ç»Ÿï¼ˆä¾‹å¦‚RSAæˆ–ECCï¼‰å¹¶ä½¿ç”¨å…¬å…±/ç§æœ‰å¯†é’¥å¯¹ã€‚ æ¶ˆæ¯ç”±ç§é’¥ç­¾åï¼Œç­¾åç”±ç›¸åº”çš„å…¬é’¥éªŒè¯ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/digital%20signatures.png" alt="digital signatures -c" /></p>
<p>â€‹æ¶ˆæ¯ç”±å‘ä»¶äººä½¿ç”¨ç§é’¥ï¼ˆç­¾åå¯†é’¥ï¼‰ç­¾åã€‚é€šå¸¸å¯¹è¾“å…¥æ¶ˆæ¯è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œç„¶åé€šè¿‡ç­¾åç®—æ³•è®¡ç®—ç­¾åã€‚å¤§å¤šæ•°ç­¾åç®—æ³•éƒ½ä½¿ç”¨æ¶ˆæ¯å“ˆå¸Œ+ç­¾åå¯†é’¥æ‰§è¡ŒæŸç§è®¡ç®—ï¼Œè€Œå¦‚æœæ²¡æœ‰ç­¾åå¯†é’¥ï¼Œåˆ™æ— æ³•è®¡ç®—ç»“æœã€‚æ¶ˆæ¯ç­¾åçš„ç»“æœæ˜¯æ•°å­—ç­¾åã€‚<br />
â€‹<br />
<code>signMsg(msg, privKey) ğŸ¡’ signature</code></p>
<p>â€‹æ¶ˆæ¯ç­¾åé€šè¿‡ç›¸åº”çš„å…¬é’¥ï¼ˆéªŒè¯å¯†é’¥ï¼‰è¿›è¡ŒéªŒè¯ã€‚ é€šå¸¸å¯¹ç­¾åçš„æ¶ˆæ¯è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œå¹¶ä¸”ç­¾åç®—æ³•ä½¿ç”¨æ¶ˆæ¯å“ˆå¸Œ+å…¬é’¥æ¥æ‰§è¡Œä¸€äº›è®¡ç®—ã€‚ ç­¾åçš„ç»“æœæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆæœ‰æ•ˆæˆ–æ— æ•ˆç­¾åï¼‰ï¼š</p>
<p><code>verifyMsgSignature(msg, signature, pubKey) ğŸ¡’ valid / invalid</code></p>
<p>â€‹æ¶ˆæ¯ç­¾ååœ¨æ•°å­¦ä¸Šä¿è¯äº†æŸäº›æ¶ˆæ¯æ˜¯ç”±æŸä¸ªç§é’¥ç­¾åçš„ï¼Œè¯¥ç§é’¥å¯¹åº”äºæŸä¸ªå…¬é’¥ã€‚ æ¶ˆæ¯ç­¾ååï¼Œæ— æ³•ä¿®æ”¹æ¶ˆæ¯å’Œç­¾åï¼Œå› æ­¤å¯ä»¥ä¿è¯æ¶ˆæ¯çš„èº«ä»½éªŒè¯å’Œå®Œæ•´æ€§ã€‚ çŸ¥é“æ¶ˆæ¯ç­¾åè€…å…¬é’¥çš„ä»»ä½•äººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚ç­¾ååï¼Œç­¾åä½œè€…ä¸èƒ½æ‹’ç»ç­¾åè¡Œä¸ºï¼ˆè¿™ç§°ä¸ºä¸å¯å¦è®¤æ€§ï¼‰ã€‚</p>
<p>â€‹ä¸‹å›¾æ˜¾ç¤ºäº†å¤§å¤šæ•°ç­¾åæ–¹æ¡ˆçš„å·¥ä½œæ–¹å¼ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/signature%20schemes.png" alt="signature schemes -c" /></p>
<p>â€‹ç­¾åæ—¶ï¼Œå°†å¯¹è¾“å…¥æ¶ˆæ¯è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼ˆå•ç‹¬æˆ–ä¸å…¬é’¥å’Œå…¶ä»–è¾“å…¥å‚æ•°ä¸€èµ·è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼‰ï¼Œç„¶åè¿›è¡Œä¸€äº›è®¡ç®—ï¼ˆåŸºäºæ¤­åœ†æ›²çº¿ï¼Œç¦»æ•£å¯¹æ•°æˆ–å…¶ä»–å¯†ç åŸè¯­ï¼‰ä»¥è®¡ç®—æ•°å­—ç­¾åã€‚ äº§ç”Ÿçš„å·²ç­¾åæ¶ˆæ¯ç”±åŸå§‹æ¶ˆæ¯+è®¡ç®—å‡ºçš„ç­¾åç»„æˆã€‚</p>
<p>â€‹åœ¨ç­¾åéªŒè¯æ—¶ï¼Œå°†å¯¹éªŒè¯æ¶ˆæ¯è¿›è¡Œæ•£åˆ—ï¼ˆå•ç‹¬æˆ–ä¸å…¬é’¥ä¸€èµ·è¿›è¡Œæ•£åˆ—ï¼‰ï¼Œå¹¶åœ¨æ¶ˆæ¯æ•£åˆ—ï¼Œæ•°å­—ç­¾åå’Œå…¬é’¥ä¹‹é—´æ‰§è¡Œä¸€äº›è®¡ç®—ï¼Œæœ€åç”±æ¯”è¾ƒç¡®å®šç­¾åæ˜¯å¦æœ‰æ•ˆ ã€‚</p>
<p>â€‹æ•°å­—ç­¾åä¸MACï¼ˆæ¶ˆæ¯èº«ä»½éªŒè¯ä»£ç ï¼‰ä¸åŒï¼Œå› ä¸ºMACæ˜¯ä½¿ç”¨å¯¹ç§°ç®—æ³•ç”±åŒä¸€ç§˜å¯†å¯†é’¥åˆ›å»ºå’ŒéªŒè¯çš„ï¼Œè€Œæ•°å­—ç­¾åæ˜¯ç”±ç­¾åå¯†é’¥åˆ›å»ºå¹¶ç”±ä¸ç­¾åç›¸å¯¹åº”çš„ä¸åŒéªŒè¯å¯†é’¥è¿›è¡ŒéªŒè¯çš„ ä½¿ç”¨éå¯¹ç§°ç®—æ³•çš„å¯†é’¥ã€‚ ç­¾åå’ŒMACä»£ç éƒ½æä¾›æ¶ˆæ¯èº«ä»½éªŒè¯å’Œå®Œæ•´æ€§ã€‚</p>
<h2 id="152-æ•°å­—ç­¾åæ–¹æ¡ˆå’Œç®—æ³•"><a class="markdownIt-Anchor" href="#152-æ•°å­—ç­¾åæ–¹æ¡ˆå’Œç®—æ³•"></a> 15.2 æ•°å­—ç­¾åæ–¹æ¡ˆå’Œç®—æ³•</h2>
<p>â€‹åƒRSAå’ŒECCè¿™æ ·çš„å¤§å¤šæ•°éå¯¹ç§°åŠ å¯†ç³»ç»Ÿéƒ½æä¾›å®‰å…¨çš„æ•°å­—ç­¾åæ–¹æ¡ˆï¼ˆç­¾åç®—æ³•ï¼‰ã€‚ ä¼—æ‰€å‘¨çŸ¥çš„æ•°å­—ç­¾åæ–¹æ¡ˆæœ‰ï¼š <a href="https://en.wikipedia.org/wiki/Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>DSA</strong></a>, <a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>ECDSA</strong></a>, <a href="https://en.wikipedia.org/wiki/EdDSA" target="_blank" rel="noopener"><strong>EdDSA</strong></a>, <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Signing_messages" target="_blank" rel="noopener"><strong>RSA signatures</strong></a>, <a href="https://en.wikipedia.org/wiki/ElGamal_signature_scheme" target="_blank" rel="noopener"><strong>ElGamal signatures</strong></a> and <a href="https://en.wikipedia.org/wiki/Schnorr_signature" target="_blank" rel="noopener"><strong>Schnorr signatures</strong></a></p>
<p>â€‹ä¸Šé¢æåˆ°çš„ç­¾åæ–¹æ¡ˆåŸºäºDLPï¼ˆç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰å’ŒECDLPï¼ˆæ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰çš„éš¾æ˜“ç¨‹åº¦ï¼Œå¹¶ä¸”æ˜¯é‡å­æ˜“ç¢çš„ï¼ˆè¶³å¤Ÿå¼ºå¤§çš„é‡å­è®¡ç®—æœºå¯ä»¥ä»æ¶ˆæ¯ç­¾åä¸­è®¡ç®—ç­¾åå¯†é’¥ï¼‰ã€‚ é‡å­å®‰å…¨ç­¾åï¼ˆå¦‚SPHINCSï¼ŒBLISSå’ŒXMSSï¼‰ç”±äºä¸ECDSAå’ŒEdDSAç›¸æ¯”å…·æœ‰è¾ƒé•¿çš„å¯†é’¥é•¿åº¦ï¼Œè¾ƒé•¿çš„ç­¾åå’Œè¾ƒæ…¢çš„æ€§èƒ½è€Œæœªå¾—åˆ°å¹¿æ³›ä½¿ç”¨ã€‚</p>
<p>â€‹æœ€å—æ¬¢è¿çš„æ•°å­—ç­¾åæ–¹æ¡ˆæœ‰ï¼š<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Signing_messages" target="_blank" rel="noopener"><strong>RSA signatures</strong></a>, <a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>ECDSA</strong></a> and <a href="https://en.wikipedia.org/wiki/EdDSA" target="_blank" rel="noopener"><strong>EdDSA</strong></a>ã€‚</p>
<h3 id="1521-rsa-signatures"><a class="markdownIt-Anchor" href="#1521-rsa-signatures"></a> 15.2.1 RSA Signatures</h3>
<p>â€‹RSAå…¬é’¥å¯†ç ç³»ç»ŸåŸºäºæ¨¡å¹‚å’Œç¦»æ•£å¯¹æ•°çš„æ•°å­¦ä»¥åŠæ•´æ•°åˆ†è§£é—®é¢˜ï¼ˆIFPï¼‰çš„éš¾åº¦ï¼Œæä¾›äº†ä¸€ç§å¯†ç å®‰å…¨çš„æ•°å­—ç­¾åæ–¹æ¡ˆï¼ˆç­¾å+éªŒè¯ï¼‰ã€‚<br />
â€‹<br />
â€‹<strong>RSAç­¾å/éªŒè¯è¿‡ç¨‹å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>RSAç­¾åç®—æ³•è®¡ç®—æ¶ˆæ¯å“ˆå¸Œï¼Œç„¶åä½¿ç”¨ç§é’¥æŒ‡æ•°åŠ å¯†å“ˆå¸Œä»¥è·å–ç­¾åã€‚ è·å¾—çš„ç­¾åæ˜¯æ•´æ•°ï¼ˆRSAåŠ å¯†çš„æ¶ˆæ¯å“ˆå¸Œï¼‰ã€‚</li>
<li>RSAéªŒè¯ç®—æ³•é¦–å…ˆè®¡ç®—æ¶ˆæ¯å“ˆå¸Œï¼Œç„¶åä½¿ç”¨å…¬é’¥æŒ‡æ•°è§£å¯†æ¶ˆæ¯ç­¾åï¼Œç„¶åå°†è·å¾—çš„è§£å¯†å“ˆå¸Œä¸ç­¾åæ¶ˆæ¯çš„å“ˆå¸Œè¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®ä¿ç­¾åæœ‰æ•ˆã€‚</li>
</ul>
<p><strong>â€‹RSAç­¾åæ˜¯ç¡®å®šæ€§çš„</strong>ï¼ˆç›¸åŒçš„æ¶ˆæ¯+ç›¸åŒçš„ç§é’¥ä¼šäº§ç”Ÿç›¸åŒçš„ç­¾åï¼‰ã€‚é€šè¿‡åœ¨ç­¾åä¹‹å‰ç”¨ä¸€äº›éšæœºå­—èŠ‚å¡«å……è¾“å…¥æ¶ˆæ¯ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°è®¾è®¡å‡ºRSAç­¾åçš„éç¡®å®šæ€§å˜ä½“ã€‚</p>
<p>â€‹RSAç­¾åå¹¿æ³›ç”¨äºç°ä»£åŠ å¯†æŠ€æœ¯ä¸­ï¼Œä¾‹å¦‚ ç”¨äºç­¾ç½²æ•°å­—è¯ä¹¦ä»¥ä¿æŠ¤ç½‘ç«™ã€‚ ä¾‹å¦‚ï¼Œå¾®è½¯å®˜æ–¹ç½‘ç«™ä½¿ç”¨Sha256RSAä½œä¸ºå…¶æ•°å­—è¯ä¹¦ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œæœ€è¿‘åå¹´çš„è¶‹åŠ¿æ˜¯ä»RSAå’ŒDSAè½¬å‘åŸºäºæ¤­åœ†æ›²çº¿çš„ç­¾åï¼ˆå¦‚ECDSAå’ŒEdDSAï¼‰ã€‚ç°ä»£å¯†ç å­¦å®¶å’Œå¼€å‘äººå‘˜æ›´å–œæ¬¢ECCç­¾åï¼Œå› ä¸ºå®ƒä»¬å…·æœ‰è¾ƒçŸ­çš„å¯†é’¥é•¿åº¦ï¼Œè¾ƒçŸ­çš„ç­¾åï¼Œè¾ƒé«˜çš„å®‰å…¨æ€§ï¼ˆå¯¹äºç›¸åŒçš„å¯†é’¥é•¿åº¦ï¼‰å’Œæ›´å¥½çš„æ€§èƒ½ã€‚</p>
<h3 id="1522-dsaæ•°å­—ç­¾åç®—æ³•"><a class="markdownIt-Anchor" href="#1522-dsaæ•°å­—ç­¾åç®—æ³•"></a> 15.2.2 DSAï¼ˆæ•°å­—ç­¾åç®—æ³•ï¼‰</h3>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>DSA (Digital Signature Algorithm)</strong></a> æ˜¯ç”¨äºæ•°å­—ç­¾åï¼ˆç­¾åæ¶ˆæ¯å’Œç­¾åéªŒè¯ï¼‰çš„åŠ å¯†å®‰å…¨æ ‡å‡†ã€‚ç”±äºRSAçš„ä¸“åˆ©é™åˆ¶ï¼ˆåˆ°2000å¹´9æœˆï¼‰ï¼Œå®ƒæ˜¯RSAçš„æ›¿ä»£å“ï¼Œå¹¶ä¸”ä»£æ›¿äº†RSAã€‚DSAæ˜¯<a href="https://en.wikipedia.org/wiki/ElGamal_signature_scheme" target="_blank" rel="noopener"><strong>ElGamal</strong></a>ç­¾åæ–¹æ¡ˆçš„å˜ä½“ã€‚<br />
â€‹<br />
<strong>â€‹DSAç­¾å/éªŒè¯è¿‡ç¨‹å¦‚ä¸‹</strong>ï¼š</p>
<ul>
<li>DSAç­¾åç®—æ³•è®¡ç®—æ¶ˆæ¯å“ˆå¸Œï¼Œç„¶åç”Ÿæˆéšæœºæ•´æ•°kå¹¶è®¡ç®—ç­¾åï¼ˆæ•´æ•°å¯¹{rï¼Œs}ï¼‰ï¼Œå…¶ä¸­ræ˜¯ä»kè®¡ç®—çš„ï¼Œè€Œsæ˜¯ä½¿ç”¨ æ¶ˆæ¯å“ˆå¸Œ + ç§é’¥æŒ‡æ•° + éšæœºæ•°kè®¡ç®—çš„ã€‚ ç”±äºéšæœºæ€§ï¼Œç­¾åæ˜¯ä¸ç¡®å®šçš„ã€‚</li>
<li>DSAç­¾åéªŒè¯ç®—æ³•æ¶‰åŠåŸºäº æ¶ˆæ¯å“ˆå¸Œ + å…¬é’¥æŒ‡æ•° + ç­¾å{rï¼Œs}çš„è®¡ç®—ã€‚</li>
</ul>
<p>â€‹éšæœºå€¼kï¼ˆåœ¨è®¡ç®—ç­¾åæ—¶ç”Ÿæˆï¼‰ä¼šå¸¦æ¥æ½œåœ¨çš„æ¼æ´ï¼šå¦‚æœä½¿ç”¨ç›¸åŒçš„kå€¼å’Œç›¸åŒçš„ç§é’¥å¯¹ä¸¤ä¸ªä¸åŒçš„æ¶ˆæ¯è¿›è¡Œç­¾åï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç›´æ¥è®¡ç®—ç­¾åè€…çš„ç§é’¥(see <a href="https://github.com/tintinweb/ecdsa-private-key-recovery" target="_blank" rel="noopener">https://github.com/tintinweb/ecdsa-private-key-recovery</a>)ã€‚</p>
<p>â€‹<a href="https://tools.ietf.org/html/rfc6979" target="_blank" rel="noopener"><strong>RFC 6979</strong></a>ä¸­å®šä¹‰äº†<strong>deterministic-DSA</strong>å˜ä½“ï¼Œè¯¥å˜ä½“æ ¹æ®ç§é’¥ï¼Œæ¶ˆæ¯å“ˆå¸Œå’Œå…¶ä»–ä¸€äº›å‚æ•°å°†éšæœºæ•°kè®¡ç®—ä¸ºHMACã€‚ <strong>deterministic-DSA</strong>è¢«è®¤ä¸ºæ›´å®‰å…¨ã€‚</p>
<h4 id="ecdsaæ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•"><a class="markdownIt-Anchor" href="#ecdsaæ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•"></a> ECDSAï¼ˆæ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•ï¼‰</h4>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>ECDSA</strong></a>ï¼ˆElliptic Curve Digital Signature Algorithmï¼‰æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•æ˜¯ä¸€ç§åŸºäºæ¤­åœ†æ›²çº¿å¯†ç ï¼ˆECCï¼‰çš„å¯†ç å®‰å…¨æ•°å­—ç­¾åæ–¹æ¡ˆã€‚</p>
<p>â€‹ECDSAæ˜¯å¯¹ç»å…¸DSAç®—æ³•çš„æ”¹ç¼–ï¼Œè¯¥ç®—æ³•æ˜¯ä»ElGamalç­¾åæ–¹æ¡ˆæ´¾ç”Ÿçš„ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼ŒECDSAç®—æ³•æ˜¯ElGamalç­¾åçš„ä¸€ç§å˜ä½“ï¼Œè¿›è¡Œäº†ä¸€äº›æ›´æ”¹å’Œä¼˜åŒ–ï¼Œä»¥å¤„ç†ç¾¤å…ƒç´ ï¼ˆæ¤­åœ†æ›²çº¿çš„ç‚¹ï¼‰çš„è¡¨ç¤ºå½¢å¼ã€‚ECDSAä½¿ç”¨æ¤­åœ†æ›²çº¿ï¼ˆå¦‚secp256k1ï¼‰ï¼Œç§é’¥ï¼ˆæ›²çº¿å¯†é’¥é•¿åº¦å†…çš„éšæœºæ•´æ•°-ç”¨äºç­¾åæ¶ˆæ¯ï¼‰å’Œå…¬é’¥ï¼ˆECç‚¹ï¼Œé€šè¿‡å°†ç§é’¥ä¹˜ä»¥æ›²çº¿ç”Ÿæˆå™¨ç‚¹ä»ç§é’¥è®¡ç®—å¾—å‡ºçš„ECç‚¹ï¼‰ä»¥éªŒè¯ç­¾å ï¼‰ã€‚<br />
â€‹<br />
<strong>â€‹ECDSAç­¾å/éªŒè¯è¿‡ç¨‹å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>ECDSAç­¾åç®—æ³•è®¡ç®—æ¶ˆæ¯å“ˆå¸Œï¼Œç„¶åç”Ÿæˆéšæœºæ•´æ•°kå¹¶è®¡ç®—ç­¾åï¼ˆä¸€å¯¹æ•´æ•°{rï¼Œs}ï¼‰ï¼Œå…¶ä¸­ræ˜¯ä»kè®¡ç®—çš„ï¼Œè€Œsæ˜¯ä½¿ç”¨æ¶ˆæ¯å“ˆå¸Œ + ç§é’¥ + éšæœºæ•°kæ¥è®¡ç®—çš„ã€‚ ç”±äºéšæœºæ€§ï¼Œç­¾åæ˜¯ä¸ç¡®å®šçš„ã€‚</li>
<li>ECDSAç­¾åéªŒè¯ç®—æ³•æ¶‰åŠåŸºäº æ¶ˆæ¯å“ˆå¸Œ + å…¬é’¥ + ç­¾å{rï¼Œs}çš„è®¡ç®—ã€‚</li>
</ul>
<p>â€‹éšæœºå€¼kï¼ˆåœ¨è®¡ç®—ç­¾åæ—¶ç”Ÿæˆï¼‰ä¼šå¸¦æ¥æ½œåœ¨çš„æ¼æ´ï¼šå¦‚æœä½¿ç”¨ç›¸åŒçš„kå€¼å’Œç›¸åŒçš„ç§é’¥å¯¹ä¸¤ä¸ªä¸åŒçš„æ¶ˆæ¯è¿›è¡Œç­¾åï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç›´æ¥è®¡ç®—ç­¾åè€…çš„ç§é’¥(see <a href="https://github.com/tintinweb/ecdsa-private-key-recovery" target="_blank" rel="noopener">https://github.com/tintinweb/ecdsa-private-key-recovery</a>).</p>
<p>â€‹<strong>deterministic-ECDSA</strong> å˜ä½“åœ¨<a href="https://tools.ietf.org/html/rfc6979" target="_blank" rel="noopener"><strong>RFC 6979</strong></a>ä¸­å®šä¹‰ï¼Œè¯¥å˜ä½“æ ¹æ®ç§é’¥+æ¶ˆæ¯å“ˆå¸Œ+å…¶ä»–ä¸€äº›å‚æ•°å°†éšæœºæ•°kè®¡ç®—ä¸ºHMACã€‚ <strong>deterministic-ECDSA</strong>è¢«è®¤ä¸ºæ›´å®‰å…¨ã€‚</p>
<p>â€‹ECDSAç­¾åæ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„ç­¾åç®—æ³•ï¼Œæ¯å¤©æœ‰æ•°ç™¾ä¸‡äººä½¿ç”¨ã€‚ ä¾‹å¦‚ï¼ŒAmazonç½‘ç«™ä¸­çš„æ•°å­—è¯ä¹¦ç”±Sha256ECDSAç­¾åæ–¹æ¡ˆç­¾åã€‚</p>
<p>â€‹</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/14.%20ECIES%20(Elliptic%20Curve%20Integrated%20Encryption%20Scheme)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/14.%20ECIES%20(Elliptic%20Curve%20Integrated%20Encryption%20Scheme)/" class="post-title-link" itemprop="url">14. ECIES (Elliptic Curve Integrated Encryption Scheme)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:25" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:25+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹åœ¨è®¸å¤šåŠ å¯†æ ‡å‡†å¦‚<a href="http://www.secg.org/sec1-v2.pdf" target="_blank" rel="noopener">SECG SEC-1</a>, <a href="https://www.shoup.net/iso/std4.pdf" target="_blank" rel="noopener">ISO/IEC 18033-2</a>, <a href="http://grouper.ieee.org/groups/1722/contributions/2012/1722a-butterworth-ieee1363.pdf" target="_blank" rel="noopener">IEEE 1363a</a> and <a href="ftp://ftp.iks-jena.de/mitarb/lutz/standards/ansi/X9/x963-7-5-98.pdf" target="_blank" rel="noopener">ANSI X9.63</a>ä¸­ï¼Œç±»ä¼¼äºå…ˆå‰æ¼”ç¤ºçš„ä»£ç çš„æ··åˆåŠ å¯†æ–¹æ¡ˆéƒ½ä»¥æ¤­åœ†æ›²çº¿é›†æˆåŠ å¯†æ–¹æ¡ˆï¼ˆECIESï¼‰çš„åç§°è¿›è¡Œäº†æ ‡å‡†åŒ–ã€‚ECIESæ˜¯ä¸€ç§ç»è¿‡å…¬é’¥è®¤è¯çš„åŠ å¯†æ–¹æ¡ˆï¼Œå…¶å·¥ä½œåŸç†ä¸ä¸Šè¿°ä»£ç ç¤ºä¾‹ç›¸ä¼¼ï¼Œä½†æ˜¯ä½¿ç”¨KDFï¼ˆå¯†é’¥ç”Ÿæˆå‡½æ•°ï¼‰ç”Ÿæˆå„è‡ªçš„MACå¯†é’¥ï¼Œä»ECDHå…±äº«å¯¹ç§°åŠ å¯†å¯†é’¥ã€‚<br />
â€‹<br />
â€‹ç®€å•æ¥è¯´åŠ å¯†æ—¶ä¸ºï¼š ä½¿ç”¨å‘é€è€…çš„ç§é’¥å’Œæ¥å—è€…çš„å…¬é’¥ç”ŸæˆåŠ å¯†å¯†é’¥ekå’ŒMACå¯†é’¥mkï¼Œç”¨ekå¯¹æ˜æ–‡MåŠ å¯†å¾—åˆ°å¯†æ–‡cï¼Œä½¿ç”¨mkç”Ÿæˆå¯†æ–‡cçš„æ ‡ç­¾ã€‚å°†å‘é€è€…çš„å…¬é’¥ï¼Œå¯†æ–‡cå’Œæ ‡ç­¾ä¸€èµ·å‘é€ç»™æ¥å—è€…ã€‚ï¼ˆä¹Ÿå¯åœ¨ç”Ÿæˆå¯†é’¥å’Œæ ‡ç­¾çš„æ­¥éª¤åŠ å…¥å…±äº«æ¶ˆæ¯ï¼‰<br />
è§£å¯†æ—¶ï¼šæ¥å—è€…æ”¶åˆ°å‘é€è€…å‘é€çš„å…¬é’¥ï¼Œå¯†æ–‡cå’Œæ ‡ç­¾ï¼ŒåŠ å…¥è‡ªå·±çš„ç§é’¥ï¼Œå³å¯ç”ŸæˆåŠ å¯†å¯†é’¥ekå’ŒMACå¯†é’¥mkï¼Œä½¿ç”¨ekå¯¹å¯†æ–‡cè§£å¯†ï¼Œå¾—åˆ°æ¶ˆæ¯Mã€‚</p>
<p>â€‹ECIESæ ‡å‡†å°†åŸºäºECCçš„éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°å¯†ç ç›¸ç»“åˆï¼Œä»¥é€šè¿‡ECç§é’¥æä¾›æ•°æ®åŠ å¯†ï¼Œå¹¶é€šè¿‡ç›¸åº”çš„ECå…¬é’¥è¿›è¡Œè§£å¯†ã€‚æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/ecies%20encryption.png" alt="ecies encryption -c" /></p>
<p>â€‹ECIESåŠ å¯†çš„è¾“å…¥ç”±æ”¶ä»¶äººçš„<strong>public key</strong> + <strong>plain text message ** (å…¬é’¥ + çº¯æ–‡æœ¬æ¶ˆæ¯)ç»„æˆã€‚ è¾“å‡ºåŒ…æ‹¬å‘ä»¶äººçš„</strong>ephemeral public key**  + <strong>encrypted message</strong>  + <strong>authentication tag</strong>  (ä¸´æ—¶å…¬å…±å¯†é’¥ + å¯†æ–‡ + èº«ä»½éªŒè¯æ ‡ç­¾ï¼‰ï¼š</p>
<ul>
<li><code>ECIES-encrypt(recipientPublicKey, plaintextMessage)</code> â” <code>{ cipherTextPublicKey, encryptedMessage, authTag }</code></li>
</ul>
<p>â€‹ECIESè§£å¯†ä»åŠ å¯†ä¿¡æ¯+æ”¶ä»¶äººçš„ç§é’¥ä¸­è·å–è¾“å‡ºï¼Œå¹¶äº§ç”ŸåŸå§‹çš„çº¯æ–‡æœ¬æ¶ˆæ¯æˆ–æ£€æµ‹åˆ°é—®é¢˜ã€‚</p>
<ul>
<li><code>ECIES-decrypt(cipherTextPublicKey, encryptedMessage, authTag, recipientPrivateKey )</code> â”  <code>plaintextMessage</code></li>
</ul>
<p>â€‹ECIESåŠ å¯†æ–¹æ¡ˆæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç®—æ³•ã€‚ å®ƒå¯ä»¥é€šè¿‡æ’å…¥ä¸åŒçš„ç®—æ³•æ¥å®ç°ï¼Œä¾‹å¦‚ ç”¨äºå…¬é’¥è®¡ç®—çš„secp256k1æˆ–P-521æ¤­åœ†æ›²çº¿+ç”¨äºKDFå‡½æ•°çš„PBKDF2æˆ–Scrypt + ç”¨äºå¯¹ç§°å¯†ç å’Œèº«ä»½éªŒè¯æ ‡ç­¾çš„AES-CTRæˆ–AES-GCMæˆ–ChaCha20-Poly1305 +MAC ç®—æ³• HMAC-SHA512 (å¯¹äºæœªç»èº«ä»½éªŒè¯çš„åŠ å¯†ï¼‰ã€‚</p>
<h2 id="141-eciesæ¤­åœ†æ›²çº¿é›†æˆåŠ å¯†æ–¹æ¡ˆ-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#141-eciesæ¤­åœ†æ›²çº¿é›†æˆåŠ å¯†æ–¹æ¡ˆ-ç¤ºä¾‹"></a> 14.1 ECIESï¼ˆæ¤­åœ†æ›²çº¿é›†æˆåŠ å¯†æ–¹æ¡ˆï¼‰-ç¤ºä¾‹</h2>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install eciespy</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ECIESç”Ÿæˆå…¬é’¥/ç§é’¥å¯¹å¹¶åŠ å¯†å’Œè§£å¯†æ¶ˆæ¯çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ecies.utils <span class="keyword">import</span> generate_eth_key</span><br><span class="line"><span class="keyword">from</span> ecies <span class="keyword">import</span> encrypt, decrypt</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">privKey = generate_eth_key()</span><br><span class="line">privKeyHex = privKey.to_hex()</span><br><span class="line">pubKeyHex = privKey.public_key.to_hex()</span><br><span class="line">print(<span class="string">"Encryption public key:"</span>, pubKeyHex)</span><br><span class="line">print(<span class="string">"Decryption private key:"</span>, privKeyHex)</span><br><span class="line"></span><br><span class="line">plaintext = <span class="string">b'Some plaintext for encryption'</span></span><br><span class="line">print(<span class="string">"Plaintext:"</span>, plaintext)</span><br><span class="line"></span><br><span class="line">encrypted = encrypt(pubKeyHex, plaintext)</span><br><span class="line">print(<span class="string">"Encrypted:"</span>, binascii.hexlify(encrypted))</span><br><span class="line"></span><br><span class="line">decrypted = decrypt(privKeyHex, encrypted)</span><br><span class="line">print(<span class="string">"Decrypted:"</span>, decrypted)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Encryption public key: 0x0dc8e06c055b45ecf110258ed5c0261ce2019b1bd0f8f226dcd010dade448b8f304a0915c68cdf7ddded8e4021d28fb92e27d08df695f48a0d2c41ddee750fc7</span><br><span class="line">Decryption private key: 0x487fd8b53c471e3c38484a0fbe4751ace67a9ed28e60ea6b0b44c445b881f99d</span><br><span class="line">Plaintext: b&#39;Some plaintext for encryption&#39;</span><br><span class="line">Encrypted: b&#39;045699078bbd101e270572d0d68e87a8f7b6cc377ebeeffb60d2fcac5dc7bdd86a26d7f79d13b92e923a0e2cdbe418a7856b27157ef150d5c72f4f8f312467d13221ebe7049b7ed2f0ed253bce13117129a7b01bb881b8dfbf004ff11f3ebed4c732744bc49ea03230c2d1b2ec80774e79c075431d2019464d3de97ceb96&#39;</span><br><span class="line">Decrypted: b&#39;Some plaintext for encryption&#39;</span><br></pre></td></tr></table></figure>
<p>â€‹æ³¨æ„ï¼Œä»¥ä¸ŠåŠ å¯†çš„æ¶ˆæ¯åŒ…å«4ä¸ªå€¼ï¼š{cipherPubKeyï¼ŒAES-nonceï¼ŒauthTagï¼ŒAES-ciphertext}ï¼Œå®ƒä»¬ä»¥äºŒè¿›åˆ¶å½¢å¼æ‰“åŒ…å¹¶ä¸”ä¸èƒ½ä»ä¸Šè¿°è¾“å‡ºä¸­ç›´æ¥çœ‹åˆ°ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/13.%20ECC-Based%20Encryption%20-%20Decryption/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/13.%20ECC-Based%20Encryption%20-%20Decryption/" class="post-title-link" itemprop="url">13. ECC-Based Encryption / Decryption</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:24" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:24+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è§£é‡Šå¦‚ä½•å®ç°åŸºäºæ¤­åœ†æ›²çº¿çš„å…¬é’¥åŠ å¯†å’Œå¯¹åº”çš„è§£å¯†ï¼ˆåŸºäºECCçš„éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼‰ã€‚ è¿™é€šå¸¸æ¶‰åŠæ··åˆåŠ å¯†æ–¹æ¡ˆçš„è®¾è®¡ï¼ŒåŒ…æ‹¬ECCå¯†ç å­¦ï¼ŒECDHå¯†é’¥äº¤æ¢å’Œå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚</p>
<p>â€‹å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå…¬ç§é’¥å¯¹ã€‚ æˆ‘ä»¬æƒ³ä½¿ç”¨è¿™äº›å¯†é’¥æ¥åŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚ æ ¹æ®å®šä¹‰ï¼Œéå¯¹ç§°åŠ å¯†çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼šå¦‚æœæˆ‘ä»¬é€šè¿‡ç§é’¥åŠ å¯†æ•°æ®ï¼Œåˆ™ç¨åæˆ‘ä»¬å°†èƒ½å¤Ÿé€šè¿‡ç›¸åº”çš„å…¬é’¥è§£å¯†å¯†æ–‡ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/ecc%20asymmetric%20encryption.png" alt="ecc asymmetric encryption -c400" /></p>
<p>â€‹ä¸Šè¿°è¿‡ç¨‹å¯ä»¥ç›´æ¥åº”ç”¨äºRSAå¯†ç ç³»ç»Ÿï¼Œä½†ä¸èƒ½åº”ç”¨äºECCã€‚ æ¤­åœ†æ›²çº¿å¯†ç å­¦ï¼ˆECCï¼‰ä¸ç›´æ¥æä¾›åŠ å¯†æ–¹æ³•ã€‚ ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ECDHï¼ˆæ¤­åœ†æ›²çº¿Diffie-Hellmanï¼‰å¯†é’¥äº¤æ¢æ–¹æ¡ˆæ¥è®¾è®¡æ··åˆåŠ å¯†æ–¹æ¡ˆï¼Œä»¥å¯¼å‡ºç”¨äºå¯¹ç§°æ•°æ®åŠ å¯†å’Œè§£å¯†çš„å…±äº«å¯†é’¥ã€‚</p>
<p>â€‹å¤§å¤šæ•°æ··åˆåŠ å¯†æ–¹æ¡ˆçš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼ˆåŠ å¯†è¿‡ç¨‹ï¼‰ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/hybrid%20encryption%20schemes.png" alt="hybrid encryption schemes -c" /></p>
<p>â€‹è¿™æ˜¯å¤§å¤šæ•°æ··åˆåŠ å¯†æ–¹æ¡ˆçš„å·¥ä½œæ–¹å¼ï¼ˆè§£å¯†è¿‡ç¨‹ï¼‰ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/hybrid%20dencryption%20schemes.png" alt="hybrid dencryption schemes -c" /></p>
<p>ä¸‹é¢è®©æˆ‘ä»¬è¯¦ç»†ä»‹ç»å¦‚ä½•è®¾è®¡å’Œå®ç°åŸºäºECCçš„æ··åˆåŠ å¯†æ–¹æ¡ˆã€‚</p>
<h2 id="131-åŸºäºeccçš„å¯†é’¥æ´¾ç”Ÿä½¿ç”¨ecdh"><a class="markdownIt-Anchor" href="#131-åŸºäºeccçš„å¯†é’¥æ´¾ç”Ÿä½¿ç”¨ecdh"></a> 13.1 åŸºäºECCçš„å¯†é’¥æ´¾ç”Ÿï¼ˆä½¿ç”¨ECDHï¼‰</h2>
<p>â€‹å‡è®¾æˆ‘ä»¬åœ¨æœ‰é™åŸŸä¸Šå…·æœ‰ä¸€æ¡åŠ å¯†æ¤­åœ†æ›²çº¿åŠå…¶ç”Ÿæˆå™¨ç‚¹Gã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°æ¥è®¡ç®—ç”¨äºåŠ å¯†å’Œè§£å¯†çš„å…±äº«ç§˜å¯†å¯†é’¥ï¼ˆæºè‡ªECDHæ–¹æ¡ˆï¼‰ï¼š</p>
<ul>
<li>
<p><strong>calculateEncryptionKey</strong>(pubKey) --&gt; (sharedECCKey, ciphertextPubKey)</p>
<ol>
<li><strong>ciphertextPrivKey</strong> = new random private key.</li>
<li><strong>ciphertextPubKey</strong> = ciphertextPrivKey * G.</li>
<li>è®¡ç®—å…±äº«ç§˜é’¥ <strong>sharedECCKey</strong> = pubKey * ciphertextPrivKey</li>
<li>åŒæ—¶è¿”å›sharedECCKey + ciphertextPubKeyã€‚ ä½¿ç”¨sharedECCKeyè¿›è¡Œå¯¹ç§°åŠ å¯†ã€‚ ä½¿ç”¨éšæœºç”Ÿæˆçš„ciphertextPubKeyç¨åè®¡ç®—è§£å¯†å¯†é’¥ã€‚</li>
</ol>
</li>
<li>
<p><strong>calculateDecryptionKey</strong>(privKey, ciphertextPubKey) --&gt; sharedECCKey</p>
<ol>
<li><strong>sharedECCKey</strong> = ciphertextPubKey * privKey.</li>
<li>è¿”å›sharedECCKeyå¹¶å°†å…¶ç”¨äºè§£å¯†ã€‚</li>
</ol>
</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>â‹…</mo><mi>G</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>b</mi><mo>=</mo><mo stretchy="false">(</mo><mi>b</mi><mo>â‹…</mo><mi>G</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">(a \cdot G) \cdot b = (b \cdot G) \cdot a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span></p>
<p>â€‹ç°åœ¨ï¼Œå¯¹åº”çš„a = privKeyï¼Œa * G = pubKeyï¼Œb = ciphertextPrivKeyï¼Œb * G = ciphertextPubKeyã€‚</p>
<p>â€‹è¿™å°±æ˜¯ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°çš„å‡†ç¡®è®¡ç®—ç»“æœï¼Œç›´æ¥éµå¾ªECDHå¯†é’¥åå•†æ–¹æ¡ˆã€‚ åœ¨æ··åˆåŠ å¯†æ–¹æ¡ˆä¸­ï¼Œå°è£…çš„ciphertextPubKeyä¹Ÿç§°ä¸ºâ€œä¸´æ—¶å¯†é’¥â€ï¼Œå› ä¸ºä½¿ç”¨ECDHå¯†é’¥åå•†æ–¹æ¡ˆä¸´æ—¶ä½¿ç”¨å®ƒæ¥å¯¼å‡ºå¯¹ç§°åŠ å¯†å¯†é’¥ã€‚</p>
<h2 id="132-åŸºäºeccçš„å¯†é’¥æ´¾ç”Ÿ-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#132-åŸºäºeccçš„å¯†é’¥æ´¾ç”Ÿ-ç¤ºä¾‹"></a> 13.2 åŸºäºECCçš„å¯†é’¥æ´¾ç”Ÿ-ç¤ºä¾‹</h2>
<p>â€‹ä½¿ç”¨tinyecåº“ä¸ºæ¶ˆæ¯æ¥æ”¶æ–¹ç”ŸæˆECCç§é’¥-å…¬é’¥å¯¹ï¼ˆåŸºäºbrainpoolP256r1æ›²çº¿ï¼‰ï¼Œç„¶åç»“åˆæ”¶ä»¶äººçš„å…¬é’¥ï¼Œä»å¯†é’¥åº“ä¸­å¯¼å‡ºå…±äº«å¯†é’¥ï¼ˆç”¨äºåŠ å¯†ï¼‰å’Œä¸´æ—¶å¯†æ–‡å…¬å…±å¯†é’¥ï¼ˆç”¨äºECDHï¼‰ã€‚æ”¶ä»¶äººå†ä»æ”¶ä»¶äººçš„ç§é’¥å’Œç”Ÿæˆçš„è¾ƒæ—©çš„ä¸´æ—¶å¯†æ–‡å…¬é’¥ä¸­å¾—å‡ºç›¸åŒçš„ç§˜å¯†å…±äº«å¯†é’¥ï¼ˆç”¨äºè§£å¯†ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec <span class="keyword">import</span> registry</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">curve = registry.get_curve(<span class="string">'brainpoolP256r1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compress_point</span><span class="params">(point)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hex(point.x) + hex(point.y % <span class="number">2</span>)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ecc_calc_encryption_keys</span><span class="params">(pubKey)</span>:</span></span><br><span class="line">    ciphertextPrivKey = secrets.randbelow(curve.field.n)</span><br><span class="line">    ciphertextPubKey = ciphertextPrivKey * curve.g</span><br><span class="line">    sharedECCKey = pubKey * ciphertextPrivKey</span><br><span class="line">    <span class="keyword">return</span> (sharedECCKey, ciphertextPubKey)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ecc_calc_decryption_key</span><span class="params">(privKey, ciphertextPubKey)</span>:</span></span><br><span class="line">    sharedECCKey = ciphertextPubKey * privKey</span><br><span class="line">    <span class="keyword">return</span> sharedECCKey</span><br><span class="line"></span><br><span class="line">privKey = secrets.randbelow(curve.field.n)</span><br><span class="line">pubKey = privKey * curve.g</span><br><span class="line">print(<span class="string">"private key:"</span>, hex(privKey))</span><br><span class="line">print(<span class="string">"public key:"</span>, compress_point(pubKey))</span><br><span class="line"></span><br><span class="line">(encryptKey, ciphertextPubKey) = ecc_calc_encryption_keys(pubKey)</span><br><span class="line">print(<span class="string">"ciphertext pubKey:"</span>, compress_point(ciphertextPubKey))</span><br><span class="line">print(<span class="string">"encryption key:"</span>, compress_point(encryptKey))</span><br><span class="line"></span><br><span class="line">decryptKey = ecc_calc_decryption_key(privKey, ciphertextPubKey)</span><br><span class="line">print(<span class="string">"decryption key:"</span>, compress_point(decryptKey))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">private key: 0x2e2921b4cde59cdf01e7a014a322abd530b3015085c31cb6e59502da761d29e9</span><br><span class="line">public key: 0x850d3873cf4ac50ddb54ddbd27f8225fc43bd3f4c2cc0a4f9d1f9ce15fc4eb711</span><br><span class="line">ciphertext pubKey: 0x71586f9999d3ee050005054bc681c1d96c5eb054ca15b080ba245e495627003b0</span><br><span class="line">encryption key: 0x9d13d3f8f9747669432f575731926b5ed99a6883f00146cbd3203ffa7ff8b1ae1</span><br><span class="line">decryption key: 0x9d13d3f8f9747669432f575731926b5ed99a6883f00146cbd3203ffa7ff8b1ae1</span><br></pre></td></tr></table></figure>
<h2 id="133-åŸºäºeccçš„æ··åˆåŠ å¯†è§£å¯†-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#133-åŸºäºeccçš„æ··åˆåŠ å¯†è§£å¯†-ç¤ºä¾‹"></a> 13.3 åŸºäºECCçš„æ··åˆåŠ å¯†/è§£å¯†-ç¤ºä¾‹</h2>
<p>â€‹		ä¸€æ—¦æœ‰äº†å¯†é’¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼ˆä¾‹å¦‚AES-GCMæˆ–ChaCha20-Poly1305ï¼‰å°†å…¶ç”¨äºå¯¹ç§°æ•°æ®åŠ å¯†ã€‚ è®©æˆ‘ä»¬å®ç°ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„éå¯¹ç§°ECCåŠ å¯†å’Œè§£å¯†æ··åˆæ–¹æ¡ˆã€‚ å®ƒå°†åŸºäºBrainpoolP256r1æ›²çº¿å’ŒAES-256-GCMè®¤è¯çš„å¯¹ç§°å¯†ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install tinyec</span><br><span class="line">pip install pycryptodome</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®Œæ•´çš„ECC + AESæ··åˆåŠ å¯†ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec <span class="keyword">import</span> registry</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib, secrets, binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_AES_GCM</span><span class="params">(msg, secretKey)</span>:</span></span><br><span class="line">    aesCipher = AES.new(secretKey, AES.MODE_GCM)</span><br><span class="line">    ciphertext, authTag = aesCipher.encrypt_and_digest(msg)</span><br><span class="line">    <span class="keyword">return</span> (ciphertext, aesCipher.nonce, authTag)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_AES_GCM</span><span class="params">(ciphertext, nonce, authTag, secretKey)</span>:</span></span><br><span class="line">    aesCipher = AES.new(secretKey, AES.MODE_GCM, nonce)</span><br><span class="line">    plaintext = aesCipher.decrypt_and_verify(ciphertext, authTag)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ecc_point_to_256_bit_key</span><span class="params">(point)</span>:</span></span><br><span class="line">    sha = hashlib.sha256(int.to_bytes(point.x, <span class="number">32</span>, <span class="string">'big'</span>))</span><br><span class="line">    sha.update(int.to_bytes(point.y, <span class="number">32</span>, <span class="string">'big'</span>))</span><br><span class="line">    <span class="keyword">return</span> sha.digest()</span><br><span class="line"></span><br><span class="line">curve = registry.get_curve(<span class="string">'brainpoolP256r1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_ECC</span><span class="params">(msg, pubKey)</span>:</span></span><br><span class="line">    ciphertextPrivKey = secrets.randbelow(curve.field.n)</span><br><span class="line">    sharedECCKey = ciphertextPrivKey * pubKey</span><br><span class="line">    secretKey = ecc_point_to_256_bit_key(sharedECCKey)</span><br><span class="line">    ciphertext, nonce, authTag = encrypt_AES_GCM(msg, secretKey)</span><br><span class="line">    ciphertextPubKey = ciphertextPrivKey * curve.g</span><br><span class="line">    <span class="keyword">return</span> (ciphertext, nonce, authTag, ciphertextPubKey)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_ECC</span><span class="params">(encryptedMsg, privKey)</span>:</span></span><br><span class="line">    (ciphertext, nonce, authTag, ciphertextPubKey) = encryptedMsg</span><br><span class="line">    sharedECCKey = privKey * ciphertextPubKey</span><br><span class="line">    secretKey = ecc_point_to_256_bit_key(sharedECCKey)</span><br><span class="line">    plaintext = decrypt_AES_GCM(ciphertext, nonce, authTag, secretKey)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">msg = <span class="string">b'Text to be encrypted by ECC public key and '</span> \</span><br><span class="line">      <span class="string">b'decrypted by its corresponding ECC private key'</span></span><br><span class="line">print(<span class="string">"original msg:"</span>, msg)</span><br><span class="line">privKey = secrets.randbelow(curve.field.n)</span><br><span class="line">pubKey = privKey * curve.g</span><br><span class="line"></span><br><span class="line">encryptedMsg = encrypt_ECC(msg, pubKey)</span><br><span class="line">encryptedMsgObj = &#123;</span><br><span class="line">    <span class="string">'ciphertext'</span>: binascii.hexlify(encryptedMsg[<span class="number">0</span>]),</span><br><span class="line">    <span class="string">'nonce'</span>: binascii.hexlify(encryptedMsg[<span class="number">1</span>]),</span><br><span class="line">    <span class="string">'authTag'</span>: binascii.hexlify(encryptedMsg[<span class="number">2</span>]),</span><br><span class="line">    <span class="string">'ciphertextPubKey'</span>: hex(encryptedMsg[<span class="number">3</span>].x) + hex(encryptedMsg[<span class="number">3</span>].y % <span class="number">2</span>)[<span class="number">2</span>:]</span><br><span class="line">&#125;</span><br><span class="line">print(<span class="string">"encrypted msg:"</span>, encryptedMsgObj)</span><br><span class="line"></span><br><span class="line">decryptedMsg = decrypt_ECC(encryptedMsg, privKey)</span><br><span class="line">print(<span class="string">"decrypted msg:"</span>, decryptedMsg)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">original msg: b&#39;Text to be encrypted by ECC public key and decrypted by its corresponding ECC private key&#39;</span><br><span class="line">encrypted msg: &#123;&#39;ciphertext&#39;: b&#39;b5953b3082fcefdbde91dd3c03cf83dde0822c19be6ae906a634db65115295e7cbcd7a1a492d69ba5be91990c70d8df9dc84360cf554f155ef81ce1f0ad44bd9fdabbc5f960517089262b3390e61b37610012bee4e6bcae335&#39;, &#39;nonce&#39;: b&#39;9d55f4b5c87fff773d0457f3b23a953e&#39;, &#39;authTag&#39;: b&#39;5c9d339778925aa4e44f43252a28681d&#39;, &#39;ciphertextPubKey&#39;: &#39;0x21dbc985b625f2a42d0f86fc234b49b55477928bae73dfac73bafd9bed50abe70&#39;&#125;</span><br><span class="line">decrypted msg: b&#39;Text to be encrypted by ECC public key and decrypted by its corresponding ECC private key&#39;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/12.%20ECDH%20Key%20Exchange%20(Elliptic%20Curve%20Diffie%E2%80%93Hellman%20Key%20Exchange)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/12.%20ECDH%20Key%20Exchange%20(Elliptic%20Curve%20Diffie%E2%80%93Hellman%20Key%20Exchange)/" class="post-title-link" itemprop="url">12. ECDH Key Exchange (Elliptic Curve Diffieâ€“Hellman Key Exchange)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:23" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:23+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹<a href="https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman" target="_blank" rel="noopener"><strong>ECDH</strong></a>ï¼ˆæ¤­åœ†æ›²çº¿Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼‰æ˜¯ä¸€ç§åŒ¿åå¯†é’¥åå•†æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆå…è®¸ä¸¤ä¸ªæ–¹ï¼ˆæ¯ä¸ªæ–¹éƒ½æœ‰ä¸€ä¸ªæ¤­åœ†æ›²çº¿çš„å…¬é’¥-ç§é’¥å¯¹ï¼‰åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹å…±äº«ç§˜å¯†ã€‚ECDHä¸ç»å…¸çš„DHKEï¼ˆDiffie-Hellmanå¯†é’¥äº¤æ¢ï¼‰ç®—æ³•éå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒä½¿ç”¨ECCç‚¹ä¹˜æ³•è€Œä¸æ˜¯æ¨¡å¹‚ã€‚ ECDHåŸºäºECç‚¹çš„ä»¥ä¸‹å±æ€§ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>â‹…</mo><mi>G</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>b</mi><mo>=</mo><mo stretchy="false">(</mo><mi>b</mi><mo>â‹…</mo><mi>G</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">(a \cdot G) \cdot b = (b \cdot G) \cdot a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span></li>
</ul>
<p>â€‹		å¦‚æœæˆ‘ä»¬æœ‰ä¸¤ä¸ªç§˜å¯†æ•°å­—aå’Œbï¼ˆä¸¤ä¸ªç§é’¥ï¼Œåˆ†åˆ«å±äºAliceå’ŒBobï¼‰å’Œå¸¦æœ‰ç”Ÿæˆå™¨ç‚¹Gçš„ECCæ¤­åœ†æ›²çº¿ï¼Œåˆ™å¯ä»¥åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šäº¤æ¢ï¼ˆa * Gï¼‰å’Œï¼ˆb * Gï¼‰å€¼ ï¼ˆAliceå’ŒBobçš„å…¬å…±å¯†é’¥ï¼‰ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªå…±äº«çš„ç§˜å¯†ï¼šsecret =ï¼ˆa * Gï¼‰* b =ï¼ˆb * Gï¼‰* aï¼Œ ä¸Šé¢çš„å…¬å¼é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š</p>
<ul>
<li>alicePubKey * bobPrivKey = bobPubKey * alicePrivKey = <em><strong>secret</strong></em></li>
</ul>
<p>ECDHç®—æ³•ï¼ˆæ¤­åœ†æ›²çº¿Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼‰å¾ˆç®€å•ï¼š</p>
<ol>
<li><strong>Alice</strong> generates a <strong>random</strong> ECC key pair: {<strong>alicePrivKey</strong>, <strong>alicePubKey</strong> = alicePrivKey * G}</li>
<li><strong>Bob</strong> generates a <strong>random</strong> ECC key pair: {<strong>bobPrivKey</strong>, <strong>bobPubKey</strong> = bobPrivKey * G}</li>
<li>Alice and Bob <strong>exchange their public keys</strong> through the insecure channel (e.g. over Internet)</li>
<li><strong>Alice</strong> calculates <strong>sharedKey</strong> = bobPubKey * alicePrivKey</li>
<li><strong>Bob</strong> calculates <strong>sharedKey</strong> = alicePubKey * bobPrivKey</li>
<li>Now both <strong>Alice</strong> and <strong>Bob</strong> have the same <strong>sharedKey</strong> == bobPubKey * alicePrivKey == alicePubKey * bobPrivKey</li>
</ol>
<h4 id="ecdhå¯†é’¥äº¤æ¢-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ecdhå¯†é’¥äº¤æ¢-ç¤ºä¾‹"></a> ECDHå¯†é’¥äº¤æ¢-ç¤ºä¾‹</h4>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install tinyec</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec <span class="keyword">import</span> registry</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compress</span><span class="params">(pubKey)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hex(pubKey.x) + hex(pubKey.y % <span class="number">2</span>)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">curve = registry.get_curve(<span class="string">'brainpoolP256r1'</span>)</span><br><span class="line"></span><br><span class="line">alicePrivKey = secrets.randbelow(curve.field.n)</span><br><span class="line">alicePubKey = alicePrivKey * curve.g</span><br><span class="line">print(<span class="string">"Alice public key:"</span>, compress(alicePubKey))</span><br><span class="line"></span><br><span class="line">bobPrivKey = secrets.randbelow(curve.field.n)</span><br><span class="line">bobPubKey = bobPrivKey * curve.g</span><br><span class="line">print(<span class="string">"Bob public key:"</span>, compress(bobPubKey))</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Now exchange the public keys (e.g. through Internet)"</span>)</span><br><span class="line"></span><br><span class="line">aliceSharedKey = alicePrivKey * bobPubKey</span><br><span class="line">print(<span class="string">"Alice shared key:"</span>, compress(aliceSharedKey))</span><br><span class="line"></span><br><span class="line">bobSharedKey = bobPrivKey * alicePubKey</span><br><span class="line">print(<span class="string">"Bob shared key:"</span>, compress(bobSharedKey))</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Equal shared keys:"</span>, aliceSharedKey == bobSharedKey)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Alice public key: 0x66c808e6b5be6d6620934bc6ffa2b8b47f9786c002bfb06d53a0c27535641a5d1</span><br><span class="line">Bob public key: 0x7d15195432d1ac7f38aeb054d07d9b2e1faa913b78ad04d5efdd4a1ee8d9a3191</span><br><span class="line">Now exchange the public keys (e.g. through Internet)</span><br><span class="line">Alice shared key: 0x90f5a1cf2ed1dbb0322178df6bb0dd72c541884618b2989a3e5e663198667a621</span><br><span class="line">Bob shared key: 0x90f5a1cf2ed1dbb0322178df6bb0dd72c541884618b2989a3e5e663198667a621</span><br><span class="line">Equal shared keys: True</span><br></pre></td></tr></table></figure>
<p>â€‹		ç”±äºéšæœºæ€§ï¼Œæ¯æ¬¡è¿è¡Œä¸Šè¿°ä»£ç ï¼Œåˆ™å¯†é’¥å°†æœ‰æ‰€ä¸åŒï¼Œä½†æœ€åè®¡ç®—å‡ºçš„Aliceå’ŒBobçš„å…±äº«å°†å§‹ç»ˆç›¸åŒã€‚ ç”Ÿæˆçš„å…±äº«æœºå¯†æ˜¯ä¸€ä¸ª257ä½æ•´æ•°ï¼ˆ256ä½æ›²çº¿çš„å‹ç¼©ECç‚¹ï¼Œç¼–ç ä¸º65ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼‰ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/11.%20Elliptic%20Curve%20Cryptography%20(ECC)%20-%20Concepts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/11.%20Elliptic%20Curve%20Cryptography%20(ECC)%20-%20Concepts/" class="post-title-link" itemprop="url">11. Elliptic Curve Cryptography (ECC) - Concepts</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:22" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:22+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹<a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" target="_blank" rel="noopener"><strong>Elliptic Curve Cryptography (ECC)</strong></a>æ˜¯ç°ä»£çš„å…¬é’¥åŠ å¯†ç³»ç»Ÿï¼Œå®ƒåŸºäºæœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿çš„ä»£æ•°ç»“æ„ä»¥åŠæ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰çš„éš¾åº¦ã€‚</p>
<p>â€‹ECCå®ç°äº†éå¯¹ç§°å¯†ç ç³»ç»Ÿçš„æ‰€æœ‰ä¸»è¦åŠŸèƒ½ï¼šåŠ å¯†ï¼Œç­¾åå’Œå¯†é’¥äº¤æ¢ã€‚</p>
<p>â€‹ECCåŠ å¯†è¢«è®¤ä¸ºæ˜¯RSAåŠ å¯†çš„è‡ªç„¶çš„åç»§äº§å“ï¼Œå› ä¸ºåœ¨ç›¸åŒçš„å®‰å…¨çº§åˆ«ä¸Šï¼ŒECCä½¿ç”¨çš„å¯†é’¥å’Œç­¾åæ¯”RSAå°ï¼Œå¹¶ä¸”æä¾›äº†æ›´é«˜æ•ˆç‡çš„å¯†é’¥ç”Ÿæˆï¼Œå¯†é’¥åå•†å’Œæ•°å­—ç­¾åã€‚</p>
<h2 id="111-eccå¯†é’¥"><a class="markdownIt-Anchor" href="#111-eccå¯†é’¥"></a> 11.1 ECCå¯†é’¥</h2>
<p>â€‹ECCä¸­çš„ç§é’¥æ˜¯æ•´æ•°ï¼ˆåœ¨æ›²çº¿åŒºåŸŸçš„èŒƒå›´å†…ï¼Œé€šå¸¸ä¸º256ä½æ•´æ•°ï¼‰ï¼Œå¦‚:<br />
<code>0x51897b64e85c3f714bba707e867914295a1377a7463a9dae8ea6a8b914246319</code></p>
<p>â€‹ECCçš„å¯†é’¥ç”Ÿæˆå°±åƒå®‰å…¨åœ°ç”Ÿæˆä¸€å®šèŒƒå›´å†…çš„éšæœºæ•´æ•°ä¸€æ ·ç®€å•ï¼Œå› æ­¤å®ƒéå¸¸å¿«ã€‚ èŒƒå›´å†…çš„ä»»ä½•æ•°å­—éƒ½æ˜¯æœ‰æ•ˆçš„ECCç§é’¥ã€‚</p>
<p>â€‹ECCä¸­çš„å…¬é’¥æ˜¯ECç‚¹-æ”¾ç½®åœ¨æ›²çº¿ä¸Šçš„æˆå¯¹çš„æ•´æ•°åæ ‡{xï¼Œy}ã€‚ ç”±äºå…¶ç‰¹æ®Šçš„å±æ€§ï¼ŒECç‚¹å¯ä»¥å‹ç¼©ä¸ºä¸€ä¸ªåæ ‡+1ä½ï¼Œå› æ­¤ï¼Œå¯¹åº”äº256ä½ECCç§é’¥çš„å‹ç¼©å…¬é’¥æ˜¯257ä½æ•´æ•°ã€‚ECCå…¬é’¥çš„ç¤ºä¾‹å¦‚ä¸‹ï¼ˆä¸ä¸Šè¿°ç§é’¥ç›¸å¯¹åº”ï¼Œä»¥å¤ªåŠæ ¼å¼ç¼–ç ï¼Œå‰ç¼€ä¸º02æˆ–03çš„åå…­è¿›åˆ¶ï¼‰ï¼š<br />
<code>0x02f54ba86dc1ccb5bed0224d23f01ed87e4a443c47fc690d7797a13d41d2340e1a</code></p>
<p>åœ¨è¿™ç§æ ¼å¼ä¸‹ï¼Œå…¬é’¥å®é™…ä¸Šå ç”¨33ä¸ªå­—èŠ‚ï¼ˆ66ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼‰ï¼Œå¯ä»¥å°†å…¶ä¼˜åŒ–ä¸ºæ°å¥½257ä½</p>
<h2 id="112-æ›²çº¿å’Œç§˜é’¥é•¿åº¦"><a class="markdownIt-Anchor" href="#112-æ›²çº¿å’Œç§˜é’¥é•¿åº¦"></a> 11.2 æ›²çº¿å’Œç§˜é’¥é•¿åº¦</h2>
<p>â€‹ECCåŠ å¯†ç®—æ³•å¯ä»¥ä½¿ç”¨ä¸åŒçš„åŸºç¡€æ¤­åœ†æ›²çº¿ã€‚ ä¸åŒçš„æ›²çº¿æä¾›ä¸åŒçš„å®‰å…¨æ€§ï¼ˆåŠ å¯†å¼ºåº¦ï¼‰ï¼Œä¸åŒçš„æ€§èƒ½ï¼ˆé€Ÿåº¦ï¼‰å’Œä¸åŒçš„å¯†é’¥é•¿åº¦ï¼Œå¹¶ä¸”å¯èƒ½æ¶‰åŠä¸åŒçš„ç®—æ³•ã€‚æµè¡Œçš„å¯†ç åº“å’Œå®‰å…¨æ ‡å‡†ä¸­é‡‡ç”¨çš„ECCæ›²çº¿å…·æœ‰nameï¼ˆå‘½åæ›²çº¿ï¼Œä¾‹å¦‚secp256k1æˆ–Curve25519ï¼‰ï¼Œ<strong>field size</strong>ï¼ˆå®šä¹‰å¯†é’¥é•¿åº¦ï¼Œä¾‹å¦‚256ä½ï¼‰ï¼Œsecurity <strong>strength</strong>ï¼ˆé€šå¸¸æ˜¯<strong>field size</strong>/ 2 æˆ– æ›´å°‘ï¼‰ï¼Œ<strong>performance</strong>ï¼ˆæ“ä½œæ•°/ç§’ï¼‰å’Œè®¸å¤šå…¶ä»–å‚æ•°ã€‚</p>
<p>â€‹ECCå¯†é’¥çš„é•¿åº¦ç›´æ¥å–å†³äºåŸºç¡€æ›²çº¿ã€‚ åœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºï¼ˆå¦‚OpenSSLï¼ŒOpenSSHå’ŒBitcoinï¼‰ä¸­ï¼ŒECCç§é’¥çš„é»˜è®¤å¯†é’¥é•¿åº¦ä¸º256ä½ï¼Œä½†æ ¹æ®æ›²çº¿ï¼Œå¯èƒ½æœ‰è®¸å¤šä¸åŒçš„ECCå¯†é’¥å¤§å°ï¼š192ä½ï¼ˆcurve secp192r1ï¼‰ï¼Œ233ä½ï¼ˆcurve  sect233k1ï¼‰ï¼Œ224ä½ï¼ˆcurve secp224k1ï¼‰ï¼Œ256ä½ï¼ˆcurve secp256k1å’Œcurve25519ï¼‰ï¼Œ283ä½ï¼ˆcurve sect283k1ï¼‰ï¼Œ384ä½ï¼ˆcurve p384å’Œsecp384r1ï¼‰ï¼Œ409ä½ï¼ˆcurve sect409r1ï¼‰ï¼Œ414ä½ ï¼ˆcurve Curve41417ï¼‰ï¼Œ448ä½ï¼ˆcurve Curve448-Goldilocksï¼‰ï¼Œ511ä½ï¼ˆcurve M-511ï¼‰ï¼Œ521ä½ï¼ˆcurve P-521ï¼‰ï¼Œ571ä½ï¼ˆcurve sect571k1ï¼‰ç­‰ã€‚</p>
<h2 id="113-eccç®—æ³•"><a class="markdownIt-Anchor" href="#113-eccç®—æ³•"></a> 11.3 ECCç®—æ³•</h2>
<p>ECC æ ¹æ®æœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿çš„æ•°å­¦åŸç†ï¼Œæä¾›äº†å‡ ç»„ç®—æ³•ï¼š</p>
<ul>
<li>ECCæ•°å­—ç­¾åç®—æ³•ï¼š <a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>ECDSA</strong></a>å’Œ<a href="https://en.wikipedia.org/wiki/EdDSA" target="_blank" rel="noopener"><strong>EdDSA</strong></a></li>
<li>ECCåŠ å¯†ç®—æ³•å’Œæ··åˆåŠ å¯†æ–¹æ¡ˆï¼š<a href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme" target="_blank" rel="noopener"><strong>ECIES</strong></a>å’Œ<a href="https://cse.unl.edu/~ssamal/crypto/EEECC.pdf" target="_blank" rel="noopener"><strong>EEECC</strong></a></li>
<li>ECCå¯†é’¥åå•†ç®—æ³•ï¼š <a href="https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman" target="_blank" rel="noopener"><strong>ECDH</strong></a>, <a href="https://cryptography.io/en/latest/hazmat/primitives/asymmetric/x25519/" target="_blank" rel="noopener"><strong>X25519</strong></a> å’Œ <a href="https://fastd.readthedocs.io/en/v18/crypto/fhmqvc.html" target="_blank" rel="noopener"><strong>FHMQV</strong></a></li>
</ul>
<h2 id="114-æ¤­åœ†æ›²çº¿"><a class="markdownIt-Anchor" href="#114-æ¤­åœ†æ›²çº¿"></a> 11.4 æ¤­åœ†æ›²çº¿</h2>
<p>â€‹åœ¨æ•°å­¦ä¸­ï¼Œæ¤­åœ†æ›²çº¿ï¼ˆ<strong><a href="http://mathworld.wolfram.com/EllipticCurve.html" target="_blank" rel="noopener">elliptic curves</a></strong>ï¼‰æ˜¯å¹³é¢ä»£æ•°æ›²çº¿ï¼Œç”±æ‰€æœ‰ç‚¹{xï¼Œy}ç»„æˆï¼Œç”±ç­‰å¼æè¿°ï¼š</p>
<ul>
<li>$Ax^3 + Bx^2y + Cxy^2 + Dy^3 + Ex^2 + Fxy + Gy^2 + Hx + Iy + J = 0 $</li>
</ul>
<p>â€‹å¯†ç å­¦ä½¿ç”¨ç®€åŒ–å½¢å¼ï¼ˆWeierstraså½¢å¼ï¼‰çš„æ¤­åœ†æ›²çº¿ï¼Œå…¶å®šä¹‰ä¸ºï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y^2 = x^3 + ax + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></li>
</ul>
<p>â€‹ä¾‹å¦‚ï¼Œ <a href="https://en.bitcoin.it/wiki/Secp256k1" target="_blank" rel="noopener">NIST curve <code>secp256k1</code></a>ï¼ˆåœ¨æ¯”ç‰¹å¸ä¸­ä½¿ç”¨ï¼‰åŸºäºä»¥ä¸‹å½¢å¼çš„æ¤­åœ†æ›²çº¿ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">y^2 = x^3 + 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span></span></span></span></li>
</ul>
<p>è¿™æ˜¯ä¸Šè¿°æ¤­åœ†æ›²çº¿çš„å›¾å½¢ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/secp256k1.png" alt="secp256k1 -c" /></p>
<p><code>æ³¨</code>:è¦äº†è§£æœ‰å…³æ¤­åœ†æ›²çº¿æ–¹ç¨‹å¼åŠå…¶å¤–è§‚çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·ä½¿ç”¨åœ¨çº¿æ¤­åœ†æ›²çº¿å¯è§†åŒ–å·¥å…·: <a href="https://www.desmos.com/calculator/ialhd71we3" target="_blank" rel="noopener">https://www.desmos.com/calculator/ialhd71we3</a>.</p>
<h3 id="1141-æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"><a class="markdownIt-Anchor" href="#1141-æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"></a> 11.4.1 æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿</h3>
<p>â€‹æ¤­åœ†æ›²çº¿åŠ å¯†ï¼ˆECCï¼‰åœ¨æœ‰é™åŸŸ (<strong><a href="https://en.wikipedia.org/wiki/Finite_field" target="_blank" rel="noopener">finite field</a></strong> ) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">ğ”½p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord mathbb">F</span><span class="mord mathdefault">p</span></span></span></span>ï¼ˆå…¶ä¸­pæ˜¯ç´ æ•°ä¸”p&gt; 3ï¼‰æˆ– <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><msup><mn>2</mn><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">ğ”½2^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">F</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span></span></span>ï¼ˆå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><msup><mn>2</mn><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">p = 2^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span></span></span>ï¼‰ä¸Šä½¿ç”¨æ¤­åœ†æ›²çº¿ã€‚å³è¯¥åŸŸæ˜¯å¤§å°ä¸ºp x pçš„æ–¹é˜µï¼Œå¹¶ä¸”ä»…é™äºæ›²çº¿ä¸Šçš„åœ¨è¯¥åŸŸå†…çš„æ•´æ•°åæ ‡ã€‚åŸŸå†…çš„æ‰€æœ‰ä»£æ•°è¿ç®—ï¼ˆä¾‹å¦‚ç‚¹åŠ æ³•å’Œä¹˜æ³•ï¼‰éƒ½ä¼šå¾—åˆ°åŸŸå†…å¦ä¸€ä¸ªç‚¹ã€‚æœ‰é™åŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">ğ”½p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord mathbb">F</span><span class="mord mathdefault">p</span></span></span></span>ä¸Šçš„æ¤­åœ†æ›²çº¿æ–¹ç¨‹é‡‡ç”¨ä»¥ä¸‹æ¨¡å—åŒ–å½¢å¼ï¼š</p>
<ul>
<li>$ y^2 â‰¡ x^3 + ax + b \quad (mod \quad p)$</li>
</ul>
<p>â€œæ¯”ç‰¹å¸æ›²çº¿â€ secp256k1é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š</p>
<ul>
<li>$ y^2 â‰¡ x^3 + 7 \quad (mod \quad p)$</li>
</ul>
<p>â€‹ä¸RSAä¸åŒï¼ŒRSAçš„å¯†é’¥ç©ºé—´ä½¿ç”¨[0 â€¦ p-1]èŒƒå›´å†…çš„æ•´æ•°ï¼ˆåŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Z</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">â„¤p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord amsrm">Z</span><span class="mord mathdefault">p</span></span></span></span>ï¼‰ï¼›ECCä½¿ç”¨GaloisåŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">ğ”½p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord mathbb">F</span><span class="mord mathdefault">p</span></span></span></span>ä¸­çš„ç‚¹{xï¼Œy}ï¼ˆå…¶ä¸­xå’Œyæ˜¯[0 â€¦ p-1]èŒƒå›´å†…çš„æ•´æ•°ï¼‰ã€‚</p>
<p>â€‹æœ‰é™åŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">ğ”½p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord mathbb">F</span><span class="mord mathdefault">p</span></span></span></span>ä¸Šçš„æ¤­åœ†æ›²çº¿åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä¸€ç»„æ•´æ•°åæ ‡{xï¼Œy}ï¼Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&lt;</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">0â‰¤x, y &lt;p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></li>
<li>ä¿æŒåœ¨æ¤­åœ†æ›²çº¿ä¸Šï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>â‰¡</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace width="1em"/><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^2â‰¡x^3 + ax + b \quad (mod \quad p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>æœ‰é™åŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mn>17</mn></mrow><annotation encoding="application/x-tex">ğ”½17</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">F</span><span class="mord">1</span><span class="mord">7</span></span></span></span>ä¸Šçš„æ¤­åœ†æ›²çº¿ç¤ºä¾‹ï¼š</p>
<ul>
<li>$ y^2 â‰¡ x^3 + 7 \quad (mod \quad 17)$</li>
</ul>
<p>å…¶æ›²çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/f17.png" alt="f17 -c" /></p>
<p>â€‹æœ‰é™åŸŸ$ y^2 â‰¡ x^3 + 7 \quad (mod \quad 17)$ä¸Šçš„æ¤­åœ†æ›²çº¿ç”±ä¸Šå›¾çš„è“ç‚¹ç»„æˆï¼Œå³åœ¨å®è·µä¸­ï¼Œå¯†ç å­¦ä¸­ä½¿ç”¨çš„â€œæ¤­åœ†æ›²çº¿â€æ˜¯â€œæ–¹é˜µä¸­çš„ç‚¹é›†â€ï¼Œä¸æ˜¯ç»å…¸çš„ â€œæ›²çº¿â€ã€‚å¹¶ä¸”ä¸Šé¢çš„æ›²çº¿æ˜¯â€œå­¦ä¹ ä½¿ç”¨çš„â€ã€‚ å®ƒåªæä¾›äº†éå¸¸å°çš„å¯†é’¥é•¿åº¦ï¼ˆ4-5ä½ï¼‰ã€‚åœ¨ç°å®ä¸­ï¼Œå¼€å‘äººå‘˜é€šå¸¸ä½¿ç”¨256ä½æˆ–æ›´å¤šä½çš„æ›²çº¿ã€‚</p>
<h3 id="1142-æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿çš„è®¡ç®—"><a class="markdownIt-Anchor" href="#1142-æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿çš„è®¡ç®—"></a> 11.4.2 æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿çš„è®¡ç®—</h3>
<p>â€‹è®¡ç®—æŸä¸ªç‚¹æ˜¯å¦å±äºæœ‰é™åŸŸä¸Šçš„æŸäº›æ¤­åœ†æ›²çº¿éå¸¸å®¹æ˜“ã€‚ ä¾‹å¦‚ï¼Œå½“ä¸”ä»…å½“ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œç‚¹{xï¼Œy}å±äºæ›²çº¿$ y^2 â‰¡ x^3 + 7 \quad (mod \quad 17)$ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>7</mn><mo>âˆ’</mo><msup><mi>y</mi><mn>2</mn></msup><mo>â‰¡</mo><mn>0</mn><mspace width="1em"/><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mn>17</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^3 + 7 - y^2 â‰¡ 0 \quad (mod \quad 17)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">1</span><span class="mord">7</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>ç‚¹P {5ï¼Œ8}å±äºæ›²çº¿ï¼Œå› ä¸º<span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \ï¼… at position 19: â€¦^ 3 + 7-8 ^ 2) \Ì²ï¼…Ì² 17 == 0'>(5 ^ 3 + 7-8 ^ 2) \ï¼… 17 == 0</span>ï¼›ç‚¹{9ï¼Œ15}ä¸å±äºæ›²çº¿ï¼Œå› ä¸º<span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \ï¼… at position 22: â€¦ + 7 - 15 ^ 2) \Ì²ï¼…Ì² 17 \quad != 0'>(9 ^ 3 + 7 - 15 ^ 2) \ï¼… 17 \quad != 0</span></p>
<p>ä¸Šé¢æåˆ°çš„æ¤­åœ†æ›²çº¿å’Œç‚¹{5ï¼Œ8}å’Œ{9ï¼Œ15}å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/ecc%20calc.png" alt="ecc cal -c" /></p>
<h3 id="1143-æ•´æ•°ä¹˜ä»¥eccç‚¹"><a class="markdownIt-Anchor" href="#1143-æ•´æ•°ä¹˜ä»¥eccç‚¹"></a> 11.4.3 æ•´æ•°ä¹˜ä»¥ECCç‚¹</h3>
<p>â€‹æ¤­åœ†æ›²çº¿ä¸Šä¸¤ä¸ªç‚¹ï¼ˆECç‚¹ï¼‰å¯ä»¥ç›¸åŠ ï¼Œç»“æœæ˜¯å¦ä¸€ä¸ªç‚¹ã€‚ æ­¤æ“ä½œç§°ä¸ºECç‚¹åŠ æ³•ã€‚ å¦‚æœå°†ç‚¹Gæ·»åŠ åˆ°è‡ªèº«Gï¼Œåˆ™ç»“æœä¸º$ G + G = 2 \cdot G $ ã€‚å¦‚æœå†æ¬¡å°†Gæ·»åŠ åˆ°ç»“æœï¼Œåˆ™å°†è·å¾—<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><mo>â‹…</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">3 \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span>ï¼Œä¾æ­¤ç±»æ¨ã€‚ è¿™å°±æ˜¯ECç‚¹ä¹˜æ³•çš„å®šä¹‰ã€‚</p>
<p>â€‹å¯ä»¥å°†æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹Gï¼ˆECç‚¹ï¼‰ä¹˜ä»¥æ•´æ•°kï¼Œç»“æœæ˜¯åŒä¸€æ¡æ›²çº¿ä¸Šçš„å¦ä¸€ä¸ªECç‚¹Pï¼Œæ­¤æ“ä½œå¾ˆå¿«ï¼š</p>
<ul>
<li><strong>P</strong> = <strong>k</strong> * <strong>G</strong></li>
</ul>
<p>â€‹ä¸Šé¢çš„æ“ä½œæ¶‰åŠä¸€äº›å…¬å¼å’Œè½¬æ¢ï¼Œä½†æ˜¯ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†è·³è¿‡å®ƒä»¬ã€‚ è¦çŸ¥é“çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œå°†ECç‚¹ä¹˜ä»¥æ•´æ•°ä¼šåœ¨åŒä¸€æ¡æ›²çº¿ä¸Šè¿”å›å¦ä¸€ä¸ªECç‚¹ï¼Œå¹¶ä¸”æ­¤æ“ä½œå¾ˆå¿«ã€‚ å°†ECç‚¹ä¹˜ä»¥0å°†è¿”å›ä¸€ä¸ªç§°ä¸ºâ€œæ— ç©·å¤§â€çš„ç‰¹æ®ŠECç‚¹ã€‚</p>
<p><code>æ³¨</code>:  <a href="https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication" target="_blank" rel="noopener">read more about EC point multiplication</a></p>
<p><a href="http://blog.51cto.com/11821908/2057726" target="_blank" rel="noopener">http://blog.51cto.com/11821908/2057726</a><br />
è®²è§£äº†å—é™åŸŸçš„æ›²çº¿ä¸‹çš„åŠ æ³•å®ç°è®¡ç®—<br />
<a href="https://www.jianshu.com/p/2e6031ac3d50" target="_blank" rel="noopener">https://www.jianshu.com/p/2e6031ac3d50</a><br />
åªè®²è§£äº†æ— å—é™åŸŸä¸‹æ›²çº¿çš„åŠ æ³•<br />
<a href="https://wenku.baidu.com/view/6f2879cca1c7aa00b52acb5f.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/6f2879cca1c7aa00b52acb5f.html</a><br />
åˆ†æ•°æ±‚æ¨¡åŸç†ä»‹ç»<br />
<a href="https://www.pediy.com/kssd/pediy06/pediy6014.htm" target="_blank" rel="noopener">https://www.pediy.com/kssd/pediy06/pediy6014.htm</a><br />
çœ‹é›ªè®ºå›ä¸Šçš„è¯¦ç»†ä»‹ç»ï¼Œæä¾›äº†åŠ æ³•è¿ç®—çš„éªŒè¯é›†<br />
<a href="https://blog.csdn.net/baidu_38271024/article/details/78881031" target="_blank" rel="noopener">https://blog.csdn.net/baidu_38271024/article/details/78881031</a><br />
ä¹˜æ³•é€†å…ƒæ±‚è§£çš„pythonå®ç°</p>
<p><strong>ç¤ºä¾‹ï¼šå°†ECç‚¹ä¹˜ä»¥æ•´æ•°</strong></p>
<p>â€‹ECä¹˜æ³•çš„å…¬å¼é’ˆå¯¹æ›²çº¿çš„ä¸åŒè¡¨ç¤ºå½¢å¼è€Œæœ‰æ‰€ä¸åŒã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç»å…¸Weierstrasså½¢å¼çš„æ¤­åœ†æ›²çº¿ã€‚åœ¨æœ‰é™åŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>â‰¡</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>7</mn><mspace width="1em"/><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mn>17</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^2â‰¡x^3 + 7 \quad(mod \quad 17)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">1</span><span class="mord">7</span><span class="mclose">)</span></span></span></span>ä¸Šçš„æ¤­åœ†æ›²çº¿ä¸Šè·å–ECç‚¹G = {15ï¼Œ13}å¹¶å°†å…¶ä¹˜ä»¥k = 6ã€‚æˆ‘ä»¬å°†è·å¾—ECç‚¹P = {5ï¼Œ8 }ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/k%20e%206.png" alt="k e 6 -c" /></p>
<h3 id="1144-æ¤­åœ†æ›²çº¿çš„åºå’Œä½™å­å¼"><a class="markdownIt-Anchor" href="#1144-æ¤­åœ†æ›²çº¿çš„åºå’Œä½™å­å¼"></a> 11.4.4 æ¤­åœ†æ›²çº¿çš„åºå’Œä½™å­å¼</h3>
<p>â€‹æœ‰é™åŸŸä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿å¯ä»¥å½¢æˆä¸€ä¸ªç”±æ›²çº¿ä¸Šçš„æ‰€æœ‰ç‚¹ç»„æˆçš„æœ‰é™å¾ªç¯ä»£æ•°ç¾¤ï¼ˆ<strong><a href="https://en.wikipedia.org/wiki/Cyclic_group" target="_blank" rel="noopener">cyclic algebraic group</a></strong>ï¼‰ï¼Œåœ¨æœ‰é™å¾ªç¯ä»£æ•°ç¾¤ä¸­ï¼Œå¦‚æœå°†ä¸¤ä¸ªECç‚¹ç›¸åŠ æˆ–å°†ä¸€ä¸ªECç‚¹ä¹˜ä»¥ä¸€ä¸ªæ•´æ•°ï¼Œåˆ™ç»“æœæ˜¯åŒä¸€æœ‰é™å¾ªç¯ä»£æ•°ç¾¤ï¼ˆåœ¨åŒä¸€æ¡æ›²çº¿ä¸Šï¼‰çš„å¦ä¸€ä¸ªECç‚¹ã€‚æ›²çº¿çš„åºæ˜¯æ›²çº¿ä¸Šæ‰€æœ‰ECç‚¹çš„æ€»æ•°ã€‚è¯¥æ€»ç‚¹æ•°è¿˜åŒ…æ‹¬ç§°ä¸ºâ€œ<a href="https://en.wikipedia.org/wiki/Point_at_infinity" target="_blank" rel="noopener"><strong>point at infinity</strong></a>â€çš„ç‰¹æ®Šç‚¹ï¼Œè¯¥ç‰¹æ®Šç‚¹æ˜¯å°†ä¸€ä¸ªç‚¹ä¹˜ä»¥0å¾—åˆ°çš„ã€‚</p>
<p>â€‹ä¸€äº›æ›²çº¿å½¢æˆå•ä¸ªå¾ªç¯ç»„ï¼ˆä¿å­˜æ‰€æœ‰ECç‚¹ï¼‰ï¼Œè€Œå¦ä¸€äº›æ›²çº¿å½¢æˆå‡ ä¸ªä¸é‡å çš„å¾ªç¯å­ç¾¤ï¼ˆæ¯ä¸ªå­é›†ä¸­åŒ…å«æ›²çº¿ECç‚¹çš„å­é›†ï¼‰ã€‚åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæ›²çº¿ä¸Šçš„ç‚¹è¢«åˆ’åˆ†ä¸ºhä¸ªå¾ªç¯å­ç¾¤ï¼Œæ¯ä¸ªå­ç¾¤çš„åºä¸ºrï¼ˆæ¯ä¸ªå­ç¾¤æ‹¥æœ‰ç›¸ç­‰æ•°é‡çš„ç‚¹ï¼‰ã€‚æ•´ä¸ªç¾¤çš„åºä¸º$ n = h \cdot r $ ï¼Œæ‹¥æœ‰ECç‚¹çš„å­ç¾¤hçš„æ•°é‡ç§°ä¸ºä½™å­å¼ã€‚</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/cofactor.png" alt="cofacto -c" /></p>
<ul>
<li>
<p>$ h = n / r$</p>
</li>
<li>
<p><strong>n</strong> æ›²çº¿çš„åºï¼ˆæ‰€æœ‰ç‚¹çš„æ•°é‡ï¼‰</p>
</li>
<li>
<p><strong>h</strong> æ›²çº¿çš„ä½™å­å¼ï¼ˆç‚¹çš„éé‡å å­ç¾¤çš„æ•°é‡ï¼Œå®ƒä»¬å…±åŒä¿å­˜æ‰€æœ‰æ›²çº¿ç‚¹ï¼‰</p>
</li>
<li>
<p><strong>r</strong> å­ç¾¤çš„æ•°é‡ï¼ˆæ¯ä¸ªå­ç¾¤ä¸­çš„ç‚¹æ•°ï¼ŒåŒ…æ‹¬æ¯ä¸ªå­ç¾¤çš„æ— ç©·è¿œç‚¹ï¼‰</p>
</li>
</ul>
<p>â€‹æ¢å¥è¯è¯´ï¼Œæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ä½äºä¸€ä¸ªæˆ–å‡ ä¸ªä¸é‡å çš„å­é›†ä¸­ï¼Œç§°ä¸ºå­ç¾¤ã€‚ å­ç¾¤çš„æ•°é‡ç§°ä¸ºâ€œä½™å­å¼â€ï¼ˆ<strong>cofactor</strong>ï¼‰ã€‚æ‰€æœ‰å­ç¾¤ä¸­çš„æ€»ç‚¹æ•°ç§°ä¸ºæ›²çº¿çš„â€œæ•°é‡â€ï¼Œé€šå¸¸ç”¨nè¡¨ç¤ºã€‚ å¦‚æœæ›²çº¿ä»…åŒ…å«ä¸€ä¸ªå¾ªç¯å­ç¾¤ï¼Œåˆ™å…¶ä½™å­å¼ h =1ã€‚å¦‚æœæ›²çº¿åŒ…å«å¤šä¸ªå­ç¾¤ï¼Œåˆ™å…¶ä½™å­å¼ h &gt; 1ã€‚</p>
<ul>
<li>Example of elliptic curve having <strong>cofactor</strong> = <strong>1</strong> is <code>secp256k1</code>.</li>
<li>Example of elliptic curve having <strong>cofactor</strong> = <strong>8</strong> is <code>Curve25519</code>.</li>
<li>Example of elliptic curve having <strong>cofactor</strong> = <strong>4</strong> is <code>Curve448</code>.</li>
</ul>
<h3 id="1145-eccä¸­çš„ç”Ÿæˆå™¨ç‚¹"><a class="markdownIt-Anchor" href="#1145-eccä¸­çš„ç”Ÿæˆå™¨ç‚¹"></a> 11.4.5 ECCä¸­çš„â€œç”Ÿæˆå™¨â€ç‚¹</h3>
<p>â€‹å¯¹äºæœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿ï¼ŒECCå¯†ç ç³»ç»Ÿå®šä¹‰äº†ä¸€ä¸ªç‰¹æ®Šçš„é¢„å®šä¹‰ï¼ˆæ’å®šï¼‰ECç‚¹ï¼Œç§°ä¸ºç”Ÿæˆå™¨ç‚¹Gï¼ˆ<strong><a href="https://en.wikipedia.org/wiki/Generating_set_of_a_group" target="_blank" rel="noopener">generator point G</a></strong>ï¼Œ<strong>base point</strong>ï¼‰ï¼Œè¯¥ç‚¹å¯ä»¥é€šè¿‡å°†Gä¹˜ä»¥æŸä¸ªæ•´æ•°æ¥ç”Ÿæˆå…¶åœ¨æ¤­åœ†æ›²çº¿ä¸Šçš„å­ç¾¤ä¸­åœ¨[0 â€¦ r]èŒƒå›´å†…çš„ä»»ä½•å…¶ä»–ç‚¹ã€‚è¿™ä¸ªæ•°å­— <strong>r</strong> ç§°ä¸ºå¾ªç¯å­ç¾¤çš„â€œåºâ€(å­ç¾¤ä¸­æ‰€æœ‰ç‚¹çš„æ€»æ•°)ã€‚</p>
<p>â€‹å¯¹äºä½™å­å¼ <code>h</code> = 1 çš„æ›²çº¿ï¼Œåªæœ‰ä¸€ä¸ªå­ç¾¤ï¼Œæ›²çº¿çš„åº <code>n</code>ï¼ˆæ›²çº¿ä¸Šä¸åŒç‚¹çš„æ€»æ•°ï¼ŒåŒ…æ‹¬æ— ç©·å¤§ï¼‰ç­‰äºæ•°rã€‚</p>
<p>â€‹å½“é€‰æ‹©å¥½ G å’Œ nï¼Œä¸” cofactor = 1æ—¶ï¼Œå¯ä»¥é€šè¿‡å°†ç”Ÿæˆå™¨ç‚¹Gä¹˜ä»¥[1 â€¦ n]èŒƒå›´å†…çš„æ•´æ•°ï¼Œä»ç”Ÿæˆå™¨ç‚¹Gç”Ÿæˆæ›²çº¿ä¸Šæ‰€æœ‰å¯èƒ½çš„ECç‚¹ï¼ˆåŒ…æ‹¬ç‰¹æ®Šç‚¹æ— ç©·å¤§ï¼‰ã€‚è¯¥æ•´æ•°<code>n</code>è¢«ç§°ä¸ºâ€œæ›²çº¿çš„åºâ€ã€‚</p>
<p>â€‹ä»æŸä¸ªECç”Ÿæˆå™¨ç‚¹Gï¼ˆå¯èƒ½ä¸æ›²çº¿çš„ åºä¸åŒï¼‰è·å¾—çš„å­ç¾¤çš„åº <code>r</code> å®šä¹‰äº†è¯¥æ›²çº¿æ‰€æœ‰å¯èƒ½çš„ç§é’¥çš„æ€»æ•°ï¼š$ r = n / h$</p>
<p>â€‹å¯†ç å­¦å®¶ç²¾å¿ƒé€‰æ‹©æ¤­åœ†æ›²çº¿åŸŸå‚æ•°ï¼ˆæ›²çº¿æ–¹ç¨‹ï¼Œç”Ÿæˆå™¨ç‚¹ï¼Œä½™å­å¼ç­‰ï¼‰ï¼Œä»¥ç¡®ä¿å¯†é’¥ç©ºé—´è¶³å¤Ÿå¤§ï¼Œè¶³ä»¥ä¿è¯ä¸€å®šçš„å¯†ç å¼ºåº¦ã€‚</p>
<p>â€‹<strong>æ€»è€Œè¨€ä¹‹</strong>ï¼Œåœ¨ECCå¯†ç å­¦ä¸­ï¼ŒECç‚¹ä¸ç”Ÿæˆå™¨ç‚¹Gä¸€èµ·å½¢æˆå¾ªç¯ç¾¤ï¼ˆæˆ–å¾ªç¯å­ç¾¤ï¼‰ï¼Œè¿™æ„å‘³ç€å­˜åœ¨æ•° rï¼ˆr&gt; 1ï¼‰ï¼Œä»è€Œr * G = 0 * G = <strong>infinity</strong> å­ç¾¤ä¸­çš„æ‰€æœ‰ç‚¹éƒ½å¯ä»¥é€šè¿‡å°†Gä¹˜ä»¥[1 â€¦ r]èŒƒå›´å†…çš„æ•´æ•°æ¥è·å¾—ã€‚æ•°å­— r ç§°ä¸ºç»„ï¼ˆæˆ–å­ç¾¤ï¼‰çš„â€œåºâ€ã€‚</p>
<p>â€‹æ¤­åœ†æ›²çº¿å­ç¾¤é€šå¸¸å…·æœ‰è®¸å¤šç”Ÿæˆå™¨ç‚¹ï¼Œä½†æ˜¯å¯†ç å­¦å®¶ä¼šä»”ç»†é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªï¼Œä»è€Œç”Ÿæˆæ•´ä¸ªç¾¤ï¼ˆæˆ–å­ç¾¤ï¼‰ï¼Œå¹¶ä¸”é€‚åˆäºè®¡ç®—ä¸­çš„æ€§èƒ½ä¼˜åŒ–ã€‚</p>
<p>â€‹ä¼—æ‰€å‘¨çŸ¥ï¼Œå¯¹äºæŸäº›æ›²çº¿ï¼Œä¸åŒçš„ç”Ÿæˆå™¨ç‚¹ä¼šç”Ÿæˆä¸åŒâ€œåºâ€çš„å­ç¾¤ã€‚ æ›´å‡†ç¡®åœ°è¯´ï¼Œå¦‚æœç»„åºä¸ºnï¼Œåˆ™å¯¹äºæ¯ä¸ªé™¤ä»¥nçš„ç´ æ•°dï¼Œéƒ½ä¼šå­˜åœ¨ä¸€ä¸ªç‚¹Qï¼Œä½¿å¾—d * Q =<strong>infinity</strong>ã€‚ è¿™æ„å‘³ç€ç”¨ä½œåŒä¸€æ¡æ›²çº¿çš„ç”Ÿæˆå™¨çš„æŸäº›ç‚¹å°†æ¯”å…¶ä»–ç‚¹ç”Ÿæˆæ›´å°çš„å­ç¾¤ã€‚ å¦‚æœ <code>r</code> è¾ƒå°ï¼Œåˆ™å®‰å…¨æ€§è¾ƒå¼±ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ <strong><a href="https://tools.ietf.org/html/rfc2785" target="_blank" rel="noopener">â€œsmall-subgroupâ€ attacks</a></strong>ã€‚è¿™å°±æ˜¯å¯†ç å­¦å®¶é€šå¸¸é€‰æ‹©å­ç¾¤åº r ä¸ºè´¨æ•°çš„åŸå› ã€‚</p>
<p>â€‹å¯¹äºä½™å­å¼ h &gt; 1çš„æ¤­åœ†æ›²çº¿ï¼Œä¸åŒçš„åŸºç‚¹å¯ä»¥åœ¨æ›²çº¿ä¸Šç”ŸæˆECç‚¹çš„ä¸åŒå­ç¾¤ã€‚ é€šè¿‡é€‰æ‹©æŸä¸ªç”Ÿæˆå™¨ç‚¹ï¼Œæˆ‘ä»¬é€‰æ‹©åœ¨æ›²çº¿ä¸Šçš„æŸä¸ªå­ç¾¤ä¸Šè¿›è¡Œæ“ä½œï¼Œä½¿å¾—å¤§å¤šæ•°ECç‚¹æ“ä½œå’ŒECCåŠ å¯†ç®—æ³•å¾ˆå¥½åœ°å·¥ä½œã€‚åº”è¯¥ç‰¹åˆ«æ³¨æ„ï¼Œåº”è¯¥ä»…ä½¿ç”¨ç»è¿‡éªŒè¯çš„ECCå®ç°ï¼Œç®—æ³•å’Œè½¯ä»¶åŒ…ã€‚</p>
<h3 id="1146-ç”Ÿæˆå™¨ç‚¹ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#1146-ç”Ÿæˆå™¨ç‚¹ç¤ºä¾‹"></a> 11.4.6 â€œç”Ÿæˆå™¨â€ç‚¹ç¤ºä¾‹</h3>
<p>â€‹åœ¨ä¸Šé¢çš„ç¤ºä¾‹ï¼ˆæœ‰é™åŸŸ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>â‰¡</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>7</mn><mspace width="1em"/><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mn>17</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^2â‰¡x^3 + 7 \quad(mod \quad 17)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">1</span><span class="mord">7</span><span class="mclose">)</span></span></span></span>ä¸Šçš„ECç‚¹ï¼‰ä¸Šï¼Œå¦‚æœæˆ‘ä»¬å°†ç‚¹G = {15ï¼Œ13}ä½œä¸ºç”Ÿæˆå™¨ç‚¹ï¼Œåˆ™æ›²çº¿ä¸Šçš„ä»»ä½•å…¶ä»–ç‚¹éƒ½å¯ä»¥é€šè¿‡å°†Gä¹˜ä»¥ range[1 â€¦ 18]ã€‚ å› æ­¤ï¼Œæ­¤ECçš„ åº n = 18ï¼Œå…¶ä½™å­å¼ h = 1ã€‚æ›²çº¿å…·æœ‰17ä¸ªæ­£å¸¸ECç‚¹ï¼ˆå¦‚ä¸Šå›¾æ‰€ç¤ºï¼‰+ ä¸€ä¸ªç‰¹æ®Šçš„â€œæ— ç©·è¿œç‚¹â€ï¼Œå…¨éƒ¨ä½äºä¸€ä¸ªå­ç¾¤ä¸­ï¼Œå¹¶ä¸”æ›²çº¿é¡ºåºä¸º18ï¼ˆè€Œä¸æ˜¯17ï¼‰ã€‚</p>
<p>â€‹å¦‚æœæˆ‘ä»¬å°†ç‚¹{5ï¼Œ9}ä½œä¸ºç”Ÿæˆå™¨ï¼Œå®ƒå°†ä»…ç”Ÿæˆ3ä¸ªECç‚¹ï¼š{5ï¼Œ8}ï¼Œ{5ï¼Œ9}å’Œæ— ç©·å¤§ç‚¹ã€‚ ç”±äºæ›²çº¿ åº ä¸æ˜¯ç´ æ•°ï¼Œå› æ­¤ä¸åŒçš„ç”Ÿæˆå™¨å¯èƒ½ä¼šç”Ÿæˆä¸åŒ åº çš„å­ç¾¤ã€‚ è¿™æ˜¯ä¸€ä¸ª â€œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸åº”è¯¥å‡ºäºåŠ å¯†ç›®çš„è€Œâ€œå‘æ˜â€è‡ªå·±çš„æ¤­åœ†æ›²çº¿ï¼Œè€Œåº”è¯¥ä½¿ç”¨ç»è¿‡éªŒè¯çš„æ›²çº¿â€çš„ä¾‹å­ï¼Œã€‚</p>
<h3 id="1147-eccä¸­çš„ç§é’¥å…¬é’¥å’Œç”Ÿæˆå™¨ç‚¹"><a class="markdownIt-Anchor" href="#1147-eccä¸­çš„ç§é’¥å…¬é’¥å’Œç”Ÿæˆå™¨ç‚¹"></a> 11.4.7 ECCä¸­çš„ç§é’¥ï¼Œå…¬é’¥å’Œç”Ÿæˆå™¨ç‚¹</h3>
<p>â€‹åœ¨ECCä¸­ï¼Œå½“å°†å›ºå®šçš„ECç‚¹Gï¼ˆç”Ÿæˆå™¨ç‚¹ï¼‰ä¹˜ä»¥æŸä¸ªæ•´æ•°kï¼ˆkå¯ä»¥è§†ä¸ºç§é’¥ï¼‰æ—¶ï¼Œæˆ‘ä»¬è·å¾—ECç‚¹Pï¼ˆå³kå¯¹åº”çš„å…¬é’¥ï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨ECCä¸­ï¼Œæˆ‘ä»¬å…·æœ‰ï¼š</p>
<ul>
<li>æœ‰é™åŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">ğ”½p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord mathbb">F</span><span class="mord mathdefault">p</span></span></span></span>ä¸Šçš„æ¤­åœ†æ›²çº¿ï¼ˆECï¼‰</li>
<li>$ G == generator \quad point $ (ECçš„åŸºç‚¹);</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mo>=</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>e</mi><mspace width="1em"/><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">k ==private \quad key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>  æ•´æ•°</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>=</mo><mo>=</mo><mi>p</mi><mi>u</mi><mi>b</mi><mi>l</mi><mi>i</mi><mi>c</mi><mspace width="1em"/><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">P == public \quad key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> ç‚¹</li>
</ul>
<p>â€‹é€šè¿‡çš„ECCä¹˜æ³•ç®—æ³•<a href="https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication" target="_blank" rel="noopener">ECC multiplication algorithms</a>ï¼Œå¯ä»¥å¾ˆå¿«åœ°è®¡ç®—å‡º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>=</mo><mi>k</mi><mo>â‹…</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">P = k \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span> ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºï¼š <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo><mi>log</mi><mo>â¡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log _2 (k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>ï¼Œ</p>
<p>è®¡ç®—<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mi>P</mi><mi mathvariant="normal">/</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">k = P / G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord">/</span><span class="mord mathdefault">G</span></span></span></span>éå¸¸æ…¢ï¼ˆå¯¹äºå¤§kè€Œè¨€ï¼Œè¿™æ˜¯ä¸å¯è¡Œçš„ï¼‰ã€‚</p>
<p>è¿™ç§ä¸å¯¹ç§°æ€§ï¼ˆå¿«é€Ÿä¹˜æ³•å’Œä¸å¯è¡Œçš„æ…¢é€Ÿç›¸åæ“ä½œï¼‰æ˜¯ECCå¯†ç å­¦èƒŒåçš„å®‰å…¨å¼ºåº¦çš„åŸºç¡€ï¼Œä¹Ÿç§°ä¸ºECDLPé—®é¢˜ã€‚</p>
<h3 id="1148-æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ecdlp"><a class="markdownIt-Anchor" href="#1148-æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ecdlp"></a> 11.4.8 æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰</h3>
<p>â€‹è®¡ç®—æœºç§‘å­¦ä¸­çš„æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰å®šä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li>é€šè¿‡åœ¨æœ‰é™åŸŸ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">ğ”½p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord mathbb">F</span><span class="mord mathdefault">p</span></span></span></span>ä¸Šç»™å®šæ¤­åœ†æ›²çº¿ï¼Œå¹¶å·²çŸ¥åœ¨æ›²çº¿ä¸Šç”Ÿæˆç‚¹Gå’Œåœ¨æ›²çº¿ä¸Šç‚¹Pï¼Œæ±‚å‡ºæ•´æ•°kï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œä½¿å¾—<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>=</mo><mi>k</mi><mo>â‹…</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">P = k \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span> ï¼›</li>
</ul>
<p>â€‹å¯¹äºï¼ˆç”±å¯†ç å­¦å®¶ç²¾å¿ƒé€‰æ‹©çš„ï¼‰æœ‰é™åŸŸå’Œæ¤­åœ†æ›²çº¿ï¼ŒECDLPé—®é¢˜æ²¡æœ‰æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>â€‹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ”½</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">ğ”½p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord mathbb">F</span><span class="mord mathdefault">p</span></span></span></span>ç¾¤ä¸­æ¤­åœ†æ›²çº¿ç‚¹çš„ä¹˜æ³•ç±»ä¼¼äº <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Z</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">â„¤p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="mord amsrm">Z</span><span class="mord mathdefault">p</span></span></span></span> ç»„ä¸­æ•´æ•°çš„å¹‚ï¼ˆè¿™å°±æ˜¯ä¹˜æ³•ç¬¦å·ï¼‰ï¼Œè¿™å°±æ˜¯ECDLPé—®é¢˜ä¸DLPé—®é¢˜ï¼ˆ<a href="https://wizardforcel.gitbooks.io/practical-cryptography-for-developers-book/key-exchange/diffie-hellman-key-exchange.html#discrete-logarithm-problem-dlp" target="_blank" rel="noopener"><strong>DLP problem</strong></a>ï¼Œç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰çš„ç›¸ä¼¼ä¹‹å¤„ã€‚</p>
<h3 id="1149-ecç‚¹çš„ä¹˜æ³•-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#1149-ecç‚¹çš„ä¹˜æ³•-ç¤ºä¾‹"></a> 11.4.9 ECç‚¹çš„ä¹˜æ³•-ç¤ºä¾‹</h3>
<p>â€‹é¦–å…ˆï¼Œå®‰è£…è½¯ä»¶åŒ…tinecï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install tinyec</span><br></pre></td></tr></table></figure>
<p>â€‹æˆ‘ä»¬å°†ä½¿ç”¨å‰é¢ç¤ºä¾‹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>â‰¡</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>7</mn><mspace width="1em"/><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mn>17</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^2â‰¡x^3 + 7 \quad(mod \quad 17)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">1</span><span class="mord">7</span><span class="mclose">)</span></span></span></span> å¯¹åº”çš„æ›²çº¿ï¼Œç”Ÿæˆç‚¹G = {15ï¼Œ13}ï¼Œå…¶åºä¸ºn =18ã€‚æˆ‘ä»¬å°†å…¶å‘½åä¸ºp1707ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec.ec <span class="keyword">import</span> SubGroup, Curve</span><br><span class="line"></span><br><span class="line">field = SubGroup(p=<span class="number">17</span>, g=(<span class="number">15</span>, <span class="number">13</span>), n=<span class="number">18</span>, h=<span class="number">1</span>)</span><br><span class="line">curve = Curve(a=<span class="number">0</span>, b=<span class="number">7</span>, field=field, name=<span class="string">'p1707'</span>)</span><br><span class="line">print(<span class="string">'curve:'</span>, curve)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">25</span>):</span><br><span class="line">    p = k * curve.g</span><br><span class="line">    print(<span class="string">f"<span class="subst">&#123;k&#125;</span> * G = (<span class="subst">&#123;p.x&#125;</span>, <span class="subst">&#123;p.y&#125;</span>)"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">curve: &quot;p1707&quot; &#x3D;&gt; y^2 &#x3D; x^3 + 0x + 7 (mod 17)</span><br><span class="line">0 * G &#x3D; (None, None)</span><br><span class="line">1 * G &#x3D; (15, 13)</span><br><span class="line">2 * G &#x3D; (2, 10)</span><br><span class="line">3 * G &#x3D; (8, 3)</span><br><span class="line">4 * G &#x3D; (12, 1)</span><br><span class="line">5 * G &#x3D; (6, 6)</span><br><span class="line">6 * G &#x3D; (5, 8)</span><br><span class="line">7 * G &#x3D; (10, 15)</span><br><span class="line">8 * G &#x3D; (1, 12)</span><br><span class="line">9 * G &#x3D; (3, 0)</span><br><span class="line">10 * G &#x3D; (1, 5)</span><br><span class="line">11 * G &#x3D; (10, 2)</span><br><span class="line">12 * G &#x3D; (5, 9)</span><br><span class="line">13 * G &#x3D; (6, 11)</span><br><span class="line">14 * G &#x3D; (12, 16)</span><br><span class="line">15 * G &#x3D; (8, 14)</span><br><span class="line">16 * G &#x3D; (2, 7)</span><br><span class="line">17 * G &#x3D; (15, 4)</span><br><span class="line">18 * G &#x3D; (None, None)</span><br><span class="line">19 * G &#x3D; (15, 13)</span><br><span class="line">20 * G &#x3D; (2, 10)</span><br><span class="line">21 * G &#x3D; (8, 3)</span><br><span class="line">22 * G &#x3D; (12, 1)</span><br><span class="line">23 * G &#x3D; (6, 6)</span><br><span class="line">24 * G &#x3D; (5, 8)</span><br></pre></td></tr></table></figure>
<p>â€‹å¯è§0 * G =æ— ç©·å¤§ã€‚ åŒæ ·æ¸…æ¥šå¯è§ï¼ŒECç¾¤æ˜¯å¾ªç¯çš„ï¼ŒECç¾¤çš„åºæ˜¯n = 18ï¼Œå› ä¸ºä»k = 18å¼€å§‹ï¼Œæ¥ä¸‹æ¥çš„ç‚¹é‡å¤ç¬¬ä¸€ä¸ªç‚¹ï¼š</p>
<ul>
<li><strong>18</strong> * <strong>G</strong> = <strong>0</strong> * <strong>G</strong> = <em>infinity</em></li>
<li><strong>19</strong> * <strong>G</strong> = <strong>1</strong> * <strong>G</strong> = {15, 13}</li>
<li><strong>20</strong> * <strong>G</strong> = <strong>2</strong> * <strong>G</strong> = {2, 10}</li>
<li><strong>21</strong> * <strong>G</strong> = <strong>3</strong> * <strong>G</strong> = {8, 3}</li>
<li>etc.</li>
</ul>
<p>â€‹ä¸‹å›¾æ˜¾ç¤ºäº†é€šè¿‡å°†ç”Ÿæˆå™¨ç‚¹Gä¹˜ä»¥2ã€3ã€4ï¼Œâ€¦ï¼Œ17ç”Ÿæˆçš„ECç‚¹ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/G.png" alt="G -c" /></p>
<p>â€‹è®©æˆ‘ä»¬å¯¹ä¸Šé¢çš„ç¤ºä¾‹è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œå¹¶å°†ç”Ÿæˆå™¨ç‚¹æ›´æ”¹ä¸ºGâ€™= {5ï¼Œ9}ã€‚ è¿™å°†æ˜¾ç€æ”¹å˜è¾“å‡ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec.ec <span class="keyword">import</span> SubGroup, Curve</span><br><span class="line"></span><br><span class="line">field = SubGroup(p=<span class="number">17</span>, g=(<span class="number">5</span>, <span class="number">9</span>), n=<span class="number">18</span>, h=<span class="number">1</span>)</span><br><span class="line">curve = Curve(a=<span class="number">0</span>, b=<span class="number">7</span>, field=field, name=<span class="string">'p1707'</span>)</span><br><span class="line">print(<span class="string">'curve:'</span>, curve)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">25</span>):</span><br><span class="line">    p = k * curve.g</span><br><span class="line">    print(<span class="string">f"<span class="subst">&#123;k&#125;</span> * G' = (<span class="subst">&#123;p.x&#125;</span>, <span class="subst">&#123;p.y&#125;</span>)"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">curve: &quot;p1707&quot; &#x3D;&gt; y^2 &#x3D; x^3 + 0x + 7 (mod 17)</span><br><span class="line">0 * G&#39; &#x3D; (None, None)</span><br><span class="line">1 * G&#39; &#x3D; (5, 9)</span><br><span class="line">2 * G&#39; &#x3D; (5, 8)</span><br><span class="line">3 * G&#39; &#x3D; (None, None)</span><br><span class="line">4 * G&#39; &#x3D; (5, 9)</span><br><span class="line">5 * G&#39; &#x3D; (5, 8)</span><br><span class="line">6 * G&#39; &#x3D; (None, None)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>â€‹ä¸Šé¢çš„ç¤ºä¾‹å†æ¬¡ç¡®è®¤ï¼Œä¸ºåŠ å¯†è®¾è®¡æ¤­åœ†æ›²çº¿åº”è¯¥ç”±å¯†ç å­¦å®¶è€Œä¸æ˜¯å¼€å‘äººå‘˜å®Œæˆã€‚ å¼€å‘äººå‘˜åº”ä¾èµ–å®Œå–„çš„åŠ å¯†æ ‡å‡†å’Œç»è¿‡éªŒè¯çš„åŠ å¯†åº“ã€‚</p>
<h3 id="11410-ecç‚¹çš„ä¹˜æ³•-çœŸå®ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#11410-ecç‚¹çš„ä¹˜æ³•-çœŸå®ç¤ºä¾‹"></a> 11.4.10 ECç‚¹çš„ä¹˜æ³•-çœŸå®ç¤ºä¾‹</h3>
<p>â€‹æˆ‘ä»¬ä½¿ç”¨192ä½å¯†ç æ›²çº¿secp192r1ï¼ˆ192ä½ï¼Œp = 6277101735386680763835789423207666416083908700390324961279ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec <span class="keyword">import</span> registry</span><br><span class="line"></span><br><span class="line">curve = registry.get_curve(<span class="string">'secp192r1'</span>)</span><br><span class="line">print(<span class="string">'curve:'</span>, curve)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">10</span>):</span><br><span class="line">    p = k * curve.g</span><br><span class="line">    print(<span class="string">f"<span class="subst">&#123;k&#125;</span> * G = (<span class="subst">&#123;p.x&#125;</span>, <span class="subst">&#123;p.y&#125;</span>)"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Cofactor ="</span>, curve.field.h)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Cyclic group order ='</span>, curve.field.n)</span><br><span class="line"></span><br><span class="line">nG = curve.field.n * curve.g</span><br><span class="line">print(<span class="string">f"n * G = (<span class="subst">&#123;nG.x&#125;</span>, <span class="subst">&#123;nG.y&#125;</span>)"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">curve: &quot;secp192r1&quot; &#x3D;&gt; y^2 &#x3D; x^3 + 6277101735386680763835789423207666416083908700390324961276x + 2455155546008943817740293915197451784769108058161191238065 (mod 6277101735386680763835789423207666416083908700390324961279)</span><br><span class="line">0 * G &#x3D; (None, None)</span><br><span class="line">1 * G &#x3D; (602046282375688656758213480587526111916698976636884684818, 174050332293622031404857552280219410364023488927386650641)</span><br><span class="line">2 * G &#x3D; (5369744403678710563432458361254544170966096384586764429448, 5429234379789071039750654906915254128254326554272718558123)</span><br><span class="line">3 * G &#x3D; (2915109630280678890720206779706963455590627465886103135194, 2946626711558792003980654088990112021985937607003425539581)</span><br><span class="line">4 * G &#x3D; (1305994880430903997305943738697779408316929565234787837114, 3981863977451150342116987835776121688410789618551673306674)</span><br><span class="line">5 * G &#x3D; (410283251116784874018993562136566870110676706936762660240, 1206654674899825246688205669651974202006189255452737318561)</span><br><span class="line">6 * G &#x3D; (4008504146453526025173196900303594155799995627910231899946, 3263759301305176906990806636587838100022690095020155627760)</span><br><span class="line">7 * G &#x3D; (3473339081378406123852871299395262476289672479707038350589, 2152713176906603604200842901176476029776544337891569565621)</span><br><span class="line">8 * G &#x3D; (1167950611014894512313033362696697441497340081390841490910, 4002177906111215127148483369584652296488769677804145538752)</span><br><span class="line">9 * G &#x3D; (3176317450453705650283775811228493626776489433309636475023, 44601893774669384766793803854980115179612118075017062201)</span><br><span class="line">Cofactor &#x3D; 1</span><br><span class="line">Cyclic group order &#x3D; 6277101735386680763835789423176059013767194773182842284081</span><br><span class="line">n * G &#x3D; (None, None)</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªéšæœºçš„ç§é’¥<code>privKey</code>ï¼ˆèŒƒå›´ä¸º[0 â€¦ n-1]çš„æ•´æ•°ï¼‰åŠå…¶å¯¹åº”çš„å…¬é’¥<br />
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>u</mi><mi>b</mi><mi>K</mi><mi>e</mi><mi>y</mi><mo>=</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>K</mi><mi>e</mi><mi>y</mi><mo>â‹…</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">pubKey = privKey \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec <span class="keyword">import</span> registry</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">curve = registry.get_curve(<span class="string">'secp192r1'</span>)</span><br><span class="line"></span><br><span class="line">privKey = secrets.randbelow(curve.field.n)</span><br><span class="line">pubKey = privKey * curve.g</span><br><span class="line">print(<span class="string">"private key:"</span>, privKey)</span><br><span class="line">print(<span class="string">"public key:"</span>, pubKey)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">private key: 4225655318977962031264230130242180748818603147467615868902</span><br><span class="line">public key: (5396030834456770190396776530938374882273836179487834152291, 3422160588166914010077732710830109086004758012634997793937) on &quot;secp192r1&quot; &#x3D;&gt; y^2 &#x3D; x^3 + 6277101735386680763835789423207666416083908700390324961276x + 2455155546008943817740293915197451784769108058161191238065 (mod 6277101735386680763835789423207666416083908700390324961279)</span><br></pre></td></tr></table></figure>
<p>ç¨åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ­¤ECCå¯†é’¥å¯¹ï¼ˆç§é’¥ï¼Œå…¬é’¥ï¼‰å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œç­¾åæ¶ˆæ¯å¹¶éªŒè¯ç­¾åã€‚</p>
<h3 id="11411-eccçš„æ¤­åœ†æ›²çº¿åŸŸå‚æ•°"><a class="markdownIt-Anchor" href="#11411-eccçš„æ¤­åœ†æ›²çº¿åŸŸå‚æ•°"></a> 11.4.11 ECCçš„æ¤­åœ†æ›²çº¿åŸŸå‚æ•°</h3>
<p>â€‹ECCæ¤­åœ†æ›²çº¿ç”±ä¸€ç»„æ¤­åœ†æ›²çº¿åŸŸå‚æ•°æ¥æè¿°ï¼Œä¾‹å¦‚æ›²çº¿æ–¹ç¨‹å‚æ•°ï¼Œåœºå‚æ•°å’Œç”Ÿæˆå™¨ç‚¹åæ ‡ã€‚ è¿™äº›å‚æ•°åœ¨åŠ å¯†æ ‡å‡†ä¸­æŒ‡å®šï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><a href="http://www.secg.org/sec2-v2.pdf" target="_blank" rel="noopener">SEC 2: Recommended Elliptic Curve Domain Parameters</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf" target="_blank" rel="noopener">NIST FIPS PUB 186-4 Digital Signature Standard (DSS)</a></li>
<li><a href="https://tools.ietf.org/html/rfc5639" target="_blank" rel="noopener">Brainpool ECC Standard (RFC-5639)</a></li>
</ul>
<p>â€‹è¿™äº›æ ‡å‡†å®šä¹‰äº†ä¸€ç»„å‘½åæ›²çº¿çš„å‚æ•°ï¼Œä¾‹å¦‚<code>secp256k1</code>ï¼Œ<code>P-521</code>å’Œ<code>brainpoolP512t1</code>ã€‚ è¿™äº›å¯†ç æ ‡å‡†ä¸­æè¿°çš„æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿å·²å—åˆ°å¯†ç å­¦å®¶çš„å……åˆ†ç ”ç©¶å’Œåˆ†æï¼Œå¹¶è¢«è®¤ä¸ºå…·æœ‰ä¸€å®šçš„å®‰å…¨å¼ºåº¦ï¼Œè¿™äº›æ ‡å‡†ä¸­ä¹Ÿå¯¹æ­¤è¿›è¡Œäº†æè¿°ã€‚</p>
<h4 id="114111-ä¸ºeccé€‰æ‹©æ¤­åœ†æ›²çº¿"><a class="markdownIt-Anchor" href="#114111-ä¸ºeccé€‰æ‹©æ¤­åœ†æ›²çº¿"></a> 11.4.11.1 ä¸ºECCé€‰æ‹©æ¤­åœ†æ›²çº¿</h4>
<p>â€‹ä½¿ç”¨ECCå‰ï¼Œæ‰€æœ‰é€šä¿¡æ–¹éƒ½åº”å°±ECåŸŸå‚æ•°ï¼ˆå®šä¹‰æ¤­åœ†æ›²çº¿çš„æ‰€æœ‰å…ƒç´ ï¼‰è¾¾æˆä¸€è‡´ã€‚ å¼ºçƒˆå»ºè®®ä½¿ç”¨ä¸Šè¿°æ ‡å‡†ä¸­è‡³å°‘256ä½çš„å‘½åæ›²çº¿ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ä¸è¦ä½¿ç”¨è‡ªå·±çš„æ¤­åœ†æ›²çº¿ï¼ˆå¸¦æœ‰éæ ‡å‡†çš„åŸŸå‚æ•°ï¼‰ï¼Œé™¤éæ‚¨æ˜¯ç»éªŒä¸°å¯Œçš„å¯†ç ä¸“å®¶å¹¶ä¸”éå¸¸æ¸…æ¥šè‡ªå·±åœ¨åšä»€ä¹ˆï¼ è®¸å¤šæ›²çº¿éƒ½æœ‰å¼±ç‚¹ï¼Œè¿™ä½¿ECDLPé—®é¢˜å˜å¾—ä¸é‚£ä¹ˆå›°éš¾å¹¶æŸå®³äº†å®‰å…¨æ€§ã€‚ å¦‚æœæ‚¨æ‹…å¿ƒåé—¨æ›²çº¿ï¼Œè¯·ä½¿ç”¨â€œå®‰å…¨æ›²çº¿â€åˆ—è¡¨ï¼ˆ <a href="https://safecurves.cr.yp.to/" target="_blank" rel="noopener">SafeCurves list</a>ï¼‰ä¸­çš„æ ‡å‡†å®‰å…¨æ›²çº¿ã€‚</p>
<h4 id="114112-secp256k1æ›²çº¿çš„ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#114112-secp256k1æ›²çº¿çš„ç¤ºä¾‹"></a> 11.4.11.2 â€œ secp256k1â€æ›²çº¿çš„ç¤ºä¾‹</h4>
<p>â€‹è®©æˆ‘ä»¬å¯¹secp256k1æ›²çº¿æ‰§è¡Œä¸Šè¿°åŸŸå‚æ•°ã€‚ è®©æˆ‘ä»¬å®šä¹‰ECå¹¶è®¡ç®—æŸäº›ç§é’¥çš„å…¬é’¥ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tinyec.ec <span class="keyword">import</span> SubGroup, Curve</span><br><span class="line"></span><br><span class="line"><span class="comment"># Domain parameters for the `secp256k1` curve</span></span><br><span class="line"><span class="comment"># (as defined in http://www.secg.org/sec2-v2.pdf)</span></span><br><span class="line">name = <span class="string">'secp256k1'</span></span><br><span class="line">p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line">a = <span class="number">0x0000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line">b = <span class="number">0x0000000000000000000000000000000000000000000000000000000000000007</span></span><br><span class="line">g = (<span class="number">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span>,</span><br><span class="line">     <span class="number">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span>)</span><br><span class="line">h = <span class="number">1</span></span><br><span class="line">curve = Curve(a, b, SubGroup(p, g, n, h), name)</span><br><span class="line">print(<span class="string">'curve:'</span>, curve)</span><br><span class="line"></span><br><span class="line">privKey = int(<span class="string">'0x51897b64e85c3f714bba707e867914295a1377a7463a9dae8ea6a8b914246319'</span>, <span class="number">16</span>)</span><br><span class="line">print(<span class="string">'privKey:'</span>, hex(privKey)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">pubKey = curve.g * privKey</span><br><span class="line">pubKeyCompressed = <span class="string">'0'</span> + str(<span class="number">2</span> + pubKey.y % <span class="number">2</span>) + str(hex(pubKey.x)[<span class="number">2</span>:])</span><br><span class="line">print(<span class="string">'pubKey:'</span>, pubKeyCompressed)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curve: &quot;secp256k1&quot; &#x3D;&gt; y^2 &#x3D; x^3 + 0x + 7 (mod 115792089237316195423570985008687907853269984665640564039457584007908834671663)</span><br><span class="line">privKey: 51897b64e85c3f714bba707e867914295a1377a7463a9dae8ea6a8b914246319</span><br><span class="line">pubKey: 02f54ba86dc1ccb5bed0224d23f01ed87e4a443c47fc690d7797a13d41d2340e1a</span><br></pre></td></tr></table></figure>
<p>å…¬é’¥ä»¥æ ‡å‡†æ ¼å¼è¿›è¡Œå‹ç¼©å’Œç¼–ç ï¼ˆå°†yåæ ‡ç¼–ç ä¸ºå‰ç¼€02æˆ–03ï¼‰ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/10.%20The%20RSA%20Cryptosystem%20-%20Concepts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/10.%20The%20RSA%20Cryptosystem%20-%20Concepts/" class="post-title-link" itemprop="url">10. The RSA Cryptosystem - Concepts</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:21" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:21+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener"><strong>RSA cryptosystem</strong></a> æ˜¯æœ€æ—©çš„å…¬é’¥å¯†ç ç³»ç»Ÿä¹‹ä¸€ï¼ŒåŸºäºæ¨¡å¹‚çš„æ•°å­¦ç†è®ºï¼ˆ <a href="https://en.wikipedia.org/wiki/Modular_exponentiation" target="_blank" rel="noopener"><strong>modular exponentiations</strong></a>ï¼‰ä»¥åŠRSAé—®é¢˜( <a href="https://en.wikipedia.org/wiki/RSA_problem" target="_blank" rel="noopener"><strong>RSA problem</strong></a>)å’Œç´§å¯†ç›¸å…³çš„æ•´æ•°åˆ†è§£é—®é¢˜( <a href="https://en.wikipedia.org/wiki/Integer_factorization" target="_blank" rel="noopener"><strong>integer factorization problem</strong> (<strong>IFP</strong>)</a>)çš„è®¡ç®—éš¾åº¦ã€‚<strong>RSA</strong>ç®—æ³•ä»¥å…¶ä½œè€…çš„é¦–å­—æ¯å‘½åï¼ˆRivestâ€“Shamirâ€“Adlemanï¼‰ï¼Œåœ¨è®¡ç®—æœºå¯†ç å­¦çš„æ—©æœŸè¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>
<p>â€‹åæ¥ï¼Œéšç€<strong>ECC</strong>å¯†ç å­¦çš„å‘å±•ï¼Œç”±äºECCæ¯”RSAæ›´é«˜çš„å®‰å…¨æ€§å’ŒECCåœ¨ç›¸åŒå®‰å…¨çº§åˆ«ä¸‹å¯†é’¥é•¿åº¦æ›´çŸ­ï¼ŒECCåœ¨éå¯¹ç§°å¯†ç ç³»ç»Ÿä¸­é€æ¸å ä¸»å¯¼åœ°ä½ã€‚</p>
<p><strong>RSAç®—æ³•æä¾›ï¼š</strong></p>
<ul>
<li><strong>Key-pair generation</strong>ï¼šç”Ÿæˆéšæœºç§é’¥ï¼ˆé€šå¸¸å¤§å°ä¸º1024-4096ä½ï¼‰å’Œç›¸åº”çš„å…¬é’¥ã€‚</li>
<li><strong>Encryption</strong>ï¼šä½¿ç”¨å…¬é’¥åŠ å¯†ç§˜å¯†æ¶ˆæ¯ï¼ˆèŒƒå›´ä¸º[0 â€¦ key_length]çš„æ•´æ•°ï¼‰ï¼Œç„¶åä½¿ç”¨ç§é’¥å°†å…¶è§£å¯†ã€‚</li>
<li><strong>Digital signatures</strong>ï¼šä½¿ç”¨ç§é’¥ç­¾åæ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨å…¬é’¥éªŒè¯æ¶ˆæ¯ç­¾åã€‚</li>
<li><strong>Key exchange</strong>ï¼šå®‰å…¨åœ°ä¼ è¾“å¯†é’¥ï¼Œè¯¥å¯†é’¥ç¨åç”¨äºåŠ å¯†é€šä¿¡ã€‚</li>
</ul>
<p>â€‹RSAå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é•¿åº¦ä¸åŒçš„å¯†é’¥ï¼š1024ã€2048ã€3072ã€4096ã€8129ã€16384æˆ–æ›´å¤šä½ã€‚ 3072ä½åŠä»¥ä¸Šçš„å¯†é’¥é•¿åº¦è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚è¾ƒé•¿çš„å¯†é’¥å¯æä¾›æ›´é«˜çš„å®‰å…¨æ€§ï¼Œä½†ä¼šæ¶ˆè€—æ›´å¤šçš„è®¡ç®—æ—¶é—´ï¼Œå› æ­¤åœ¨å®‰å…¨æ€§å’Œé€Ÿåº¦ä¹‹é—´è¦è¿›è¡Œæƒè¡¡ã€‚å¤ªé•¿çš„RSAå¯†é’¥ï¼ˆä¾‹å¦‚50000ä½æˆ–65536ä½ï¼‰å¯¹äºå®é™…ä½¿ç”¨è€Œè¨€å¯èƒ½å¤ªæ…¢ï¼Œå¯†é’¥ç”Ÿæˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ã€‚</p>
<h2 id="101-rsaå¯†é’¥ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#101-rsaå¯†é’¥ç”Ÿæˆ"></a> 10.1 RSAå¯†é’¥ç”Ÿæˆ</h2>
<p>â€‹ç”ŸæˆRSAå…¬é’¥å’Œç§é’¥å¯¹æ¶‰åŠä»¥ä¸‹å†…å®¹ï¼š</p>
<p>â€‹ä½¿ç”¨æ•°è®ºä¸­çš„ä¸€äº›éå¹³å‡¡æ•°å­¦è®¡ç®—ï¼Œæ‰¾åˆ°ä¸‰ä¸ªéå¸¸å¤§çš„æ•´æ•°<strong>e</strong>ï¼Œ<strong>d</strong>å’Œ<strong>n</strong>ï¼Œæ»¡è¶³ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msup><mi>m</mi><mi>e</mi></msup><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo>â‰¡</mo><mi>m</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m^e)^d â‰¡ m(mod \quad n )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> å¯¹äºmå–å€¼èŒƒå›´ä¸º[0 â€¦ nï¼‰ï¼›</li>
</ul>
<p>æ•´æ•°nè¢«ç§°ä¸ºâ€œ<strong>æ¨¡æ•°</strong>â€ï¼Œå®ƒå®šä¹‰äº†RSAå¯†é’¥é•¿åº¦ã€‚ å®ƒé€šå¸¸æ˜¯éå¸¸å¤§çš„ç´ æ•°ï¼ˆä¾‹å¦‚2048ä½ï¼‰ã€‚</p>
<p>{nï¼Œe}æ˜¯å…¬ç”¨å¯†é’¥ã€‚ å®ƒæ—¨åœ¨ä¸æ‰€æœ‰äººå…±äº«ã€‚ æ•°å­—eç§°ä¸ºâ€œå…¬é’¥æŒ‡æ•°â€ã€‚ é€šå¸¸ä¸º65537ï¼ˆ0x010001ï¼‰ã€‚</p>
<p>{nï¼Œd}æ˜¯ç§é’¥ã€‚ å®ƒè¢«è®¾è®¡ä¸ºä¿å¯†çš„ã€‚ ä»å…¬é’¥{nï¼Œe}è®¡ç®—ç§é’¥å®é™…ä¸Šæ˜¯ä¸å¯è¡Œçš„ã€‚ æ•°å­—dç§°ä¸ºâ€œç§é’¥æŒ‡æ•°â€ï¼ˆç§˜å¯†æŒ‡æ•°ï¼‰</p>
<h3 id="1011-rsa-public-key"><a class="markdownIt-Anchor" href="#1011-rsa-public-key"></a> 10.1.1 RSA Public Key</h3>
<p>2048ä½RSAå…¬é’¥çš„ç¤ºä¾‹ï¼ˆè¡¨ç¤ºä¸º2048ä½åå…­è¿›åˆ¶æ•´æ•°æ¨¡æ•°nå’Œ24ä½å…¬é’¥æŒ‡æ•°eï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; 0xa709e2f84ac0e21eb0caa018cf7f697f774e96f8115fc2359e9cf60b1dd8d4048d974cdf8422bef6be3c162b04b916f7ea2133f0e3e4e0eee164859bd9c1e0ef0357c142f4f633b4add4aab86c8f8895cd33fbf4e024d9a3ad6be6267570b4a72d2c34354e0139e74ada665a16a2611490debb8e131a6cffc7ef25e74240803dd71a4fcd953c988111b0aa9bbc4c57024fc5e8c4462ad9049c7f1abed859c63455fa6d58b5cc34a3d3206ff74b9e96c336dbacf0cdd18ed0c66796ce00ab07f36b24cbe3342523fd8215a8e77f89e86a08db911f237459388dee642dae7cb2644a03e71ed5c6fa5077cf4090fafa556048b536b879a88f628698f0c7b420c4b7</span><br><span class="line">e &#x3D; 0x010001</span><br></pre></td></tr></table></figure>
<p>ç›¸åŒçš„RSAå…¬é’¥ï¼Œä»¥ä¼ ç»Ÿçš„RSAæ ¼å¼<a href="https://en.wikipedia.org/wiki/PKCS_8" target="_blank" rel="noopener">PKCS#8</a> <a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" target="_blank" rel="noopener">PEM</a> <a href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One" target="_blank" rel="noopener">ASN.1</a> ç¼–ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApwni+ErA4h6wyqAYz39p</span><br><span class="line">f3dOlvgRX8I1npz2Cx3Y1ASNl0zfhCK+9r48FisEuRb36iEz8OPk4O7hZIWb2cHg</span><br><span class="line">7wNXwUL09jO0rdSquGyPiJXNM&#x2F;v04CTZo61r5iZ1cLSnLSw0NU4BOedK2mZaFqJh</span><br><span class="line">FJDeu44TGmz&#x2F;x+8l50JAgD3XGk&#x2F;NlTyYgRGwqpu8TFcCT8XoxEYq2QScfxq+2FnG</span><br><span class="line">NFX6bVi1zDSj0yBv90uelsM226zwzdGO0MZnls4AqwfzayTL4zQlI&#x2F;2CFajnf4no</span><br><span class="line">agjbkR8jdFk4je5kLa58smRKA+ce1cb6UHfPQJD6+lVgSLU2uHmoj2KGmPDHtCDE</span><br><span class="line">twIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>
<h3 id="1012-rsa-private-key"><a class="markdownIt-Anchor" href="#1012-rsa-private-key"></a> 10.1.2 RSA Private Key</h3>
<p>ä¸ä¸Šè¿°ç»™å®šå…¬é’¥ç›¸å¯¹åº”çš„2048ä½RSAç§é’¥ç¤ºä¾‹ï¼ˆè¡¨ç¤ºä¸ºåå…­è¿›åˆ¶çš„2048ä½æ•´æ•°æ¨¡æ•°nå’Œ2048ä½ç§˜å¯†æŒ‡æ•°dï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; 0xa709e2f84ac0e21eb0caa018cf7f697f774e96f8115fc2359e9cf60b1dd8d4048d974cdf8422bef6be3c162b04b916f7ea2133f0e3e4e0eee164859bd9c1e0ef0357c142f4f633b4add4aab86c8f8895cd33fbf4e024d9a3ad6be6267570b4a72d2c34354e0139e74ada665a16a2611490debb8e131a6cffc7ef25e74240803dd71a4fcd953c988111b0aa9bbc4c57024fc5e8c4462ad9049c7f1abed859c63455fa6d58b5cc34a3d3206ff74b9e96c336dbacf0cdd18ed0c66796ce00ab07f36b24cbe3342523fd8215a8e77f89e86a08db911f237459388dee642dae7cb2644a03e71ed5c6fa5077cf4090fafa556048b536b879a88f628698f0c7b420c4b7</span><br><span class="line">d &#x3D; 0x10f22727e552e2c86ba06d7ed6de28326eef76d0128327cd64c5566368fdc1a9f740ad8dd221419a5550fc8c14b33fa9f058b9fa4044775aaf5c66a999a7da4d4fdb8141c25ee5294ea6a54331d045f25c9a5f7f47960acbae20fa27ab5669c80eaf235a1d0b1c22b8d750a191c0f0c9b3561aaa4934847101343920d84f24334d3af05fede0e355911c7db8b8de3bf435907c855c3d7eeede4f148df830b43dd360b43692239ac10e566f138fb4b30fb1af0603cfcf0cd8adf4349a0d0b93bf89804e7c2e24ca7615e51af66dccfdb71a1204e2107abbee4259f2cac917fafe3b029baf13c4dde7923c47ee3fec248390203a384b9eb773c154540c5196bce1</span><br></pre></td></tr></table></figure>
<p>ç›¸åŒçš„RSAç§é’¥ï¼Œä»¥ä¼ ç»Ÿçš„RSAæ ¼å¼<a href="https://en.wikipedia.org/wiki/PKCS_8" target="_blank" rel="noopener">PKCS#8</a> <a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" target="_blank" rel="noopener">PEM</a> <a href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One" target="_blank" rel="noopener">ASN.1</a> ç¼–ç ï¼Œçœ‹ä¸Šå»æ›´é•¿ä¸€äº›ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEApwni+ErA4h6wyqAYz39pf3dOlvgRX8I1npz2Cx3Y1ASNl0zf</span><br><span class="line">hCK+9r48FisEuRb36iEz8OPk4O7hZIWb2cHg7wNXwUL09jO0rdSquGyPiJXNM&#x2F;v0</span><br><span class="line">4CTZo61r5iZ1cLSnLSw0NU4BOedK2mZaFqJhFJDeu44TGmz&#x2F;x+8l50JAgD3XGk&#x2F;N</span><br><span class="line">lTyYgRGwqpu8TFcCT8XoxEYq2QScfxq+2FnGNFX6bVi1zDSj0yBv90uelsM226zw</span><br><span class="line">zdGO0MZnls4AqwfzayTL4zQlI&#x2F;2CFajnf4noagjbkR8jdFk4je5kLa58smRKA+ce</span><br><span class="line">1cb6UHfPQJD6+lVgSLU2uHmoj2KGmPDHtCDEtwIDAQABAoIBABDyJyflUuLIa6Bt</span><br><span class="line">ftbeKDJu73bQEoMnzWTFVmNo&#x2F;cGp90CtjdIhQZpVUPyMFLM&#x2F;qfBYufpARHdar1xm</span><br><span class="line">qZmn2k1P24FBwl7lKU6mpUMx0EXyXJpff0eWCsuuIPonq1ZpyA6vI1odCxwiuNdQ</span><br><span class="line">oZHA8MmzVhqqSTSEcQE0OSDYTyQzTTrwX+3g41WRHH24uN479DWQfIVcPX7u3k8U</span><br><span class="line">jfgwtD3TYLQ2kiOawQ5WbxOPtLMPsa8GA8&#x2F;PDNit9DSaDQuTv4mATnwuJMp2FeUa</span><br><span class="line">9m3M&#x2F;bcaEgTiEHq77kJZ8srJF&#x2F;r+OwKbrxPE3eeSPEfuP+wkg5AgOjhLnrdzwVRU</span><br><span class="line">DFGWvOECgYEAyIk7F0S0AGn2aryhw9CihDfimigCxEmtIO5q7mnItCfeQwYPsX72</span><br><span class="line">1fLpJNgfPc9DDfhAZ2hLSsBlAPLUOa0Cuny9PCBWVuxi1WjLVaeZCV2bF11mAgW2</span><br><span class="line">fjLkAXT34IX+HZl60VoetSWq9ibfkJHeCAPnh&#x2F;yjdB3Vs+2wxNkU8m8CgYEA1Tzm</span><br><span class="line">mjJq7M6f+zMo7DpRwFazGMmrLKFmHiGBY6sEg7EmoeH2CkAQePIGQw&#x2F;Rk16gWJR6</span><br><span class="line">DtUZ9666sjCH6&#x2F;79rx2xg+9AB76XTFFzIxOk9cm49cIosDMk4mogSfK0Zg8nVbyW</span><br><span class="line">5nEb&#x2F;&#x2F;9JCrZ18g4lD3IrT5VJoF4MhfdBUjAS1jkCgYB+RDIpv3+bNx0KLgWpFwgN</span><br><span class="line">Omb667B6SW2ya4x227KdBPFkwD9HYosnQZDdOxvIvmUZObPLqJan1aaDR2Krgi1S</span><br><span class="line">oNJCNpZGmwbMGvTU1Pd+Nys9NfjR0ykKIx7&#x2F;b9fXzman2ojDovvs0W&#x2F;pF6bzD3V&#x2F;</span><br><span class="line">FH5HWKLOrS5u4X3JJGqVDwKBgQCd953FwW&#x2F;gujld+EpqpdGGMTRAOrXqPC7QR3X5</span><br><span class="line">Beo0PPonlqOUeF07m9&#x2F;zsjZJfCJBPM0nS8sO54w7ESTAOYhpQBAPcx&#x2F;2HMUsrnIj</span><br><span class="line">HBxqUOQKe6l0zo6WhJQi8&#x2F;+cU8GKDEmlsUlS3iWYIA9EICJoTOW08R04BjQ00jS7</span><br><span class="line">1A1AUQKBgHlHrV&#x2F;6S&#x2F;4hjvMp+30hX5DpZviUDiwcGOGasmIYXAgwXepJUq0xN6aa</span><br><span class="line">lnT+ykLGSMMY&#x2F;LABQiNZALZQtwK35KTshnThK6zB4e9p8JUCVrFpssJ2NCrMY3SU</span><br><span class="line">qw87K1W6engeDrmunkJ&#x2F;PmvSDLYeGiYWmEKQbLQchTxx1IEddXkK</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<h2 id="102-rsaåŠ å¯†æ•°æ®"><a class="markdownIt-Anchor" href="#102-rsaåŠ å¯†æ•°æ®"></a> 10.2 RSAåŠ å¯†æ•°æ®</h2>
<p>é€šè¿‡ä»¥ä¸‹è½¬æ¢ï¼Œä½¿ç”¨ç›¸åº”çš„RSAå…¬é’¥{nï¼Œe}å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼š</p>
<ul>
<li>$ encryptedMsg = (msg)^e \quad mod \quad n$</li>
</ul>
<p>â€‹æ­¤å¤„çš„<strong>msg</strong>ä¸º[0 â€¦ nï¼‰èŒƒå›´å†…çš„æ•°å­—ï¼Œ åŠ å¯†å‰æ•°æ®åº”ç¼–ç ä¸º[0 â€¦ nï¼‰èŒƒå›´å†…çš„æ•´æ•°ï¼ˆ<a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding" target="_blank" rel="noopener">EAOP</a>ï¼‰ã€‚å¯¹äºè¾ƒå¤§çš„æ–‡æœ¬ï¼Œåº”ä½¿ç”¨æ··åˆåŠ å¯†ï¼ˆåŠ å¯†ä¸€ä¸ªå¯†é’¥ï¼Œå¹¶ä½¿ç”¨å¯¹ç§°åŠ å¯†æ¥åŠ å¯†æ–‡æœ¬ï¼Œè¯·å‚é˜… <a href="https://tools.ietf.org/html/rfc5990" target="_blank" rel="noopener">RSA-KEM</a>ï¼‰</p>
<p>â€‹ä¸Šé¢çš„æ“ä½œæ— æ³•é€†è½¬ï¼šæ²¡æœ‰æœ‰æ•ˆçš„ç®—æ³•å¯ä»¥æ ¹æ®<strong>encryptedMsg</strong>ï¼Œ<strong>e</strong> å’Œ <strong>n</strong>ï¼ˆè¯·å‚é˜…<a href="https://en.wikipedia.org/wiki/RSA_problem" target="_blank" rel="noopener">the RSA problem</a>ï¼‰æ¥è®¡ç®—msgï¼Œè¿™å€¼åœ¨è®¾è®¡ä¸Šéƒ½æ˜¯å¯ä»¥å…¬å¼€çš„ï¼ˆéç§˜å¯†çš„ï¼‰ã€‚</p>
<h2 id="103-rsaè§£å¯†æ•°æ®"><a class="markdownIt-Anchor" href="#103-rsaè§£å¯†æ•°æ®"></a> 10.3 RSAè§£å¯†æ•°æ®</h2>
<p>é€šè¿‡ä»¥ä¸‹è½¬æ¢ï¼Œä½¿ç”¨ç›¸åº”çš„RSAç§é’¥{nï¼Œd}å¯¹åŠ å¯†çš„æ¶ˆæ¯è¿›è¡Œè§£å¯†ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>M</mi><mi>s</mi><mi>g</mi><mo>=</mo><mo stretchy="false">(</mo><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>M</mi><mi>s</mi><mi>g</mi><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mi>n</mi></mrow><annotation encoding="application/x-tex">decryptedMsg = (encryptedMsg)^d \quad  mod \quad n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">n</span></span></span></span></li>
</ul>
<p>ä¸ºä»€ä¹ˆè¿™æ˜¯æ­£ç¡®çš„ï¼Ÿ å›æƒ³ä¸€ä¸‹ï¼ŒæŒ‰ç…§å®šä¹‰ï¼ŒRSAå¯†é’¥å¯¹å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msup><mi>m</mi><mi>e</mi></msup><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo>â‰¡</mo><mi>m</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m^e)^d â‰¡ m(mod \quad n )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> å¯¹äºmå–å€¼èŒƒå›´ä¸º[0 â€¦ nï¼‰ï¼›</li>
</ul>
<p>é€šè¿‡åŠ å¯†è½¬æ¢ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“</p>
<ul>
<li>$ encryptedMsg = (msg)^e \quad mod \quad n$</li>
</ul>
<p>å› æ­¤ï¼š</p>
<ul>
<li>$ decryptedMsg = (encryptedMsg)^d \quad mod \quad n = ((msg)^e \quad mod \quad n)^d = ((msg)<sup>e)</sup>d \quad mod \quad n = (msg) \quad mod \quad n = msg $</li>
</ul>
<h2 id="104-rsaåŠ å¯†å’Œè§£å¯†-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#104-rsaåŠ å¯†å’Œè§£å¯†-ç¤ºä¾‹"></a> 10.4 RSAåŠ å¯†å’Œè§£å¯†-ç¤ºä¾‹</h2>
<p>â€‹æ ¹æ®ä¸Šè¿°å…¬å¼ï¼Œè®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹RSAåŠ å¯†å’Œè§£å¯†çš„ç¤ºä¾‹ä»¥åŠè®¡ç®—æ–¹æ³•ã€‚ å‡è®¾æˆ‘ä»¬å·²ç»ç”Ÿæˆäº†RSAå…¬é’¥-ç§é’¥å¯¹ï¼š</p>
<ul>
<li>modulus <strong>n</strong> = 143</li>
<li>public exponent <strong>e</strong> = 7</li>
<li>private exponent <strong>d</strong> = 103</li>
<li>public key = {<strong>n</strong>, <strong>e</strong>} = {143, 7}</li>
<li>private key = {<strong>n</strong>, <strong>d</strong>} = {143, 103}</li>
</ul>
<p>è®©æˆ‘ä»¬åŠ å¯†ä¸€æ¡ç§˜å¯†æ¶ˆæ¯<strong>msg</strong> =83ã€‚åªéœ€éµå¾ªä»¥ä¸‹å…¬å¼ï¼š</p>
<ul>
<li>$ encryptedMsg = msg^e \quad mod \quad n = 83^7 \quad mod \quad 143 = 27136050989627 \quad mod \quad 143 = 8 $</li>
</ul>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†åŠ å¯†çš„æ¶ˆæ¯è§£å¯†å›å…¶åŸå§‹å€¼ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>M</mi><mi>s</mi><mi>g</mi><mo>=</mo><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>M</mi><mi>s</mi><msup><mi>g</mi><mi>d</mi></msup><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mi>n</mi><mo>=</mo><msup><mn>8</mn><mn>1</mn></msup><mn>03</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mn>143</mn><mo>=</mo><mn>1042962419883256876169444192465601618458351817556959360325703910069443225478828393565899456512</mn><mspace width="1em"/><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"/><mn>143</mn><mo>=</mo><mn>83</mn></mrow><annotation encoding="application/x-tex">decryptedMsg = encryptedMsg^d \quad mod \quad n = 8^103 \quad mod \quad 143 = 1042962419883256876169444192465601618458351817556959360325703910069443225478828393565899456512 \quad mod \quad 143 = 83</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">8</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mord">0</span><span class="mord">3</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">4</span><span class="mord">2</span><span class="mord">9</span><span class="mord">6</span><span class="mord">2</span><span class="mord">4</span><span class="mord">1</span><span class="mord">9</span><span class="mord">8</span><span class="mord">8</span><span class="mord">3</span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span><span class="mord">8</span><span class="mord">7</span><span class="mord">6</span><span class="mord">1</span><span class="mord">6</span><span class="mord">9</span><span class="mord">4</span><span class="mord">4</span><span class="mord">4</span><span class="mord">1</span><span class="mord">9</span><span class="mord">2</span><span class="mord">4</span><span class="mord">6</span><span class="mord">5</span><span class="mord">6</span><span class="mord">0</span><span class="mord">1</span><span class="mord">6</span><span class="mord">1</span><span class="mord">8</span><span class="mord">4</span><span class="mord">5</span><span class="mord">8</span><span class="mord">3</span><span class="mord">5</span><span class="mord">1</span><span class="mord">8</span><span class="mord">1</span><span class="mord">7</span><span class="mord">5</span><span class="mord">5</span><span class="mord">6</span><span class="mord">9</span><span class="mord">5</span><span class="mord">9</span><span class="mord">3</span><span class="mord">6</span><span class="mord">0</span><span class="mord">3</span><span class="mord">2</span><span class="mord">5</span><span class="mord">7</span><span class="mord">0</span><span class="mord">3</span><span class="mord">9</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">6</span><span class="mord">9</span><span class="mord">4</span><span class="mord">4</span><span class="mord">3</span><span class="mord">2</span><span class="mord">2</span><span class="mord">5</span><span class="mord">4</span><span class="mord">7</span><span class="mord">8</span><span class="mord">8</span><span class="mord">2</span><span class="mord">8</span><span class="mord">3</span><span class="mord">9</span><span class="mord">3</span><span class="mord">5</span><span class="mord">6</span><span class="mord">5</span><span class="mord">8</span><span class="mord">9</span><span class="mord">9</span><span class="mord">4</span><span class="mord">5</span><span class="mord">6</span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span><span class="mord">3</span></span></span></span></li>
</ul>
<p>â€‹RSAè®¡ç®—æ­£ç¡®è¿è¡Œã€‚ è¿™æ˜¯å› ä¸ºå¯†é’¥å¯¹æ»¡è¶³äº†ä¸Šè¿°RSAå±æ€§ã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œé€šå¸¸RSAæ¨¡æ•°nå’Œç§æœ‰æŒ‡æ•°dæ˜¯3072ä½æˆ–4096ä½æ•´æ•°ï¼Œå…¬é’¥æŒ‡æ•°eæ˜¯65537ã€‚</p>
<p><code>æ³¨</code>ï¼š<a href="http://doctrina.org/How-RSA-Works-With-Examples.html" target="_blank" rel="noopener">http://doctrina.org/How-RSA-Works-With-Examples.html</a>.</p>
<p>â€‹ç”±äºRSAåŠ å¯†æ˜¯ç¡®å®šæ€§çš„ï¼ˆæ²¡æœ‰éšæœºæˆåˆ†ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä½¿ç”¨å…¬é’¥åŠ å¯†å¯èƒ½çš„æ˜æ–‡å¹¶æµ‹è¯•å®ƒä»¬æ˜¯å¦ç­‰äºå¯†æ–‡ï¼Œä»è€ŒæˆåŠŸå‘èµ·é’ˆå¯¹æ‰€é€‰æ˜æ–‡çš„æ”»å‡»ï¼ˆ<strong><a href="https://en.wikipedia.org/wiki/Chosen-plaintext_attack" target="_blank" rel="noopener">chosen plaintext attack</a></strong>ï¼‰ã€‚è¿™å¯èƒ½ä¸æ˜¯é—®é¢˜ï¼Œä½†æ˜¯ä¸€ä¸ªå¼±ç‚¹ï¼Œåœ¨å¼€å‘äººå‘˜é€‰æ‹©åŠ å¯†æ–¹æ¡ˆæ—¶åº”äºˆä»¥è€ƒè™‘ã€‚åƒ<strong>RSA-KEM</strong>è¿™æ ·çš„æ··åˆåŠ å¯†æ–¹æ¡ˆå¯ä»¥è§£å†³æ­¤æ¼æ´ï¼Œå¹¶å…è®¸å¯¹è¾ƒé•¿çš„æ–‡æœ¬è¿›è¡ŒåŠ å¯†ã€‚</p>
<h2 id="105-rsaåŠ å¯†è§£å¯†-ä»£ç ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#105-rsaåŠ å¯†è§£å¯†-ä»£ç ç¤ºä¾‹"></a> 10.5  RSAåŠ å¯†/è§£å¯†-ä»£ç ç¤ºä¾‹</h2>
<p>â€‹ä»¥ä¸‹ä»£ç å°†ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding" target="_blank" rel="noopener"><strong>RSA-OAEP</strong></a>å¡«å……æ–¹æ¡ˆç”Ÿæˆéšæœºçš„RSAå¯†é’¥å¯¹ï¼Œå°†åŠ å¯†çŸ­æ¶ˆæ¯å¹¶å°†å…¶è§£å¯†å›å…¶åŸå§‹å½¢å¼ã€‚</p>
<p>â€‹é¦–å…ˆï¼Œå®‰è£…pycryptodomeè½¯ä»¶åŒ…ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„Pythonåº“ï¼ŒåŒ…å«ä½çº§å¯†ç åŸºå…ƒï¼ˆå“ˆå¸Œï¼ŒMACï¼Œå¯†é’¥æ´¾ç”Ÿï¼Œå¯¹ç§°å’Œéå¯¹ç§°å¯†ç ï¼Œæ•°å­—ç­¾åï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pycryptodome</span><br></pre></td></tr></table></figure>
<h3 id="1051-rsa-å¯†é’¥ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#1051-rsa-å¯†é’¥ç”Ÿæˆ"></a> 10.5.1 RSA å¯†é’¥ç”Ÿæˆ</h3>
<p>ç”ŸæˆRSAå¯†é’¥ï¼ˆ1024ä½ï¼‰å¹¶å°†å…¶æ‰“å°åœ¨æ§åˆ¶å°ä¸Šï¼ˆä»¥åå…­è¿›åˆ¶æ•°å­—å’ŒPKCS#8 PEM ASN.1æ ¼å¼æ˜¾ç¤ºï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">keyPair = RSA.generate(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">pubKey = keyPair.publickey()</span><br><span class="line">print(<span class="string">f"Public key:  (n=<span class="subst">&#123;hex(pubKey.n)&#125;</span>, e=<span class="subst">&#123;hex(pubKey.e)&#125;</span>)"</span>)</span><br><span class="line">pubKeyPEM = pubKey.exportKey()</span><br><span class="line">print(pubKeyPEM.decode(<span class="string">'ascii'</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">f"Private key: (n=<span class="subst">&#123;hex(pubKey.n)&#125;</span>, d=<span class="subst">&#123;hex(keyPair.d)&#125;</span>)"</span>)</span><br><span class="line">privKeyPEM = keyPair.exportKey()</span><br><span class="line">print(privKeyPEM.decode(<span class="string">'ascii'</span>))</span><br></pre></td></tr></table></figure>
<h3 id="1052-rsa-åŠ å¯†"><a class="markdownIt-Anchor" href="#1052-rsa-åŠ å¯†"></a> 10.5.2 RSA åŠ å¯†</h3>
<p>ä½¿ç”¨å¸¦æœ‰RSAå…¬é’¥çš„RSA-OAEPåŠ å¯†æ–¹æ¡ˆï¼ˆå¸¦æœ‰PKCSï¼ƒ1 OAEPå¡«å……çš„RSAï¼‰å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">msg = <span class="string">b'A message for encryption'</span></span><br><span class="line">encryptor = PKCS1_OAEP.new(pubKey)</span><br><span class="line">encrypted = encryptor.encrypt(msg)</span><br><span class="line">print(<span class="string">"Encrypted:"</span>, binascii.hexlify(encrypted))</span><br></pre></td></tr></table></figure>
<h3 id="1053-rsaè§£å¯†"><a class="markdownIt-Anchor" href="#1053-rsaè§£å¯†"></a> 10.5.3 RSAè§£å¯†</h3>
<p>ä½¿ç”¨å¸¦æœ‰RSAç§é’¥çš„RSA-OAEPè§£å¯†æ¶ˆæ¯:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">decryptor = PKCS1_OAEP.new(keyPair)</span><br><span class="line">decrypted = decryptor.decrypt(encrypted)</span><br><span class="line">print(<span class="string">'Decrypted:'</span>, decrypted)</span><br></pre></td></tr></table></figure>
<h3 id="1054-è¾“å‡º"><a class="markdownIt-Anchor" href="#1054-è¾“å‡º"></a> 10.5.4 è¾“å‡º</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Public key: (n&#x3D;0x9a11485bccb9569410a848fb1afdf2a81b17c1fa9f9eb546fd1deb873b49b693a4edf20eb8362c085cd5b28ba109dbad2bd257a013f57f745402e245b0cc2d553c7b2b8dbba57ebda7f84cfb32b7d9c254f03dbd0188e4b8e40c47b64c1bd2572834b936ffc3da9953657ef8bee80c49c2c12933c8a34804a00eb4c81248e01f, e&#x3D;0x10001)</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCaEUhbzLlWlBCoSPsa&#x2F;fKoGxfB</span><br><span class="line">+p+etUb9HeuHO0m2k6Tt8g64NiwIXNWyi6EJ260r0legE&#x2F;V&#x2F;dFQC4kWwzC1VPHsr</span><br><span class="line">jbulfr2n+Ez7MrfZwlTwPb0BiOS45AxHtkwb0lcoNLk2&#x2F;8PamVNlfvi+6AxJwsEp</span><br><span class="line">M8ijSASgDrTIEkjgHwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">Private key: (n&#x3D;0x9a11485bccb9569410a848fb1afdf2a81b17c1fa9f9eb546fd1deb873b49b693a4edf20eb8362c085cd5b28ba109dbad2bd257a013f57f745402e245b0cc2d553c7b2b8dbba57ebda7f84cfb32b7d9c254f03dbd0188e4b8e40c47b64c1bd2572834b936ffc3da9953657ef8bee80c49c2c12933c8a34804a00eb4c81248e01f, d&#x3D;0x318ab12be3cf0d4a1b7921cead454fcc42ba070462639483394d6fb9529547827e9c8d23b294a8e01f8a1019da34e350f2307740e06a270bef1fe646e6ad213e31b528fdd5f5d03e633c07c44755ed622a629d79e822c095ebdf9cc80e517b5566dd3d3e5b16ec737987337a0e497fdba4b5ad97af41c1c3cdd87542a4637d81)</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXAIBAAKBgQCaEUhbzLlWlBCoSPsa&#x2F;fKoGxfB+p+etUb9HeuHO0m2k6Tt8g64</span><br><span class="line">NiwIXNWyi6EJ260r0legE&#x2F;V&#x2F;dFQC4kWwzC1VPHsrjbulfr2n+Ez7MrfZwlTwPb0B</span><br><span class="line">iOS45AxHtkwb0lcoNLk2&#x2F;8PamVNlfvi+6AxJwsEpM8ijSASgDrTIEkjgHwIDAQAB</span><br><span class="line">AoGAMYqxK+PPDUobeSHOrUVPzEK6BwRiY5SDOU1vuVKVR4J+nI0jspSo4B+KEBna</span><br><span class="line">NONQ8jB3QOBqJwvvH+ZG5q0hPjG1KP3V9dA+YzwHxEdV7WIqYp156CLAlevfnMgO</span><br><span class="line">UXtVZt09PlsW7HN5hzN6Dkl&#x2F;26S1rZevQcHDzdh1QqRjfYECQQDGDUIQXlOiAcGo</span><br><span class="line">d5YqAGpWe0wzJ0UypeqZcqS9MVe9OkjjopCkkYntifdN&#x2F;1oG7S&#x2F;1KUMtLoGHqntb</span><br><span class="line">c428zOO&#x2F;AkEAxyV0cmuJbFdfM0x2XhZ+ge&#x2F;7putIx76RHDOjBpM6VQXpLEFj54kB</span><br><span class="line">qGLAB7SXr7P4AFrEjfckJOp2YMI5BreboQJAb3EUZHt&#x2F;WeDdJLutzpKPQ3x7oykM</span><br><span class="line">wfQkbxXYZvD16u96BkT6WO&#x2F;gCb6hXs05zj32x1&#x2F;hgfHyRvGCGjKKZdtwpwJBAJ74</span><br><span class="line">y0g7h+wwoxJ0S1k4Y6yeQikxUVwCSBxXLCCnjr0ohsaJPJMrz2L30YtVInFkHOlL</span><br><span class="line">i&#x2F;Q4AWZmtDDxWkx+bYECQG8e6bGoszuX5xjvhEBslIws9+nMzMuYBR8HvhLo58B5</span><br><span class="line">N8dk3nIsLs3UncKLiiWubMAciU5jUxZoqWpRXXwECKE&#x3D;</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">Encrypted: b&#39;99b331c4e1c8f3fa227aacd57c85f38b7b7461574701b427758ee4f94b1e07d791ab70b55d672ff55dbe133ac0bea16fc23ea84636365f605a9b645e0861ee11d68a7550be8eb35e85a4bde6d73b0b956d000866425511c7920cdc8a3786a4f1cb1986a875373975e158d74e11ad751594de593a35de765fe329c0d3dfbbfedc&#39;</span><br><span class="line">Decrypted: b&#39;A message for encryption&#39;</span><br></pre></td></tr></table></figure>
<p><code>æ³¨</code>ï¼š</p>
<ol>
<li>å¦‚æœè¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ï¼Œæ‚¨çš„è¾“å‡ºå°†æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºå®ƒåœ¨æ¯æ¬¡æ‰§è¡Œæ—¶éƒ½ä¼šç”Ÿæˆä¸åŒçš„éšæœºRSAå¯†é’¥å¯¹ã€‚</li>
<li>å³ä½¿æ‚¨ä½¿ç”¨ç›¸åŒçš„å…¬å…±å¯†é’¥å¤šæ¬¡åŠ å¯†åŒä¸€æ¡æ¶ˆæ¯ï¼Œæ‚¨ä¹Ÿä¼šè·å¾—ä¸åŒçš„è¾“å‡ºã€‚ è¿™æ˜¯å› ä¸ºOAEPå¡«å……ç®—æ³•ä¼šç»™å¡«å……æ³¨å…¥ä¸€äº›éšæœºæ€§ã€‚</li>
<li>å¦‚æœå°è¯•åŠ å¯†è¾ƒå¤§çš„æ¶ˆæ¯ï¼Œåˆ™å¯èƒ½äº§ç”Ÿå¼‚å¸¸ï¼Œå› ä¸º1024ä½å¯†é’¥é™åˆ¶äº†æœ€å¤§æ¶ˆæ¯é•¿åº¦ã€‚</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/09.%20Asymmetric%20Key%20Ciphers%20and%20Public-Key%20Cryptography%20-%20Overview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/09.%20Asymmetric%20Key%20Ciphers%20and%20Public-Key%20Cryptography%20-%20Overview/" class="post-title-link" itemprop="url">09. Asymmetric Key Ciphers and Public-Key Cryptography - Overview</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:20" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:20+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹éå¯¹ç§°å¯†é’¥å¯†ç ç³»ç»Ÿ/å…¬å…±å¯†é’¥å¯†ç ç³»ç»Ÿï¼ˆ <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener"><strong>RSA</strong></a>, <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" target="_blank" rel="noopener"><strong>elliptic curve cryptography (ECC)</strong></a>, <a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange" target="_blank" rel="noopener"><strong>Diffie-Hellman</strong></a>, <a href="https://en.wikipedia.org/wiki/ElGamal_encryption" target="_blank" rel="noopener"><strong>ElGamal</strong></a>, <a href="https://en.wikipedia.org/wiki/McEliece_cryptosystem" target="_blank" rel="noopener"><strong>McEliece</strong></a>, <a href="https://en.wikipedia.org/wiki/NTRU" target="_blank" rel="noopener"><strong>NTRU</strong></a> ç­‰ï¼‰ä½¿ç”¨ä¸€å¯¹æ•°å­¦ä¸Šå…³è”çš„å¯†é’¥ï¼šå…¬é’¥ï¼ˆåŠ å¯†å¯†é’¥ï¼‰å’Œç§é’¥ï¼ˆè§£å¯†ï¼‰ ã€‚</p>
<p>â€‹éå¯¹ç§°å¯†é’¥ç³»ç»Ÿæä¾›<strong>å¯†é’¥å¯¹ç”Ÿæˆ</strong>ï¼ˆç§é’¥å’Œå…¬é’¥ï¼‰ï¼Œ<strong>åŠ å¯†ç®—æ³•</strong>ï¼ˆéå¯¹ç§°å¯†é’¥å’ŒåŠ å¯†æ–¹æ¡ˆï¼Œä¾‹å¦‚<code>RSA-OAEP</code>å’Œ<code>ECIES</code>ï¼‰ï¼Œ<strong>æ•°å­—ç­¾åç®—æ³•</strong>ï¼ˆä¾‹å¦‚<code>DSA</code>ï¼Œ<code>ECDSA</code>å’Œ<code>EdDSA</code>ï¼‰å’Œ<strong>å¯†é’¥äº¤æ¢ç®—æ³•</strong>ï¼ˆä¾‹å¦‚ <code>DHKE</code>å’Œ<code>ECDH</code>ï¼‰ã€‚</p>
<p>â€‹ç”±å…¬é’¥åŠ å¯†çš„æ¶ˆæ¯éšåå°†ç”±ç§é’¥è§£å¯†ã€‚ ç”±ç§é’¥ç­¾åçš„æ¶ˆæ¯éšåå°†ç”±å…¬é’¥éªŒè¯ã€‚ å…¬é’¥é€šå¸¸ä¸æ‰€æœ‰äººå…±äº«ï¼Œè€Œç§é’¥åˆ™ä¿å¯†ã€‚ é€šè¿‡è®¾è®¡ï¼Œä»å…¶å¯¹åº”çš„å…¬é’¥è®¡ç®—ç§é’¥æ˜¯ä¸å¯è¡Œçš„ã€‚</p>
<h2 id="91-å…¬é’¥å¯†ç ç³»ç»Ÿ-public-key-cryptosystems"><a class="markdownIt-Anchor" href="#91-å…¬é’¥å¯†ç ç³»ç»Ÿ-public-key-cryptosystems"></a> 9.1 å…¬é’¥å¯†ç ç³»ç»Ÿ Public-Key Cryptosystems</h2>
<p>â€‹ä¼—æ‰€å‘¨çŸ¥çš„å…¬é’¥å¯†ç ç³»ç»Ÿæ˜¯ï¼š <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener"><strong>RSA</strong></a>, <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" target="_blank" rel="noopener"><strong>ECC</strong></a>, <a href="https://en.wikipedia.org/wiki/ElGamal_encryption" target="_blank" rel="noopener"><strong>ElGamal</strong></a>, <a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange" target="_blank" rel="noopener"><strong>DHKE</strong></a>, <a href="https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman" target="_blank" rel="noopener"><strong>ECDH</strong></a>, <a href="https://en.wikipedia.org/wiki/Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>DSA</strong></a>, <a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank" rel="noopener"><strong>ECDSA</strong></a>, <a href="https://en.wikipedia.org/wiki/EdDSA" target="_blank" rel="noopener"><strong>EdDSA</strong></a>, <a href="https://en.wikipedia.org/wiki/Schnorr_signature" target="_blank" rel="noopener"><strong>Schnorr signatures</strong></a>ã€‚<br />
â€‹<br />
â€‹<strong>ä¸åŒçš„å…¬å…±å¯†é’¥å¯†ç ç³»ç»Ÿå¯ä»¥æä¾›ä»¥ä¸‹ä¸€é¡¹æˆ–å¤šé¡¹åŠŸèƒ½ï¼š</strong></p>
<ul>
<li><strong>Key-pair generation</strong>ï¼š ç”Ÿæˆä¸€å¯¹éšæœºçš„ç§é’¥+å…¬é’¥ï¼›</li>
<li><strong>Encryption</strong> / <strong>decryption</strong>ï¼šé€šè¿‡å…¬é’¥åŠ å¯†æ•°æ®ï¼Œå¹¶é€šè¿‡ç§é’¥è§£å¯†æ•°æ®ï¼ˆé€šå¸¸ä½¿ç”¨æ··åˆåŠ å¯†æ–¹æ¡ˆï¼‰ï¼›</li>
<li><strong>Digital signatures</strong> (message authentication)ï¼šé€šè¿‡ç§é’¥å¯¹æ¶ˆæ¯ç­¾åï¼Œå¹¶é€šè¿‡å…¬é’¥éªŒè¯ç­¾åï¼›</li>
<li><strong>Key-exchange algorithms</strong>ï¼šé€šè¿‡ä¸å®‰å…¨çš„é€šé“åœ¨ä¸¤æ–¹ä¹‹é—´å®‰å…¨åœ°äº¤æ¢åŠ å¯†å¯†é’¥ã€‚</li>
</ul>
<p>â€‹æœ€é‡è¦å’Œæœ€å¸¸ç”¨çš„å…¬é’¥å¯†ç ç³»ç»Ÿæ˜¯<strong>RSA</strong>å’Œ<strong>ECC</strong>ã€‚ æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼ˆECCï¼‰æ˜¯æ¨èçš„ä¹Ÿæ˜¯æœ€å¯å–çš„ç°ä»£å…¬é’¥å¯†ç ç³»ç»Ÿï¼Œå°¤å…¶æ˜¯é«˜åº¦ä¼˜åŒ–å’Œå®‰å…¨çš„æ›²çº¿ï¼ˆä¾‹å¦‚Curve25519å’ŒCurve448ï¼‰ï¼Œå› ä¸ºå®ƒå…·æœ‰è¾ƒå°çš„å¯†é’¥ï¼Œè¾ƒçŸ­çš„ç­¾åå’Œæ›´å¥½çš„æ€§èƒ½ã€‚</p>
<p>â€‹<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener"><strong>RSA public-key cryptosystem</strong></a> åŸºäº<a href="https://en.wikipedia.org/wiki/Modular_exponentiation" target="_blank" rel="noopener"><strong>modular exponentiation</strong></a>ï¼ˆæ¨¡å¹‚è¿ç®—ï¼‰ã€<a href="https://en.wikipedia.org/wiki/RSA_problem" target="_blank" rel="noopener"><strong>integer factorization problem</strong></a> ï¼ˆæ•´æ•°åˆ†è§£é—®é¢˜ï¼‰çš„æ•°å­¦æ¦‚å¿µã€‚</p>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" target="_blank" rel="noopener"><strong>elliptic-curve cryptography (ECC) cryptosystem</strong></a>åŸºäºæœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿çš„ä»£æ•°ç»“æ„çš„æ•°å­¦ç†è®ºå’Œæ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆ<a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Rationale" target="_blank" rel="noopener"><strong>elliptic curve discrete logarithm problem,  ECDLP</strong></a>ã€‚</p>
<h2 id="92-éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#92-éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆ"></a> 9.2 éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆ</h2>
<p>â€‹éå¯¹ç§°åŠ å¯†æ¯”å¯¹ç§°åŠ å¯†æ›´å¤æ‚ï¼Œä¸ä»…å› ä¸ºå®ƒä½¿ç”¨å…¬é’¥å’Œç§é’¥ï¼Œè€Œä¸”å› ä¸ºéå¯¹ç§°åŠ å¯†åªèƒ½åŠ å¯†/è§£å¯†è¾ƒå°çš„æ¶ˆæ¯ã€‚åœ¨<code>RSA</code>ç³»ç»Ÿä¸­ï¼Œåº”å°†è¾“å…¥æ¶ˆæ¯è½¬æ¢ä¸ºå¤§æ•´æ•°ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨OAEPå¡«å……ï¼‰ï¼Œè€Œåœ¨ECCä¸­ï¼ŒåŸºäºæ¤­åœ†æ›²çº¿Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼Œä¸èƒ½ç›´æ¥å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œè€Œåº”ä½¿ç”¨æ›´å¤æ‚çš„åŠ å¯†æ–¹æ¡ˆï¼ˆECDHï¼‰ã€‚ç¨åå°†å¯¹æ­¤è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚ æ­¤å¤–ï¼Œéå¯¹ç§°å¯†ç æ¯”å¯¹ç§°å¯†ç è¦æ…¢å¾—å¤šï¼ˆä¾‹å¦‚RSAåŠ å¯†è¦æ¯”AESæ…¢1000å€ï¼‰ã€‚</p>
<p>â€‹ä¸ºäº†å…‹æœä¸Šè¿°é™åˆ¶å¹¶å…è®¸å¯¹ä»»æ„å¤§å°çš„æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œç°ä»£åŠ å¯†æŠ€æœ¯ä½¿ç”¨äº†éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼ˆä¹Ÿç§°ä¸ºå…¬é’¥åŠ å¯†æ–¹æ¡ˆ/éå¯¹ç§°åŠ å¯†ç»“æ„/æ··åˆåŠ å¯†æ–¹æ¡ˆï¼‰ï¼Œä¾‹å¦‚å¯†é’¥å°è£…æœºåˆ¶ï¼ˆ<strong>key encapsulation mechanisms</strong>ï¼ŒKEMï¼‰å’Œé›†æˆåŠ å¯†æ–¹æ¡ˆï¼Œ ç»“åˆäº†éå¯¹ç§°åŠ å¯†å’Œå¯¹ç§°å¯†é’¥å¯†ç ã€‚</p>
<p>â€‹è¿™æ˜¯é€šè¿‡ç»„åˆå…¬é’¥åŠ å¯†å’Œå¯¹ç§°åŠ å¯†ç®—æ³•æ¥åŠ å¯†å¤§å‹æ–‡æ¡£æˆ–æ–‡ä»¶çš„æ–¹å¼ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/pkc.png" alt="pk -c" /></p>
<p>â€‹åœ¨ä¸Šå›¾ä¸­ï¼ŒåŠ å¯†çš„å¯¹ç§°å¯†é’¥ç§°ä¸ºKEMå—ï¼ˆå…¬é’¥åŠ å¯†çš„å¯†é’¥ï¼‰ï¼ŒåŠ å¯†çš„æ•°æ®æ–‡ä»¶ç§°ä¸ºDEMå—ï¼ˆå¯¹ç§°åŠ å¯†çš„æ•°æ®ï¼‰ã€‚ åŠ å¯†çš„æ¶ˆæ¯ç”±è¿™ä¸¤ä¸ªå—ç»„æˆï¼ˆå°è£…çš„å¯†é’¥+å°è£…çš„æ•°æ®ï¼‰ã€‚</p>
<p>â€‹è¿™æ˜¯ç›¸åº”çš„è§£å¯†è¿‡ç¨‹ï¼ˆä½¿ç”¨å…¬é’¥å’Œå¯¹ç§°åŠ å¯†ç®—æ³•è§£å¯†åŠ å¯†çš„å¤§æ–‡æ¡£ï¼‰ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/pkdc.png" alt="pkd -c" /></p>
<p>é‡‡ç”¨è¿™ç§éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆçš„æœ‰ï¼š <a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding" target="_blank" rel="noopener"><strong>RSA-OAEP</strong></a>, <a href="https://tools.ietf.org/html/rfc5990#appendix-A" target="_blank" rel="noopener"><strong>RSA-KEM</strong></a> and <a href="https://www.w3.org/TR/xmlsec-generic-hybrid/#sec-ecies-kem" target="_blank" rel="noopener"><strong>ECIES-KEM</strong></a>ã€‚</p>
<h2 id="93-ç»¼åˆåŠ å¯†æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#93-ç»¼åˆåŠ å¯†æ–¹æ¡ˆ"></a> 9.3 ç»¼åˆåŠ å¯†æ–¹æ¡ˆ</h2>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme" target="_blank" rel="noopener"><strong>Integrated encryption schemes (IES)</strong></a> æ˜¯ç°ä»£çš„å…¬å…±å¯†é’¥åŠ å¯†æ–¹æ¡ˆï¼Œå®ƒç»“åˆäº†å¯¹ç§°åŠ å¯†ï¼Œéå¯¹ç§°åŠ å¯†å’Œå¯†é’¥ç”Ÿæˆç®—æ³•ï¼Œä»¥æä¾›å®‰å…¨çš„åŸºäºå…¬å…±å¯†é’¥çš„åŠ å¯†ï¼ˆPKEï¼‰ã€‚åœ¨IESæ–¹æ¡ˆä¸­ï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆä¾‹å¦‚RSAæˆ–ECCï¼‰ç”¨äºåŠ å¯†æˆ–å°è£…å¯¹ç§°å¯†é’¥ï¼Œç¨åç”±å¯¹ç§°åŠ å¯†ï¼ˆä¾‹å¦‚AESæˆ–ChaCha20ï¼‰ä½¿ç”¨è¯¥å¯¹ç§°å¯†é’¥æ¥åŠ å¯†è¾“å…¥æ¶ˆæ¯ã€‚ ä¸€äº›EISæ–¹æ¡ˆè¿˜æä¾›æ¶ˆæ¯èº«ä»½éªŒè¯ã€‚ ä½¿ç”¨EISæ–¹æ¡ˆçš„æœ‰ <a href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme" target="_blank" rel="noopener"><strong>DLIES</strong></a> (Discrete Logarithm Integrated Encryption Scheme) and <a href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme" target="_blank" rel="noopener"><strong>ECIES</strong></a> (Elliptic Curve Integrated Encryption Scheme)</p>
<h2 id="94-ç§˜é’¥å°è£…æœºåˆ¶-key-encapsulation-mechanisms-kems"><a class="markdownIt-Anchor" href="#94-ç§˜é’¥å°è£…æœºåˆ¶-key-encapsulation-mechanisms-kems"></a> 9.4 ç§˜é’¥å°è£…æœºåˆ¶ï¼ˆ Key Encapsulation Mechanisms, KEMsï¼‰</h2>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Key_encapsulation" target="_blank" rel="noopener"><strong>key encapsulation mechanisms (KEM)</strong></a> æ˜¯ç”¨äºåŠ å¯†å’Œå°è£…å¯†é’¥ï¼ˆç§°ä¸ºâ€œä¸´æ—¶å¯¹ç§°å¯†é’¥â€ï¼‰çš„éå¯¹ç§°åŠ å¯†æŠ€æœ¯ï¼Œè¯¥å¯†é’¥ç”¨äºä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•å¯¹è¾“å…¥æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ã€‚KEMé€šè¿‡ä½¿ç”¨æ”¶ä»¶äººçš„å…¬é’¥å¯¹ä¸´æ—¶å¯¹ç§°åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½œä¸ºåŠ å¯†æ¶ˆæ¯çš„ä¸€éƒ¨åˆ†ã€‚ åœ¨å¯†ç å­¦ä¸­ï¼Œæ­¤è¿‡ç¨‹ç§°ä¸º<strong>å¯†é’¥å°è£…</strong>ã€‚</p>
<p>â€‹åŸºäºKEMçš„æ··åˆåŠ å¯†æ–¹æ¡ˆçš„è¾“å‡ºç”±<strong>KEM</strong>å—ï¼ˆä¿å­˜å°è£…çš„åŠ å¯†å¯¹ç§°å¯†é’¥ï¼Œæˆ–ç”¨äºå¯¼å‡ºå®ƒçš„æŸäº›å‚æ•°ï¼‰å’ŒDEMå—ç»„æˆï¼ŒDEMå—ä¿å­˜å°è£…çš„å¯¹ç§°åŠ å¯†æ•°æ®ï¼ˆåŠ å¯†å‚æ•° + å¯†æ–‡ + å¯é€‰çš„èº«ä»½éªŒè¯ç ï¼‰ã€‚</p>
<p>â€‹å¯†é’¥å°è£…æœºåˆ¶ï¼ˆKEMï¼‰åœ¨æ··åˆåŠ å¯†æ–¹æ¡ˆå’Œé›†æˆåŠ å¯†æ–¹æ¡ˆä¸­ä½¿ç”¨ã€‚å…¶ä¸­åœ¨å…¬é’¥åŠ å¯†ç³»ç»Ÿä¸­ç”Ÿæˆéšæœºå…ƒç´ ï¼Œå¹¶é€šè¿‡Hashä»è¯¥éšæœºå…ƒç´ ä¸­è·å¾—å¯¹ç§°å¯†é’¥ã€‚è¿™ç§æ–¹æ³•ç®€åŒ–äº†å°†éå¯¹ç§°å’Œå¯¹ç§°åŠ å¯†ç›¸ç»“åˆçš„è¿‡ç¨‹ã€‚ä½¿ç”¨ç°ä»£å¯†é’¥å°è£…æœºåˆ¶çš„æ–¹æ¡ˆæœ‰ï¼š <a href="https://tools.ietf.org/html/rfc5990" target="_blank" rel="noopener"><strong>RSA-KEM</strong></a>, <a href="https://www.cosic.esat.kuleuven.be/nessie/reports/phase2/evalv2.pdf" target="_blank" rel="noopener"><strong>ECIES-KEM</strong></a> and <a href="https://www.cryptrec.go.jp/cryptrec_03_spec_cypherlist_files/PDF/02_03e_jspec.pdf" target="_blank" rel="noopener"><strong>PSEC-KEM</strong></a></p>
<p>â€‹å¯†é’¥å°è£…ï¼ˆ<strong>Key encapsulation</strong> ï¼‰ä¸åº”ä¸å¯†é’¥åŒ…è£…ï¼ˆ<strong>key wrapping</strong>ï¼‰æ··æ·†ï¼š</p>
<ul>
<li><strong>Key encapsulation</strong> (KEM) ï¼šæŒ‡å¦ä¸€ä¸ªå¯†é’¥ï¼ˆå¯¹ç§°æˆ–éå¯¹ç§°ï¼‰ä½¿ç”¨å…¬é’¥åŠ å¯†ã€‚ å®ƒç”¨äºåˆ›å»ºå¯è¯æ˜å®‰å…¨çš„æ··åˆåŠ å¯†æ–¹æ¡ˆï¼Œä¾‹å¦‚ï¼š é€šè¿‡ç»™å®šçš„ECCå…¬é’¥æ¥åŠ å¯†AESå¯†é’¥ã€‚</li>
<li><strong>Key wrapping</strong>ï¼šæŒ‡å¦ä¸€å¯†é’¥ï¼ˆå¯ä»¥æ˜¯å¯¹ç§°å¯†é’¥æˆ–éå¯¹ç§°å¯†é’¥ï¼‰çš„å¯¹ç§°å¯†é’¥åŠ å¯†ã€‚å®ƒç”¨äºåŠ å¯†ï¼Œå®Œæ•´æ€§ä¿æŠ¤å’Œä¼ è¾“å¯†é’¥ã€‚å¯†é’¥åŒ…è£…å¯ä¸ºä¸“ç”¨æ•°æ®ï¼ˆå¦‚åŠ å¯†å¯†é’¥ï¼‰æä¾›éšç§å’Œå®Œæ•´æ€§ä¿æŠ¤ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://tools.ietf.org/html/rfc3394.html" target="_blank" rel="noopener">RFC 3394</a>ã€‚</li>
</ul>
<h2 id="95-æ•°å­—ç­¾å"><a class="markdownIt-Anchor" href="#95-æ•°å­—ç­¾å"></a> 9.5 æ•°å­—ç­¾å</h2>
<p>â€‹åœ¨å¯†ç å­¦ä¸­ï¼Œæ•°å­—ç­¾åä¸ºæ•°å­—æ–‡æ¡£æä¾›<strong>æ¶ˆæ¯èº«ä»½éªŒè¯</strong>ï¼Œ<strong>å®Œæ•´æ€§</strong>å’Œ<strong>ä¸å¯å¦è®¤æ€§</strong>ã€‚ä½¿ç”¨ç§é’¥è¿›è¡Œæ¶ˆæ¯ç­¾åï¼Œç›¸åº”çš„å…¬é’¥æ‰§è¡Œæ¶ˆæ¯éªŒè¯ã€‚æ¶ˆæ¯ç­¾ååœ¨æ•°å­¦ä¸Šä¿è¯äº†æŸäº›æ¶ˆæ¯æ˜¯ç”±æŸäº›ï¼ˆä¿å¯†çš„ï¼‰ç§é’¥ç­¾åçš„ï¼Œè¯¥ç§é’¥å¯¹åº”äºç‰¹å®šçš„ï¼ˆéç§˜å¯†ï¼‰å…¬é’¥ã€‚ æ¶ˆæ¯ç­¾ååï¼Œæ— æ³•ä¿®æ”¹æ¶ˆæ¯å’Œç­¾åï¼Œå› æ­¤å¯ä»¥æä¾›è¿™æ¡è¢«ç­¾åæ¶ˆæ¯çš„èº«ä»½éªŒè¯å’Œå®Œæ•´æ€§ã€‚çŸ¥é“æ¶ˆæ¯ç­¾åè€…å…¬é’¥çš„ä»»ä½•äººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚ ç­¾ååï¼Œç­¾åä½œè€…æ— æ³•å¦è®¤ç­¾åè¡Œä¸ºã€‚</p>
<p>â€‹å¦‚ä»Šï¼Œæ•°å­—ç­¾åå·²å¹¿æ³›ç”¨äºç­¾ç½²æ•°å­—åˆåŒï¼Œæˆæƒé“¶è¡Œä»˜æ¬¾ä»¥åŠåœ¨å…¬å…±åŒºå—é“¾ç³»ç»Ÿä¸­ç­¾ç½²äº¤æ˜“ä»¥è½¬ç§»æ•°å­—èµ„äº§ã€‚</p>
<h2 id="96-å¯†é’¥äº¤æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#96-å¯†é’¥äº¤æ¢ç®—æ³•"></a> 9.6 å¯†é’¥äº¤æ¢ç®—æ³•</h2>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Key_exchange" target="_blank" rel="noopener"><strong>key exchange algorithms</strong></a> (<a href="https://en.wikipedia.org/wiki/Key-agreement_protocol" target="_blank" rel="noopener"><strong>key agreement protocols</strong></a> / <strong>key negotiation schemes</strong>)å…è®¸åœ¨ä¸¤æ–¹ä¹‹é—´äº¤æ¢åŠ å¯†å¯†é’¥ï¼Œä»è€Œå…è®¸ä½¿ç”¨åŠ å¯†ç®—æ³•ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹äº¤æ¢çš„æ˜¯å¯¹ç§°åŠ å¯†ç§˜é’¥ã€‚ä¾‹å¦‚ï¼Œå½“ç¬”è®°æœ¬ç”µè„‘è¿æ¥åˆ°å®¶ç”¨WiFiè·¯ç”±å™¨æ—¶ï¼ŒåŒæ–¹éƒ½åŒæ„ä½¿ç”¨ä¼šè¯å¯†é’¥ï¼Œè¯¥ä¼šè¯å¯†é’¥ç”¨äºå¯¹ç§°åœ°åŠ å¯†å®ƒä»¬ä¹‹é—´çš„ç½‘ç»œæµé‡ã€‚</p>
<p>â€‹å¤§å¤šæ•°å¯†é’¥äº¤æ¢ç®—æ³•éƒ½åŸºäºå…¬å…±å¯†é’¥å¯†ç å­¦å’Œè¯¥ç³»ç»ŸèƒŒåçš„æ•°å­¦ï¼šç¦»æ•£å¯¹æ•°ï¼Œæ¤­åœ†æ›²çº¿æˆ–å…¶ä»–ç†è®ºã€‚<br />
â€‹<br />
â€‹åƒDiffie-Hellmanï¼ˆDHKEå’ŒECDHï¼‰è¿™æ ·çš„åŒ¿åå¯†é’¥äº¤æ¢ä¸æä¾›å„æ–¹çš„èº«ä»½éªŒè¯ï¼Œå› æ­¤å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼ˆ <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" target="_blank" rel="noopener">man-in-the-middle attacks</a>ï¼‰ï¼Œä½†å¯ä»¥é˜²æ­¢æµé‡æ‹¦æˆªï¼ˆå—…æ¢ï¼‰æ”»å‡»ï¼ˆ<a href="https://en.wikipedia.org/wiki/Sniffing_attack" target="_blank" rel="noopener">traffic interception (sniffing) attacks</a>ï¼‰ã€‚</p>
<p>â€‹ç»è¿‡èº«ä»½éªŒè¯çš„å¯†é’¥åè®®æ–¹æ¡ˆå¯ä»¥å¯¹å‚ä¸å¯†é’¥äº¤æ¢çš„å„æ–¹çš„èº«ä»½è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä»è€Œé€šè¿‡ä½¿ç”¨æ•°å­—ç­¾å (ä¾‹å¦‚ï¼Œ <a href="https://en.wikipedia.org/wiki/Public_key_certificate" target="_blank" rel="noopener">PKI certificate</a>)ã€<a href="https://en.wikipedia.org/wiki/Password-authenticated_key_agreement" target="_blank" rel="noopener"><strong>password-authenticated key agreemen</strong></a>æˆ–è€…å…¶ä»–æ–¹æ³•æ¥é˜²æ­¢ä¸­é—´äººæ”»å‡»</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/08.%20Popular%20Symmetric%20Encryption%20Algorithms/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/08.%20Popular%20Symmetric%20Encryption%20Algorithms/" class="post-title-link" itemprop="url">08. Popular Symmetric Encryption Algorithms</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:19" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:19+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹å¯¹ç§°å¯†é’¥åŠ å¯†ç®—æ³•ï¼ˆå¦‚AESï¼‰æ˜¯ç”±æ•°å­¦å®¶å’Œå¯†ç å­¦å®¶è®¾è®¡çš„ï¼Œå…¶æ€æƒ³æ˜¯åœ¨æ²¡æœ‰åŠ å¯†å¯†é’¥çš„æƒ…å†µä¸‹è§£å¯†å¯†æ–‡åº”è¯¥æ˜¯ä¸å¯è¡Œçš„ã€‚ä¸€äº›æµè¡Œçš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼š<code>AES</code>ï¼Œ<code>ChaCha20</code>ï¼Œ<code>CAST</code>ï¼Œ<code>Twofish</code>ï¼Œ<code>IDEA</code>ï¼Œ<code>Serpent</code>ï¼Œ<code>RC5</code>ï¼Œ<code>RC6</code>ï¼Œ<code>Camellia</code>å’Œ<code>ARIA</code>ã€‚ æ‰€æœ‰è¿™äº›ç®—æ³•åœ¨æ­£ç¡®é…ç½®å’Œä½¿ç”¨æ—¶éƒ½è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚</p>
<h2 id="81-aes"><a class="markdownIt-Anchor" href="#81-aes"></a> 8.1 AES</h2>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank" rel="noopener"><strong>AES</strong></a>  (<strong>A</strong>dvanced <strong>E</strong>ncryption <strong>S</strong>tandard,åˆè¢«ç§°ä¸º <strong>Rijndael</strong>)æ˜¯ç°ä»£ITè¡Œä¸šä¸­æœ€æµè¡Œå’Œä½¿ç”¨æœ€å¹¿æ³›çš„å¯¹ç§°åŠ å¯†ç®—æ³•ã€‚è¿™æ˜¯å› ä¸ºäº‹å®è¯æ˜ï¼ŒAESæ˜¯é«˜åº¦å®‰å…¨ï¼Œå¿«é€Ÿä¸”æ ‡å‡†åŒ–è‰¯å¥½çš„ï¼Œå¹¶ä¸”å‡ ä¹åœ¨æ‰€æœ‰å¹³å°ä¸Šéƒ½å¾—åˆ°å¾ˆå¥½çš„æ”¯æŒã€‚</p>
<p>â€‹å½“ä»Šï¼Œå¤§å¤šæ•°Internetç½‘ç«™åœ¨å†…éƒ¨ä½¿ç”¨AESæ¥æä¾›httpsï¼š//å†…å®¹ï¼Œè¿™æ˜¯TLSï¼ˆTransport Layer Securityï¼Œå®‰å…¨ä¼ è¾“å±‚åè®®ï¼‰å’ŒSSLï¼ˆSecure Sockets Layerï¼Œå®‰å…¨å¥—æ¥å±‚ï¼‰æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå®‰å…¨ä¸»æœºåœ¨Webä¸Šæ‰¿è½½é€šä¿¡ã€‚</p>
<p>â€‹ç”±äºAESåœ¨Internetå®‰å…¨é€šä¿¡ä¸­çš„å¹¿æ³›ä½¿ç”¨ï¼Œç°ä»£CPUç¡¬ä»¶åœ¨å¾®å¤„ç†å™¨çº§åˆ«å®ç°AESæŒ‡ä»¤ï¼Œä»¥åŠ å¿«AESåŠ å¯†å’Œè§£å¯†çš„é€Ÿåº¦ã€‚</p>
<h3 id="81-aesç®—æ³•å‚æ•°"><a class="markdownIt-Anchor" href="#81-aesç®—æ³•å‚æ•°"></a> 8.1 AESç®—æ³•å‚æ•°</h3>
<p>â€‹AESç®—æ³•å¯ä»¥ä½¿ç”¨ä¸åŒçš„å¯†é’¥é•¿åº¦è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯å—å¤§å°å§‹ç»ˆä¸º128ä½ã€‚ å¯¹äºå¤§å¤šæ•°åº”ç”¨ç¨‹åºï¼Œ128ä½AESåŠ å¯†ï¼ˆAES-128ï¼‰è¶³å¤Ÿäº†ï¼Œä½†æ˜¯å¯¹äºæ›´é«˜çš„åŠ å¯†çº§åˆ«ï¼Œå»ºè®®ä½¿ç”¨AES-256ï¼ˆ256ä½å¯†é’¥é•¿åº¦ï¼‰ã€‚</p>
<p>â€‹åƒä»»ä½•å…¶ä»–åˆ†ç»„åŠ å¯†ä¸€æ ·ï¼ŒAESå¯ä»¥ä½¿ç”¨å‡ ç§æ“ä½œæ¨¡å¼ï¼ˆCBCï¼ŒECBï¼ŒCTRç­‰ï¼‰ä¹‹ä¸€æ¥å…è®¸å¯¹ä»»æ„é•¿åº¦çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ å¯¹äºä¸€èˆ¬æƒ…å†µå’ŒåŠ å¯†åŒºå—é“¾é’±åŒ…ï¼Œæ¨èçš„æ¨¡å¼æ˜¯â€œ CTRâ€ã€‚</p>
<p>â€‹å¤§å¤šæ•°æ“ä½œæ¨¡å¼éƒ½éœ€è¦åˆå§‹å‘é‡ï¼ˆIVï¼‰ã€‚å½“ä½¿ç”¨è®¡æ•°å™¨æ¨¡å¼ï¼ˆCTRï¼‰ï¼Œä¾‹å¦‚AES-128-CTRæˆ–AES-256-CTRæ—¶ï¼Œé¦–å…ˆåº”ç”Ÿæˆéæœºå¯†çš„éšæœºsaltï¼ˆIVï¼‰å¹¶ä¸åŠ å¯†çš„å¯†æ–‡è¾“å‡ºä¿å­˜åœ¨ä¸€èµ·ã€‚ IVçš„å¤§å°å§‹ç»ˆä¸å—çš„å¤§å°ç›¸åŒï¼Œå³128ä½ï¼ˆ16å­—èŠ‚ï¼‰ã€‚</p>
<p>â€‹AESåŠ å¯†ä¸CTRå—æ¨¡å¼å’ŒéšæœºIVç›¸ç»“åˆï¼Œä½¿å¾—æ¯æ¬¡åŠ å¯†ç›¸åŒçš„è¾“å…¥æ•°æ®æ—¶ï¼ŒåŠ å¯†ç®—æ³•éƒ½ä¼šç”Ÿæˆä¸åŒçš„åŠ å¯†å¯†æ–‡ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ²¡æœ‰äººå¯ä»¥æ„é€ å­—å…¸æ¥é€†è½¬åŠ å¯†çš„å¯†æ–‡ã€‚</p>
<h3 id="812-é›†æˆæ¶ˆæ¯éªŒè¯ç mac"><a class="markdownIt-Anchor" href="#812-é›†æˆæ¶ˆæ¯éªŒè¯ç mac"></a> 8.1.2 é›†æˆæ¶ˆæ¯éªŒè¯ç ï¼ˆMACï¼‰</h3>
<p>â€‹AESç®—æ³•å¯ä»¥ä½¿ç”¨MACï¼ˆæ¶ˆæ¯éªŒè¯ç ï¼‰æ¥æ£€æŸ¥å¯†ç çš„æœ‰æ•ˆæ€§ï¼Œä¾‹å¦‚ <code>HMAC(text, key)</code>ã€‚MACä»£ç é€šå¸¸é›†æˆåœ¨ç®—æ³•çš„è¾“å‡ºä¸­( <a href="https://en.wikipedia.org/wiki/Authenticated_encryption#Approaches_to_authenticated_encryption" target="_blank" rel="noopener"><strong>integrated encryption</strong></a>)ã€‚å®ƒæ˜¯æ ¹æ®è¾“å…¥æ¶ˆæ¯ä»¥åŠåŠ å¯†å¯†é’¥è®¡ç®—å¾—å‡ºçš„ã€‚ä»è®¡ç®—å‡ºçš„MACä¸­ï¼Œä¸å¯èƒ½æš´éœ²è¾“å…¥æ¶ˆæ¯æˆ–å¯†é’¥ï¼Œå› æ­¤MACæœ¬èº«ä¸ç”¨ä¿å¯†ã€‚ä¸€äº›åˆ†ç»„åŠ å¯†æ¨¡å¼ï¼ˆä¾‹å¦‚AES-GCMï¼‰å°†æ¶ˆæ¯èº«ä»½éªŒè¯é›†æˆåˆ°æ‰€è·å¾—çš„å¯†æ–‡ä¸­ï¼Œä½œä¸ºå…¶å·¥ä½œçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤æ‚¨æ— éœ€æ˜¾å¼æ·»åŠ MACã€‚<br />
â€‹<br />
â€‹<strong>é€šå¸¸ï¼ŒMACçš„è®¡ç®—å’Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li>åŠ å¯†ä¹‹å‰ï¼ŒMACè®¡ç®—ä¸ºmac = HMAC-SHA256(input_msg, key)ï¼›</li>
<li>è¾“å…¥æ•°æ®è¢«åŠ å¯†ï¼Œå¯†æ–‡ä¸éšæœºç› saltï¼ˆIVï¼‰å’ŒMACä¸€èµ·å­˜å‚¨ã€‚</li>
<li>è§£å¯†åï¼Œå°†å†æ¬¡è®¡ç®—MACï¼Œå¹¶å°†å…¶ä¸ä¸åŠ å¯†æ¶ˆæ¯ä¸€èµ·å­˜å‚¨çš„MACè¿›è¡Œæ¯”è¾ƒã€‚</li>
</ol>
<ul>
<li>å¦‚æœMACç›¸åŒï¼Œåˆ™è§£å¯†æˆåŠŸï¼šæ­£ç¡®çš„å¯†æ–‡+è§£å¯†å¯†é’¥+ç®—æ³•è®¾ç½®ï¼ˆIVï¼Œå—æ¨¡å¼ï¼Œå¡«å……ç®—æ³•ï¼‰ã€‚</li>
<li>å¦‚æœMACä¸åŒï¼Œåˆ™è§£å¯†ä¸æˆåŠŸï¼šé”™è¯¯çš„å¯†é’¥/å¯†ç æˆ–å¯†æ–‡ç ´è§£ï¼Œé”™è¯¯çš„MACæˆ–ä¸åŒçš„ç®—æ³•è®¾ç½®ï¼ˆIVï¼Œå—æ¨¡å¼ï¼Œå¡«å……ç­‰ï¼‰</li>
</ul>
<p>â€‹å¯ä»¥ä½¿ç”¨å¤šç§é›†æˆåŠ å¯†æ–¹æ³•æ¥è®¡ç®—å’ŒéªŒè¯MACï¼ˆ<a href="https://en.wikipedia.org/wiki/Authenticated_encryption#Approaches_to_authenticated_encryption" target="_blank" rel="noopener">approaches to integrated encryption</a>ï¼‰ï¼š <strong>Encrypt-then-MAC</strong>, <strong>Encrypt-and-MAC</strong>, <strong>MAC-then-Encrypt</strong>.</p>
<h2 id="82-aesåŠ å¯†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#82-aesåŠ å¯†è¿‡ç¨‹"></a> 8.2 AESåŠ å¯†è¿‡ç¨‹</h2>
<p>â€‹æ•´ä¸ªAESåŠ å¯†è¿‡ç¨‹ï¼ˆåŸºäºå¯†ç çš„èº«ä»½éªŒè¯åŠ å¯†ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li>
<p>é€‰æ‹©ç®—æ³•å‚æ•°ï¼ˆä¾‹å¦‚AESï¼Œ128ä½ï¼ŒCTRæ¨¡å¼+ Scrypt + Scryptå‚æ•°+ MACç®—æ³•ï¼‰ã€‚ è¿™äº›å‚æ•°å¯ä»¥ç¡¬ç¼–ç åœ¨AESç®—æ³•å®ç°æºä»£ç ä¸­ï¼Œæˆ–è€…å¯ä»¥æŒ‡å®šä¸ºAESåŠ å¯†å’Œè§£å¯†çš„è¾“å…¥ã€‚ å§‹ç»ˆä½¿ç”¨ç›¸åŒçš„å‚æ•°è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚</p>
</li>
<li>
<p>åŠ å¯†å¯†é’¥æ˜¯ä½¿ç”¨å¯†é’¥å¯¼å‡ºå‡½æ•°ï¼ˆKDFï¼‰ä»åŠ å¯†å¯†ç ä¸­å¯¼å‡ºçš„ï¼Œä¾‹å¦‚ Scryptï¼ˆæ ¹æ®ç‰¹å®šå‚æ•°ï¼‰ï¼š<img src="http://q6r9jgptb.bkt.clouddn.com/mweb/P2K.png" alt="P2K -c" /></p>
</li>
<li>
<p>AESåŠ å¯†æ–¹æ¡ˆå°†<strong>è¾“å…¥æ¶ˆæ¯msg</strong> + <strong>åŠ å¯†å¯†é’¥</strong>ä½œä¸ºè¾“å…¥ã€‚ å®ƒäº§ç”Ÿ<strong>å¯†æ–‡</strong> + <strong>éšæœºç”Ÿæˆçš„IV</strong>ï¼ˆ128ä½saltï¼‰+ <strong>MACç </strong> ä½œä¸ºè¾“å‡ºï¼š<br />
<img src="http://q6r9jgptb.bkt.clouddn.com/mweb/AES.png" alt="AES -c" /></p>
<ul>
<li>
<p>å¯¹äºè‡ªå¸¦èº«ä»½éªŒè¯çš„åŠ å¯†ï¼ˆä¾‹å¦‚AES-GCMï¼‰ï¼Œåœ¨AESåŠ å¯†è¿‡ç¨‹ä¸­å·²ç»è‡ªåŠ¨è®¡ç®—äº†MACï¼›</p>
</li>
<li>
<p>å¦‚æœåŠ å¯†æ–¹æ¡ˆæœ¬èº«æ²¡æœ‰èº«ä»½éªŒè¯ï¼ˆä¾‹å¦‚AER-CTRï¼‰ï¼Œåˆ™AESåŠ å¯†è¿‡ç¨‹ä¸ä¼šè‡ªåŠ¨è®¡ç®—å‡ºMACç ï¼Œåº”å¦å¤–è¿›è¡Œè®¡ç®—ã€‚ å¯ä»¥ä½¿ç”¨åŠ å¯†å¯†é’¥ï¼ˆæˆ–å…¶æŸç§è½¬æ¢ï¼‰å’ŒæŸäº›MACå‡½æ•°ï¼ˆä¾‹å¦‚HMAC-SHA-256ï¼‰ä»è¾“å…¥æ¶ˆæ¯ä¸­è®¡ç®—å‡ºMACä»£ç ï¼š<img src="http://q6r9jgptb.bkt.clouddn.com/mweb/HMAC.png" alt="HMA -c" /></p>
</li>
<li>
<p>å¯†æ–‡æ˜¯é€šè¿‡AESåŠ å¯†ç®—æ³•è®¡ç®—çš„ã€‚ å®ƒé¦–å…ˆç”Ÿæˆä¸€ä¸ªéšæœºç›saltï¼ˆIVï¼‰ï¼Œå¹¶ä½¿ç”¨å®ƒé€šè¿‡AESå’ŒåŠ å¯†å¯†é’¥æ¥åŠ å¯†è¾“å…¥æ¶ˆæ¯ï¼š<img src="http://q6r9jgptb.bkt.clouddn.com/mweb/AES-IV.png" alt="AES-IV -c" /></p>
</li>
</ul>
</li>
<li>
<p>æœ€åï¼Œç”ŸæˆåŠ å¯†çš„è¾“å‡ºã€‚ å®ƒåŒ…å«å¯†æ–‡+ IV + MACã€‚ ï¼ˆå¯é€‰ï¼‰å®ƒè¿˜ä¿å­˜ç®—æ³•è®¾ç½®ã€‚</p>
</li>
</ol>
<h2 id="83-aesè§£å¯†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#83-aesè§£å¯†è¿‡ç¨‹"></a> 8.3 AESè§£å¯†è¿‡ç¨‹</h2>
<p>æ•´ä¸ªAESè§£å¯†è¿‡ç¨‹ï¼ˆåŸºäºå¯†ç çš„èº«ä»½éªŒè¯è§£å¯†ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li>åˆå§‹åŒ–ä¸åŠ å¯†è¿‡ç¨‹ç›¸åŒçš„AESç®—æ³•å‚æ•°ä»¥è¿›è¡Œè§£å¯†ã€‚</li>
<li>ä½¿ç”¨è§£å¯†å¯†é’¥å’ŒåŠ å¯†æ¶ˆæ¯ä¸­çš„IVï¼Œä½¿ç”¨AESç®—æ³•å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ã€‚ è¾“å‡ºæ˜¯åŸå§‹æ¶ˆæ¯ï¼š<img src="http://q6r9jgptb.bkt.clouddn.com/mweb/AES%20decrypt.png" alt="AES decrypt -c" />
<ul>
<li>å¯¹äºç»è¿‡èº«ä»½éªŒè¯çš„åŠ å¯†ï¼ˆå¦‚AES-GCMï¼‰ï¼Œå°†åœ¨è§£å¯†è¿‡ç¨‹ä¸­éªŒè¯é›†æˆçš„MACä»£ç ã€‚</li>
<li>å¦‚æœæœªç»èº«ä»½éªŒè¯çš„åŠ å¯†ï¼ˆå¦‚AES-CTRï¼‰ï¼Œåº”å¦‚ä¸‹é¢çš„æ­¥éª¤ä¸­æ‰€è¿°ï¼Œå¦å¤–è®¡ç®—å’ŒéªŒè¯MACä»£ç ï¼Œ</li>
</ul>
</li>
<li>è®¡ç®—åŸå§‹æ¶ˆæ¯çš„HMACï¼š<img src="http://q6r9jgptb.bkt.clouddn.com/mweb/AES%20HMAC.png" alt="AES HMA -c" /></li>
<li>å°†åŠ å¯†MACï¼ˆåŠ å¯†ä¹‹å‰è¾“å…¥æ¶ˆæ¯çš„MACï¼‰ä¸è§£å¯†MACï¼ˆè§£å¯†åæ¢å¤çš„åŸå§‹æ¶ˆæ¯çš„MACï¼‰è¿›è¡Œæ¯”è¾ƒï¼š<img src="http://q6r9jgptb.bkt.clouddn.com/mweb/Hmac%20compare.png" alt="Hmac compare -c" />
<ul>
<li>å¦‚æœMACç ç›¸åŒï¼Œåˆ™è§£å¯†æ­£ç¡®ï¼Œå¹¶è·å¾—åŸå§‹æ¶ˆæ¯ï¼›</li>
<li>å¦‚æœMACä»£ç ä¸åŒï¼Œåˆ™è§£å¯†å¤±è´¥ï¼Œå¹¶ä¸”åŸå§‹æ¶ˆæ¯ä¸æ˜¯è·å¾—çš„æ¶ˆæ¯ã€‚ å‘ç”Ÿè¿™ç§æƒ…å†µçš„åŸå› å¯èƒ½æœ‰å¾ˆå¤šï¼Œæœ€æœ‰å¯èƒ½æ˜¯â€œå¯†ç é”™è¯¯â€ã€‚ å…¶ä»–åŸå› ï¼šå¯†æ–‡ä¸æ­£ç¡®ï¼ŒIVé”™è¯¯ï¼Œç®—æ³•è®¾ç½®é”™è¯¯ï¼ŒKDFå‡½æ•°æˆ–KDFå‚æ•°é”™è¯¯ç­‰ã€‚</li>
</ul>
</li>
</ol>
<h2 id="84-aesåŠ å¯†è§£å¯†aes-ctraes-gcmç¤ºä¾‹"><a class="markdownIt-Anchor" href="#84-aesåŠ å¯†è§£å¯†aes-ctraes-gcmç¤ºä¾‹"></a> 8.4 AESåŠ å¯†/è§£å¯†ï¼ˆAES-CTRï¼ŒAES-GCMï¼‰ç¤ºä¾‹</h2>
<p>â€‹ä¸‹é¢çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹å°†è¯´æ˜ä¸€ä¸ªç®€å•çš„åŸºäºå¯†ç çš„AESåŠ å¯†ï¼ˆPBKDF2 + AES-CTRï¼‰ï¼Œæ²¡æœ‰æ¶ˆæ¯èº«ä»½éªŒè¯ã€‚ ç¬¬äºŒä¸ªç¤ºä¾‹å°†æ·»åŠ æ¶ˆæ¯èº«ä»½éªŒè¯ï¼ˆä½¿ç”¨AES-GCMæ¨¡å¼ï¼‰ï¼Œå¹¶ä¸”ä½¿ç”¨å¯†é’¥ç”Ÿæˆå‡½æ•° (AES-256-GCM + Scrypt)ã€‚</p>
<p>â€‹é¦–å…ˆï¼Œå®‰è£…å®ç°AESå¯¹ç§°å¯†é’¥åŠ å¯†ç®—æ³•çš„Pythonåº“Pyaesï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyaes</span><br></pre></td></tr></table></figure>
<p>â€‹æ¥ä¸‹æ¥ï¼Œå®‰è£…å®ç°PBKDF2å¯†é’¥ç”Ÿæˆç®—æ³•çš„Pythonåº“pbkdf2ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pbkdf2</span><br></pre></td></tr></table></figure>
<p>â€‹<strong>KDF</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyaes, pbkdf2, binascii, os, secrets</span><br><span class="line"></span><br><span class="line"><span class="comment"># Derive a 256-bit AES encryption key from the password</span></span><br><span class="line">password = <span class="string">"s3cr3t*c0d3"</span></span><br><span class="line">passwordSalt = os.urandom(<span class="number">16</span>)</span><br><span class="line">key = pbkdf2.PBKDF2(password, passwordSalt).read(<span class="number">32</span>)</span><br><span class="line">print(<span class="string">'AES encryption key:'</span>, binascii.hexlify(key))</span><br></pre></td></tr></table></figure>
<p>â€‹ä¸Šé¢çš„ä»£ç ä½¿ç”¨PBKDF2å¯†é’¥æ´¾ç”Ÿç®—æ³•ä»å¯†ç <code>s3cr3t*c0d3</code>æ´¾ç”Ÿ256ä½å¯†é’¥ï¼Œå®ƒä½¿ç”¨éšæœºå¯†ç æ´¾ç”Ÿç›ï¼ˆsalt 128ä½ï¼‰ï¼Œè¯¥saltåº”ä¸å¯†æ–‡ä¸€èµ·å­˜å‚¨åœ¨è¾“å‡ºä¸­ã€‚</p>
<p>â€‹<strong>AES Encryption (CTR Block Mode)</strong></p>
<p>â€‹æ¥ä¸‹æ¥ï¼Œä¸ºAES CTR ç”Ÿæˆä¸€ä¸ªéšæœºçš„256ä½åˆå§‹å‘é‡ï¼ˆIVï¼‰ï¼Œç„¶åæ‰§è¡ŒAES-256-CTRåŠ å¯†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Encrypt the plaintext with the given key:</span></span><br><span class="line"><span class="comment">#   ciphertext = AES-256-CTR-Encrypt(plaintext, key, iv)</span></span><br><span class="line">iv = secrets.randbits(<span class="number">256</span>)</span><br><span class="line">plaintext = <span class="string">"Text for encryption"</span></span><br><span class="line">aes = pyaes.AESModeOfOperationCTR(key, pyaes.Counter(iv))</span><br><span class="line">ciphertext = aes.encrypt(plaintext)</span><br><span class="line">print(<span class="string">'Encrypted:'</span>, binascii.hexlify(ciphertext))</span><br></pre></td></tr></table></figure>
<p>â€‹å¯†æ–‡ç”±38ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼ˆ19ä¸ªå­—èŠ‚ï¼Œ152ä½ï¼‰ç»„æˆã€‚ è¿™æ˜¯è¾“å…¥æ•°æ®<code>Text for encryption</code>çš„å¤§å°ï¼›</p>
<p>â€‹è¯·æ³¨æ„ï¼Œåœ¨AES-CTRåŠ å¯†ä¹‹åï¼Œåˆå§‹å‘é‡ï¼ˆIVï¼‰åº”è¯¥ä¸å¯†æ–‡ä¸€èµ·å­˜å‚¨ï¼Œå› ä¸ºæ²¡æœ‰å®ƒï¼Œè§£å¯†å°†æ˜¯ä¸å¯èƒ½çš„ã€‚ åº”è¯¥ä¸ºæ¯ç§AESåŠ å¯†ï¼ˆéç¡¬ç¼–ç ï¼‰éšæœºç”ŸæˆIVï¼Œä»¥æé«˜å®‰å…¨æ€§ã€‚</p>
<p>â€‹è¿˜è¦æ³¨æ„ï¼Œå¦‚æœæ‚¨å¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„åŠ å¯†å¯†é’¥å¯¹ç›¸åŒçš„çº¯æ–‡æœ¬è¿›è¡ŒåŠ å¯†ï¼Œç”±äºIVä¸­çš„éšæœºæ€§ï¼Œæ¯æ¬¡è¾“å‡ºéƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ è¿™æ˜¯é¢„æœŸçš„ç»“æœï¼Œä¼šå¢åŠ å®‰å…¨æ€§ï¼Œä¾‹å¦‚ï¼šæŠµæŠ—å­—å…¸æ”»å‡»ã€‚</p>
<p>â€‹<strong>AES Decryption (CTR Block Mode)</strong></p>
<p>â€‹ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨AES-CTR-256ç®—æ³•è§£å¯†å¯†æ–‡ã€‚ è¾“å…¥å†…å®¹åŒ…æ‹¬å¯†æ–‡+åŠ å¯†å¯†é’¥+ CTRè®¡æ•°å™¨çš„IVã€‚ è¾“å‡ºä¸ºåŸå§‹æ˜æ–‡ã€‚ ä»£ç å¾ˆç®€å•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Decrypt the ciphertext with the given key:</span></span><br><span class="line"><span class="comment">#   plaintext = AES-256-CTR-Decrypt(ciphertext, key, iv)</span></span><br><span class="line">aes = pyaes.AESModeOfOperationCTR(key, pyaes.Counter(iv))</span><br><span class="line">decrypted = aes.decrypt(ciphertext)</span><br><span class="line">print(<span class="string">'Decrypted:'</span>, decrypted)</span><br></pre></td></tr></table></figure>
<p>â€‹è¯·æ³¨æ„ï¼Œåº”å†æ¬¡åˆå§‹åŒ–AESå¯¹è±¡ï¼Œå› ä¸ºCTRå¯†ç å—æ¨¡å¼ç®—æ³•ä¼šä¿æŒå†…éƒ¨çŠ¶æ€éšæ—¶é—´å˜åŒ–ã€‚</p>
<p>â€‹è¿˜è¯·æ³¨æ„ï¼Œä»¥ä¸Šä»£ç æ— æ³•æ£€æµ‹åˆ°é”™è¯¯çš„å¯†é’¥ï¼Œé”™è¯¯çš„å¯†æ–‡æˆ–é”™è¯¯çš„IVã€‚ å¦‚æœæ‚¨ä½¿ç”¨ä¸æ­£ç¡®çš„å¯†é’¥æ¥è§£å¯†å¯†æ–‡ï¼Œåˆ™ä¼šå¾—åˆ°é”™è¯¯çš„ä¸å¯è¯»æ–‡æœ¬ã€‚ ä¸‹é¢çš„ä»£ç æ¸…æ¥šåœ°æ˜¾ç¤ºäº†è¿™ä¸€ç‚¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key = os.urandom(<span class="number">32</span>)   <span class="comment"># random decryption key</span></span><br><span class="line">aes = pyaes.AESModeOfOperationCTR(key, pyaes.Counter(iv))</span><br><span class="line">print(<span class="string">'Wrongly decrypted:'</span>, aes.decrypt(ciphertext))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wrongly decrypted: b&#39;\xe6!\n\x9a\xa9\x15\x12\xd9\xcb\x9cS\x86\xcc\xe1\x1d\x1a\x8blw&#39;</span><br></pre></td></tr></table></figure>
<h3 id="841-aes-256-gcmç¤ºä¾‹"><a class="markdownIt-Anchor" href="#841-aes-256-gcmç¤ºä¾‹"></a> 8.4.1 AES-256-GCMç¤ºä¾‹</h3>
<p>â€‹		ç°åœ¨æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•ä½¿ç”¨<code>AES-256-GCM</code>å¯¹ç§°åŠ å¯†ã€‚ æˆ‘ä»¬å°†ä¸ºAESä½¿ç”¨å¦ä¸€ä¸ªPythonåº“ï¼Œç§°ä¸º<code>pycryptodome</code>ï¼Œè¯¥åº“æ”¯æŒAES-256-GCMæ„é€ ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pycryptodome</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œè¯¥ç¤ºä¾‹ç”Ÿæˆä¸€ä¸ªéšæœºåŠ å¯†å¯†é’¥ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥åŠ å¯†æ–‡æœ¬æ¶ˆæ¯ï¼Œç„¶åå°†å…¶è§£å¯†å›åŸå§‹çš„çº¯æ–‡æœ¬æ¶ˆæ¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> binascii, os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_AES_GCM</span><span class="params">(msg, secretKey)</span>:</span></span><br><span class="line">    aesCipher = AES.new(secretKey, AES.MODE_GCM)</span><br><span class="line">    ciphertext, authTag = aesCipher.encrypt_and_digest(msg)</span><br><span class="line">    <span class="keyword">return</span> (ciphertext, aesCipher.nonce, authTag)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_AES_GCM</span><span class="params">(encryptedMsg, secretKey)</span>:</span></span><br><span class="line">    (ciphertext, nonce, authTag) = encryptedMsg</span><br><span class="line">    aesCipher = AES.new(secretKey, AES.MODE_GCM, nonce)</span><br><span class="line">    plaintext = aesCipher.decrypt_and_verify(ciphertext, authTag)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">secretKey = os.urandom(<span class="number">32</span>)  <span class="comment"># 256-bit random encryption key</span></span><br><span class="line">print(<span class="string">"Encryption key:"</span>, binascii.hexlify(secretKey))</span><br><span class="line"></span><br><span class="line">msg = <span class="string">b'Message for AES-256-GCM + Scrypt encryption'</span></span><br><span class="line">encryptedMsg = encrypt_AES_GCM(msg, secretKey)</span><br><span class="line">print(<span class="string">"encryptedMsg"</span>, &#123;</span><br><span class="line">    <span class="string">'ciphertext'</span>: binascii.hexlify(encryptedMsg[<span class="number">0</span>]),</span><br><span class="line">    <span class="string">'aesIV'</span>: binascii.hexlify(encryptedMsg[<span class="number">1</span>]),</span><br><span class="line">    <span class="string">'authTag'</span>: binascii.hexlify(encryptedMsg[<span class="number">2</span>])</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">decryptedMsg = decrypt_AES_GCM(encryptedMsg, secretKey)</span><br><span class="line">print(<span class="string">"decryptedMsg"</span>, decryptedMsg)</span><br></pre></td></tr></table></figure>
<p>â€‹		AES-GCMåŠ å¯†å°†æ¶ˆæ¯<strong>msg</strong> + åŠ å¯†å¯†é’¥<strong>secretKey</strong>ä½œä¸ºè¾“å…¥ï¼Œå¹¶äº§ç”Ÿä¸€ç»„å€¼ï¼š{ <strong>ciphertext</strong> + <strong>nonce</strong> + <strong>authTag</strong> }ã€‚</p>
<ul>
<li><strong>ciphertext</strong>æ˜¯åŠ å¯†åçš„æ¶ˆæ¯ï¼›</li>
<li><strong>nonce</strong>æ˜¯ç”¨äºGCMæ„å»ºçš„éšæœºç”Ÿæˆçš„åˆå§‹å‘é‡ï¼ˆIVï¼‰ï¼›</li>
<li><strong>authTag</strong>æ˜¯åŠ å¯†è¿‡ç¨‹ä¸­è®¡ç®—å‡ºçš„æ¶ˆæ¯èº«ä»½éªŒè¯ä»£ç ï¼ˆMACï¼‰ï¼›</li>
</ul>
<p>â€‹ä¸Šé¢ä»£ç ä¸­ç”Ÿæˆçš„åŠ å¯†å¯†é’¥å¤§å°ä¸º256ä½ï¼ˆ32å­—èŠ‚ï¼‰ï¼Œå¹¶å°†AES-GCMé…ç½®ä¸ºAES-256-GCMã€‚ å¦‚æœå°†å¯†é’¥å¤§å°æ›´æ”¹ä¸º128ä½æˆ–192ä½ï¼Œåˆ™åº”åˆ†åˆ«ä½¿ç”¨AES-128-GCMæˆ–AES-192-GCMã€‚</p>
<h3 id="842-aes-256-gcm-scrypt-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#842-aes-256-gcm-scrypt-ç¤ºä¾‹"></a> 8.4.2 AES-256-GCM + Scrypt ç¤ºä¾‹</h3>
<p>â€‹		ç°åœ¨è®©æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªæ›´å¤æ‚çš„ç¤ºä¾‹ï¼šæˆ‘ä»¬å°†ä½¿ç”¨ç»è¿‡èº«ä»½éªŒè¯çš„åŠ å¯†ç»“æ„AES-256-GCMï¼Œå¹¶ç»“åˆScryptå¯†é’¥æ¨å¯¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> scrypt, os, binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_AES_GCM</span><span class="params">(msg, password)</span>:</span></span><br><span class="line">    kdfSalt = os.urandom(<span class="number">16</span>)</span><br><span class="line">    secretKey = scrypt.hash(password, kdfSalt, N=<span class="number">16384</span>, r=<span class="number">8</span>, p=<span class="number">1</span>, buflen=<span class="number">32</span>)</span><br><span class="line">    aesCipher = AES.new(secretKey, AES.MODE_GCM)</span><br><span class="line">    ciphertext, authTag = aesCipher.encrypt_and_digest(msg)</span><br><span class="line">    <span class="keyword">return</span> (kdfSalt, ciphertext, aesCipher.nonce, authTag)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_AES_GCM</span><span class="params">(encryptedMsg, password)</span>:</span></span><br><span class="line">    (kdfSalt, ciphertext, nonce, authTag) = encryptedMsg</span><br><span class="line">    secretKey = scrypt.hash(password, kdfSalt, N=<span class="number">16384</span>, r=<span class="number">8</span>, p=<span class="number">1</span>, buflen=<span class="number">32</span>)</span><br><span class="line">    aesCipher = AES.new(secretKey, AES.MODE_GCM, nonce)</span><br><span class="line">    plaintext = aesCipher.decrypt_and_verify(ciphertext, authTag)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">msg = <span class="string">b'Message for AES-256-GCM + Scrypt encryption'</span></span><br><span class="line">password = <span class="string">b's3kr3tp4ssw0rd'</span></span><br><span class="line">encryptedMsg = encrypt_AES_GCM(msg, password)</span><br><span class="line">print(<span class="string">"encryptedMsg"</span>, &#123;</span><br><span class="line">    <span class="string">'kdfSalt'</span>: binascii.hexlify(encryptedMsg[<span class="number">0</span>]),</span><br><span class="line">    <span class="string">'ciphertext'</span>: binascii.hexlify(encryptedMsg[<span class="number">1</span>]),</span><br><span class="line">    <span class="string">'aesIV'</span>: binascii.hexlify(encryptedMsg[<span class="number">2</span>]),</span><br><span class="line">    <span class="string">'authTag'</span>: binascii.hexlify(encryptedMsg[<span class="number">3</span>])</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">decryptedMsg = decrypt_AES_GCM(encryptedMsg, password)</span><br><span class="line">print(<span class="string">"decryptedMsg"</span>, decryptedMsg)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä½¿ç”¨ç»™å®šçš„æ–‡æœ¬å¯†ç ç”Ÿæˆç§˜é’¥ï¼Œä½¿ç”¨AES-256-GCMç»™æ–‡æœ¬æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ã€‚</p>
<ul>
<li>åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨Scrypt KDFå‡½æ•°ï¼ˆå…·æœ‰ä¸€äº›å›ºå®šå‚æ•°ï¼‰æ ¹æ®å¯†ç ç”Ÿæˆå¯†é’¥ã€‚ ç”¨äºå¯†é’¥æ´¾ç”Ÿçš„éšæœºç”Ÿæˆçš„KDFç›ä¸åŠ å¯†çš„æ¶ˆæ¯ä¸€èµ·å­˜å‚¨ï¼Œè§£å¯†æ—¶å°†ä¼šä½¿ç”¨åˆ°ã€‚ ç„¶åï¼Œä½¿ç”¨ç§é’¥å¯¹è¾“å…¥æ¶ˆæ¯è¿›è¡ŒAESåŠ å¯†ï¼Œå¹¶ä¸”è¾“å‡ºç”±<strong>ciphertext</strong>ï¼ˆå¯†æ–‡ï¼‰+ <strong>IV</strong>ï¼ˆéšæœºæ•°ï¼‰+ <strong>authTag</strong>ï¼ˆHMACï¼‰+ <strong>salt</strong>ï¼ˆKDF saltï¼‰ ç»„æˆçš„ç»“æœ ã€‚</li>
<li>åœ¨è§£å¯†è¿‡ç¨‹ä¸­ï¼ŒScryptå¯†é’¥æ´¾ç”Ÿï¼ˆå…·æœ‰ç›¸åŒçš„å‚æ•°ï¼‰ç”¨äºæ ¹æ®åŠ å¯†å¯†ç ä»¥åŠKDFç›ï¼ˆsaltåœ¨åŠ å¯†è¿‡ç¨‹ä¸­éšæœºç”Ÿæˆï¼‰å¾—å‡ºç›¸åŒçš„è§£å¯†å¯†é’¥ã€‚ ç„¶åï¼Œä½¿ç”¨å¯†é’¥ï¼ŒIVï¼ˆéšæœºæ•°ï¼‰å’ŒauthTagï¼ˆHMACï¼‰å¯¹å¯†æ–‡è¿›è¡ŒAESè§£å¯†ã€‚ å¦‚æœæˆåŠŸï¼Œåˆ™ç»“æœæ˜¯è§£å¯†çš„åŸå§‹æ˜æ–‡ã€‚ å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™èº«ä»½éªŒè¯æ ‡ç­¾å°†æ— æ³•å¯¹è§£å¯†è¿‡ç¨‹è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”å°†å¼•å‘å¼‚å¸¸ã€‚</li>
</ul>
<h3 id="843-ä»¥å¤ªåŠutc-jsoné’±åŒ…åŠ å¯†aes-scrypt-mac"><a class="markdownIt-Anchor" href="#843-ä»¥å¤ªåŠutc-jsoné’±åŒ…åŠ å¯†aes-scrypt-mac"></a> 8.4.3 ä»¥å¤ªåŠUTC / JSONé’±åŒ…åŠ å¯†ï¼ˆAES + Scrypt + MACï¼‰</h3>
<p>â€‹		æ¼”ç¤ºAESå¯†ç åœ¨å®é™…ä¸­çš„åº”ç”¨ï¼Œæˆ‘ä»¬å°†çœ‹ä¸€ä¸ªçœŸå®çš„ä¾‹å­ï¼šä»¥å¤ªåŠåŒºå—é“¾çš„æ ‡å‡†åŠ å¯†é’±åŒ…æ–‡ä»¶æ ¼å¼ã€‚æˆ‘ä»¬å°†çœ‹åˆ°AES-128-CTRå¯†ç å¦‚ä½•ä¸Scryptå’ŒMACç»“åˆä½¿ç”¨ï¼Œä»¥é€šè¿‡åŸºäºæ–‡æœ¬çš„å¯†ç å®‰å…¨åœ°å®ç°ç»è¿‡èº«ä»½éªŒè¯çš„å¯¹ç§°å¯†é’¥åŠ å¯†ã€‚</p>
<h3 id="844-ethereum-utc-json-wallets"><a class="markdownIt-Anchor" href="#844-ethereum-utc-json-wallets"></a> 8.4.4 Ethereum UTC / JSON Wallets</h3>
<p>â€‹åœ¨å…¬å…±åŒºå—é“¾ç½‘ç»œï¼ˆå¦‚æ¯”ç‰¹å¸å’Œä»¥å¤ªåŠï¼‰ä¸­ï¼ŒåŒºå—é“¾èµ„äº§æŒæœ‰äººçš„ç§é’¥å­˜å‚¨åœ¨ç§°ä¸ºåŠ å¯†é’±åŒ…çš„ç‰¹æ®Šå¯†é’¥åº“ä¸­ã€‚ é€šå¸¸ï¼Œè¿™äº›åŠ å¯†é’±åŒ…æ˜¯æœ¬åœ°ç¡¬ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œç”±å¯†ç åŠ å¯†ã€‚	<br />
â€‹åœ¨ä»¥å¤ªåŠä¸­ï¼ŒåŒºå—é“¾åŠ å¯†è´§å¸é’±åŒ…ä»¥ä¸€ç§ç‰¹æ®Šçš„åŠ å¯†æ ¼å¼åœ¨å†…éƒ¨å­˜å‚¨ï¼Œç§°ä¸º&quot;<a href="https://theethereum.wiki/w/index.php/Accounts,_Addresses,_Public_And_Private_Keys,_And_Tokens#UTC_JSON_Keystore_File" target="_blank" rel="noopener"><strong>UTC / JSON Wallet (Keystore File)</strong></a>&quot; æˆ–è€… â€œ<a href="https://github.com/ethereum/wiki/wiki/Web3-Secret-Storage-Definition" target="_blank" rel="noopener"><strong>Web3 Secret Storage Definition</strong></a>â€ã€‚è¿™æ˜¯<a href="https://geth.ethereum.org/" target="_blank" rel="noopener"><strong>geth</strong></a> å’Œ <a href="https://www.parity.io/ethereum" target="_blank" rel="noopener"><strong>Parity</strong></a> ï¼ˆä¸¤ä¸ªä¸»è¦çš„ä»¥å¤ªåŠåè®®çš„å®ç°ï¼‰ã€<a href="https://www.myetherwallet.com/" target="_blank" rel="noopener"><strong>MyEtherWallet</strong></a>ï¼ˆæµè¡Œçš„åœ¨çº¿å®¢æˆ·ç«¯ä»¥å¤ªåŠé’±åŒ…ï¼‰ã€<a href="https://metamask.io/" target="_blank" rel="noopener"><strong>MetaMask</strong></a> ï¼ˆå¹¿æ³›ç”¨äºæµè§ˆå™¨å†…çš„ä»¥å¤ªåŠé’±åŒ…ï¼‰ã€<a href="https://github.com/ethers-io/ethers.js/" target="_blank" rel="noopener"><strong>ethers.js</strong></a> and <a href="https://github.com/Nethereum/Nethereum" target="_blank" rel="noopener"><strong>Nethereum</strong></a> librariesä»¥åŠè®¸å¤šå…¶ä»–ä¸ä»¥å¤ªåŠç›¸å…³çš„æŠ€æœ¯å’Œå·¥å…·ä¸­ä½¿ç”¨çš„é’±åŒ…æ–‡ä»¶æ ¼å¼ã€‚</p>
<p>â€‹ä»¥å¤ªåŠ <strong>UTC / JSON keystores</strong>å°†åŠ å¯†çš„ç§é’¥ä¿å­˜ä¸ºJSONæ–‡æœ¬æ–‡æ¡£ï¼ŒæŒ‡å®šåŠ å¯†çš„æ•°æ®ï¼ŒåŠ å¯†ç®—æ³•åŠå…¶å‚æ•°ã€‚</p>
<h3 id="845-utc-json-keystores-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#845-utc-json-keystores-ç¤ºä¾‹"></a> 8.4.5 UTC / JSON keystores ç¤ºä¾‹</h3>
<p>â€‹UTC / JSON keystoresæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å—å¯†ç ä¿æŠ¤çš„256ä½ç§é’¥ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">"id"</span>: <span class="string">"07a9f767-93c5-4842-9afd-b3b083659f04"</span>,</span><br><span class="line">  <span class="attr">"address"</span>: <span class="string">"aef8cad64d29fcc4ed07629b9e896ebc3160a8d0"</span>,</span><br><span class="line">  <span class="attr">"Crypto"</span>: &#123;</span><br><span class="line">    <span class="attr">"ciphertext"</span>: <span class="string">"99d0e66c67941a08690e48222a58843ef2481e110969325db7ff5284cd3d3093"</span>,</span><br><span class="line">    <span class="attr">"cipherparams"</span>: &#123; <span class="attr">"iv"</span>: <span class="string">"7d7fabf8dee2e77f0d7e3ff3b965fc23"</span> &#125;,</span><br><span class="line">    <span class="attr">"cipher"</span>: <span class="string">"aes-128-ctr"</span>,</span><br><span class="line">    <span class="attr">"kdf"</span>: <span class="string">"scrypt"</span>,</span><br><span class="line">    <span class="attr">"kdfparams"</span>: &#123;</span><br><span class="line">      <span class="attr">"dklen"</span>: <span class="number">32</span>,</span><br><span class="line">      <span class="attr">"salt"</span>: <span class="string">"85ad073989d461c72358ccaea3551f7ecb8e672503cb05c2ee80cfb6b922f4d4"</span>,</span><br><span class="line">      <span class="attr">"n"</span>: <span class="number">8192</span>,</span><br><span class="line">      <span class="attr">"r"</span>: <span class="number">8</span>,</span><br><span class="line">      <span class="attr">"p"</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">    <span class="attr">"mac"</span>: <span class="string">"06dcf1cc4bffe1616fafe94a2a7087fd79df444756bb17c93af588c3ab02a913"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€‹ä¸Šé¢çš„JSONæ–‡æ¡£æ˜¯ç»è¿‡èº«ä»½éªŒè¯çš„å¯¹ç§°åŠ å¯†çš„ç»å…¸ç¤ºä¾‹ã€‚é€šå¸¸ï¼ŒUTC / JSON keystoreså­˜å‚¨åŒºåŒ…å«ä»¥ä¸‹æ•°æ®ï¼š</p>
<ul>
<li><strong>cipher</strong>ï¼šå¯¹ç§° <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank" rel="noopener">AES ç®—æ³•</a>çš„åç§° <strong>AES-128-CTR</strong>;</li>
<li><strong>cipherparams</strong>ï¼šä¸Šè¿° <em>cipher</em> ç®—æ³•éœ€è¦çš„å‚æ•°;</li>
<li><strong>ciphertext</strong>ï¼šä½ çš„ä»¥å¤ªåŠç§é’¥ä½¿ç”¨ä¸Šè¿° <em>cipher</em> ç®—æ³•è¿›è¡ŒåŠ å¯†;</li>
<li><strong>kdf</strong>ï¼š<a href="https://en.wikipedia.org/wiki/Key_derivation_function" target="_blank" rel="noopener">å¯†é’¥ç”Ÿæˆå‡½æ•°</a>ï¼Œç”¨äºè®©ä½ ç”¨å¯†ç åŠ å¯† keystore æ–‡ä»¶;</li>
<li><strong>kdfparams</strong>ï¼šä¸Šè¿° kdf ç®—æ³•éœ€è¦çš„å‚æ•°;</li>
<li><strong>Mac</strong>ï¼šç”¨äºéªŒè¯å¯†ç çš„<a href="https://en.wikipedia.org/wiki/Message_authentication_code" target="_blank" rel="noopener">ä»£ç </a>ã€‚</li>
<li>å…¶ä»–å…ƒæ•°æ®ï¼šé’±åŒ…æ ¼å¼versionï¼ˆç‰ˆæœ¬ï¼‰ï¼Œé’±åŒ…å”¯ä¸€idï¼ˆuuidï¼‰å’Œç”±è¯¥é’±åŒ…æ§åˆ¶çš„address(åŒºå—é“¾åœ°å€)ã€‚</li>
</ul>
<p><code>æ³¨</code>ï¼š<a href="https://ethfans.org/posts/what-is-an-ethereum-keystore-file" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯ä»¥å¤ªåŠç§é’¥å‚¨å­˜ï¼ˆKeystoreï¼‰æ–‡ä»¶</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/07.%20Symmetric%20Key%20Ciphers%20-%20Overview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/07.%20Symmetric%20Key%20Ciphers%20-%20Overview/" class="post-title-link" itemprop="url">07. Symmetric Key Ciphers - Overview</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:18" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:18+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹å¯¹ç§°åŠ å¯†ï¼ˆä¾‹å¦‚<code>AES</code>ï¼Œ<code>ChaCha20</code>ï¼Œ<code>RC6</code>ï¼Œ<code>Twofish</code>ï¼Œ<code>CAST</code>ç­‰ï¼‰ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼ˆæˆ–å¯†ç ï¼‰æ¥åŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚ å®ƒä»¬é€šå¸¸ä¸å…¶ä»–ç®—æ³•ç»“åˆä½¿ç”¨ä»¥å½¢æˆå¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼ˆä¾‹å¦‚<code>ChaCha20-Poly1305</code>å’Œ<code>AES-128-GCM</code>å’Œ<code>AES-256-CTR-HMAC-SHA256</code>ï¼‰ã€‚å¯¹ç§°å¯†é’¥å¯†ç å…·æœ‰æŠ—é‡å­æ€§ï¼Œè¿™æ„å‘³ç€åŠŸèƒ½å¼ºå¤§çš„é‡å­è®¡ç®—æœºä¹Ÿæ— æ³•ç ´åå…¶å®‰å…¨æ€§ï¼ˆä½¿ç”¨è¶³å¤Ÿé•¿çš„å¯†é’¥é•¿åº¦æ—¶ï¼‰ã€‚</p>
<p>â€‹å¯¹ç§°åŠ å¯†å¯ä»¥åŠ å¯†ä»¥å›ºå®šå¤§å°çš„å—å½¢å¼å‡ºç°çš„æ•°æ®ï¼ˆ<strong>block ciphers</strong>ï¼Œå—å¯†ç ï¼‰æˆ–ä»¥å­—èŠ‚åºåˆ—å½¢å¼å‡ºç°çš„æ•°æ®ï¼ˆ<strong>stream ciphers</strong>ï¼Œæµå¯†ç ï¼‰ã€‚å¯ä»¥é€šè¿‡æŸäº›æ„é€ å°†<strong>block ciphers</strong>è½¬æ¢ä¸º<strong>stream ciphers</strong>ï¼Œè¿™ç§æ„é€ ç§°ä¸ºâ€œ<strong>block cipher modes</strong> of operationâ€</p>
<h2 id="71-åˆ†ç»„å¯†ç æµå¯†ç åˆ†ç»„æ¨¡å¼å’Œå¡«å……-block-ciphers-stream-ciphers-block-modes-and-padding"><a class="markdownIt-Anchor" href="#71-åˆ†ç»„å¯†ç æµå¯†ç åˆ†ç»„æ¨¡å¼å’Œå¡«å……-block-ciphers-stream-ciphers-block-modes-and-padding"></a> 7.1 åˆ†ç»„å¯†ç ï¼Œæµå¯†ç ï¼Œåˆ†ç»„æ¨¡å¼å’Œå¡«å……( Block Ciphers, Stream Ciphers, Block Modes and Padding)</h2>
<p>â€‹åœ¨å¯†ç å­¦ä¸­ï¼Œå—å¯†ç ï¼ˆä¾‹å¦‚AESï¼‰è¢«è®¾è®¡ä¸ºå¯¹å›ºå®šå¤§å°ï¼ˆä¾‹å¦‚128ä½ï¼‰çš„æ•°æ®å—è¿›è¡ŒåŠ å¯†ã€‚è¾“å…¥å—çš„å¤§å°é€šå¸¸ä¸åŠ å¯†è¾“å‡ºå—çš„å¤§å°ç›¸åŒï¼Œè€Œå¯†é’¥é•¿åº¦å¯èƒ½ä¸åŒã€‚</p>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Stream_cipher" target="_blank" rel="noopener"><strong>Stream ciphers</strong></a> åˆ™æ›´åŠ çµæ´»ï¼šå®ƒä»¬æ—¨åœ¨åŠ å¯†ä»»æ„å¤§å°çš„æ•°æ®ï¼ˆä¾‹å¦‚PDFæ–‡æ¡£ï¼‰ï¼Œè¿™äº›æ•°æ®æœ‰æ—¶å¯èƒ½ä»¥æµçš„å½¢å¼å‡ºç°ï¼ˆå­—èŠ‚æˆ–å¸§çš„åºåˆ—ï¼Œä¾‹å¦‚è§†é¢‘æµï¼‰ã€‚å¤§å¤šæ•°æµè¡Œçš„å¯¹ç§°å¯†é’¥åŠ å¯†ç®—æ³•éƒ½æ˜¯å—å¯†ç ï¼Œä½†æ˜¯å¯†ç å­¦å®¶æå‡ºäº†å‡ ç§æ–¹æ¡ˆï¼Œå¯ä»¥å°†å—å¯†ç è½¬æ¢ä¸ºæµå¯†ç å¹¶åŠ å¯†ä»»æ„å¤§å°çš„æ•°æ®ã€‚è¿™äº›æ–¹æ¡ˆè¢«ç§°ä¸ºâ€œ<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation" target="_blank" rel="noopener"><strong>block cipher modes of operation</strong></a>â€ï¼Œå¹¶ä¸”é€‚ç”¨äºå¤§å¤šæ•°åˆ†ç»„å¯†ç ï¼Œä¾‹å¦‚<strong>AES</strong>ï¼Œ<strong>RC6</strong>ï¼Œ<strong>Camellia</strong>ï¼Œ<strong>Serpent</strong>ç­‰ã€‚</p>
<p>â€‹å½“å¯¹ç§°å¯†ç ä¸åˆ†ç»„æ“ä½œæ¨¡å¼ç»“åˆä½¿ç”¨æ—¶ï¼Œæ‰€è·å¾—çš„å¯†ç ç»“æ„ç”±å¯†ç åç§°ï¼Œåˆ†ç»„æ¨¡å¼å’Œå¯†é’¥å¤§å°è¡¨ç¤ºã€‚ ä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>AES-256-GCM</strong> ï¼š the AES cipher with a 256-bit encryption key and GCM block mode</li>
<li><strong>AES-128-CTR</strong> - the AES cipher with a 128-bit encryption key and CTR block mode</li>
<li><strong>Serpent-128-CBC</strong> - the Serpent cipher with 128-bit encryption key and CBC block mode</li>
</ul>
<h2 id="72-åˆ†ç»„åŠ å¯†æ¨¡å¼cbc-ctr-gcm"><a class="markdownIt-Anchor" href="#72-åˆ†ç»„åŠ å¯†æ¨¡å¼cbc-ctr-gcm"></a> 7.2 åˆ†ç»„åŠ å¯†æ¨¡å¼(CBC, CTR, GCMï¼Œâ€¦)</h2>
<p>â€‹åˆ†ç»„åŠ å¯†æ¨¡å¼ï¼ˆ <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation" target="_blank" rel="noopener"><strong>block cipher modes</strong></a>ï¼Œä¾‹å¦‚CBCï¼ŒCFBï¼ŒOFBï¼ŒCTRï¼ŒEAXï¼ŒCCMå’ŒGCMï¼‰èƒŒåçš„ä¸»è¦æ€æƒ³æ˜¯é‡å¤åº”ç”¨å¯†ç çš„å•å—åŠ å¯†/è§£å¯†ï¼Œä»¥å®‰å…¨åœ°åŠ å¯†/è§£å¯†å¤§äºå—çš„æ•°æ®é‡ã€‚</p>
<p>â€‹æŸäº›å—æ¨¡å¼ï¼ˆä¾‹å¦‚CBCï¼‰è¦æ±‚å°†è¾“å…¥æ‹†åˆ†ä¸ºå—ï¼Œå¹¶ä½¿ç”¨å¡«å……ç®—æ³•ï¼ˆä¾‹å¦‚æ·»åŠ ç‰¹æ®Šçš„å¡«å……å­—ç¬¦ï¼‰å°†æœ€ç»ˆå—å¡«å……ä¸ºå›ºå®šçš„å—å¤§å°ã€‚å…¶ä»–å—æ¨¡å¼ï¼ˆä¾‹å¦‚CTRï¼ŒCFBï¼ŒOFBï¼ŒCCMï¼ŒEAXå’ŒGCMï¼‰æ ¹æœ¬ä¸éœ€è¦å¡«å……ï¼Œå› ä¸ºå®ƒä»¬åœ¨æ¯ä¸€æ­¥éƒ½æ‰§è¡Œæ˜æ–‡éƒ¨åˆ†ä¸å†…éƒ¨å¯†ç çŠ¶æ€ä¹‹é—´çš„XORï¼ˆå¼‚æˆ–ï¼‰ã€‚</p>
<p>â€‹åŸºæœ¬ä¸Šï¼Œå¯¹å¤§å‹è¾“å…¥æ•°æ®è¿›è¡ŒåŠ å¯†çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼šåˆå§‹åŒ–åŠ å¯†ç®—æ³•çŠ¶æ€ï¼ˆä½¿ç”¨åŠ å¯†å¯†é’¥+éšæœºç›saltï¼‰ï¼Œç„¶åå¯¹æ•°æ®çš„ç¬¬ä¸€éƒ¨åˆ†ï¼ˆä¾‹å¦‚å—æˆ–å—çš„ä¸€éƒ¨åˆ†ï¼‰è¿›è¡ŒåŠ å¯†ï¼Œç„¶ååŠ å¯†çŠ¶æ€ è½¬æ¢ï¼ˆä½¿ç”¨åŠ å¯†å¯†é’¥å’Œå…¶ä»–å‚æ•°ï¼‰ï¼Œç„¶åå¯¹ä¸‹ä¸€éƒ¨åˆ†è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå†æ¬¡è½¬æ¢åŠ å¯†çŠ¶æ€ï¼Œç„¶åå¯¹ä¸‹ä¸€éƒ¨åˆ†è¿›è¡ŒåŠ å¯†ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°å¤„ç†å®Œæ‰€æœ‰è¾“å…¥æ•°æ®ä¸ºæ­¢ã€‚ è§£å¯†çš„å·¥ä½œæ–¹å¼éå¸¸ç›¸ä¼¼ã€‚</p>
<p>â€‹ä¸ºäº†æ­£ç¡®ä½¿ç”¨å®ƒä»¬ï¼Œå¼€å‘äººå‘˜åº”è¯¥äº†è§£â€œ<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation" target="_blank" rel="noopener"><strong>block cipher modes of operation</strong></a>â€ï¼š</p>
<ul>
<li>å¸¸ç”¨çš„å®‰å…¨å—æ¨¡å¼æ˜¯CBCï¼ˆå¯†ç å—é“¾æ¥ï¼‰ï¼ŒCTRï¼ˆè®¡æ•°å™¨ï¼‰å’ŒGCMï¼ˆGalois /è®¡æ•°å™¨æ¨¡å¼ï¼‰ï¼Œå®ƒä»¬éœ€è¦ä¸€ä¸ªéšæœºçš„ï¼ˆä¸å¯é¢„æµ‹çš„ï¼‰åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ï¼Œå¼€å§‹æ—¶ä¹Ÿç§°ä¸ºéšæœºæ•°ï¼ˆ<strong>nonce</strong>ï¼‰æˆ–ç›ï¼ˆ<strong>salt</strong>ï¼‰ã€‚</li>
<li>â€œ<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_(CTR)" target="_blank" rel="noopener"><strong>Counter (CTR)</strong></a>â€å—æ¨¡å¼æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå…·æœ‰å¼ºå¤§çš„å®‰å…¨æ€§å’Œå¹¶è¡Œå¤„ç†èƒ½åŠ›ï¼Œå¯ä»¥ä»»æ„çš„è¾“å…¥æ•°æ®é•¿åº¦ï¼ˆæ— å¡«å……ï¼‰ã€‚ å®ƒä¸æä¾›èº«ä»½éªŒè¯å’Œå®Œæ•´æ€§ï¼Œä»…æä¾›åŠ å¯†ã€‚</li>
<li><a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode" target="_blank" rel="noopener"><strong>GCM</strong></a> (Galois/Counter Mode) å—æ¨¡å¼åˆ©ç”¨äº†CTRæ¨¡å¼çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œå¹¶æ·»åŠ äº†æ¶ˆæ¯èº«ä»½éªŒè¯ï¼ˆç”Ÿæˆå¯†ç æ¶ˆæ¯èº«ä»½éªŒè¯æ ‡ç­¾ï¼‰ã€‚ GCMæ˜¯åœ¨å¯¹ç§°å¯†ç ä¸­å®ç°èº«ä»½éªŒè¯åŠ å¯†çš„å¿«é€Ÿè€Œæœ‰æ•ˆçš„æ–¹æ³•ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨GCMã€‚</li>
<li>CBCæ¨¡å¼ä»¥å›ºå®šå¤§å°çš„å—å·¥ä½œã€‚ å› æ­¤ï¼Œåœ¨å°†è¾“å…¥æ•°æ®æ‹†åˆ†ä¸ºå—ä¹‹åï¼Œåº”ä½¿ç”¨å¡«å……ç®—æ³•ï¼ˆ<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Padding" target="_blank" rel="noopener"><strong>padding algorithm</strong></a> ï¼‰ä½¿æœ€åä¸€ä¸ªå—å…·æœ‰ç›¸åŒçš„é•¿åº¦ã€‚ å¤§å¤šæ•°åº”ç”¨ç¨‹åºä½¿ç”¨PKCS7å¡«å……æ–¹æ¡ˆï¼ˆ<a href="https://en.wikipedia.org/wiki/Padding_(cryptography)#PKCS#5_and_PKCS#7" target="_blank" rel="noopener"><strong>PKCS7 padding scheme</strong></a> ï¼‰æˆ–ANSI X.923ï¼ˆ<a href="https://en.wikipedia.org/wiki/Padding_(cryptography)#ANSI_X.923" target="_blank" rel="noopener"><strong>ANSI X.923</strong></a>ï¼‰ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒCBCé˜»æ­¢æ¨¡å¼å¯èƒ½å®¹æ˜“å—åˆ°â€œå¡«å……é¢„è¨€â€æ”»å‡»ï¼ˆ<a href="https://en.wikipedia.org/wiki/Padding_oracle_attack" target="_blank" rel="noopener"><strong>&quot;padding oracle&quot; attack</strong></a>,ï¼‰ï¼Œå› æ­¤æœ€å¥½é¿å…ä½¿ç”¨CBCæ¨¡å¼ã€‚</li>
<li>ä¼—æ‰€å‘¨çŸ¥çš„ä¸å®‰å…¨å—æ¨¡å¼æ˜¯<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_(ECB)" target="_blank" rel="noopener"><strong>ECB</strong></a> ï¼ˆç”µå­å¯†ç æœ¬ï¼‰ï¼Œå®ƒä¼šå°†ç›¸ç­‰çš„è¾“å…¥å—åŠ å¯†ä¸ºç›¸ç­‰çš„è¾“å‡ºå—ï¼ˆä¸æä¾›å¯†ç æ‰©æ•£ï¼Œ<a href="https://en.wikipedia.org/wiki/Confusion_and_diffusion" target="_blank" rel="noopener">cryptographic diffusion</a>ï¼‰ã€‚ <strong>ä¸è¦ä½¿ç”¨å®ƒï¼</strong> å®ƒå¯èƒ½ä¼šç ´åæ•´ä¸ªåŠ å¯†ç³»ç»Ÿã€‚</li>
<li>è¯¸å¦‚CBCï¼ŒCTRå’ŒGCMæ¨¡å¼ä¹‹ç±»çš„å¤§å¤šæ•°å—å‡æ”¯æŒâ€œéšæœºè®¿é—®â€è§£å¯†ï¼ˆä¾‹å¦‚ï¼Œåœ¨è§†é¢‘æ’­æ”¾å™¨ä¸­çš„ä»»æ„æ—¶é—´åç§»å¤„æœç´¢ï¼Œæ’­æ”¾åŠ å¯†çš„è§†é¢‘æµï¼‰ã€‚</li>
</ul>
<p><strong>CTR (Counter) Block Mode</strong></p>
<p>â€‹ä¸‹å›¾è¯´æ˜äº†å¦‚ä½•åœ¨CTRå—æ“ä½œæ¨¡å¼ä¸‹ä½¿ç”¨å—å¯†ç å¯¹æ˜æ–‡çš„éƒ¨åˆ†ï¼ˆå—ï¼‰è¿›è¡Œé€ä¸ªåŠ å¯†ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/CTR.png" alt="CT" /></p>
<p>â€‹å¯¹äºCTRæ¨¡å¼ä¸‹çš„æ¯ä¸ªå—ï¼Œå°†åŸºäºåˆå§‹å‘é‡ï¼ˆIVï¼Œæœ‰æ—¶ç§°ä¸ºâ€œ nonceâ€ï¼‰+å½“å‰è®¡æ•°å™¨ï¼ˆ01ï¼Œ02ï¼Œ03ï¼Œâ€¦ï¼‰+ åŠ å¯†å¯†é’¥å’Œè¾“å…¥æ¥ç”Ÿæˆæ–°çš„ä¸å¯é¢„æµ‹çš„å¯†é’¥æµå—ä¸å½“å‰å¯†é’¥æµå— XORåˆå¹¶ä»¥ç”Ÿæˆè¾“å‡ºå—ã€‚åœ¨CTRæ¨¡å¼ä¸‹ï¼Œè¾“å…¥æ•°æ®çš„æœ€åéƒ¨åˆ†å¯ä»¥çŸ­äºå¯†ç å—å¤§å°ï¼Œå› æ­¤ä¸éœ€è¦å¡«å……ã€‚ è¾“å…¥æ•°æ®ï¼ˆåŠ å¯†ä¹‹å‰ï¼‰å’Œè¾“å‡ºæ•°æ®ï¼ˆåŠ å¯†ä¹‹åï¼‰å…·æœ‰ç›¸åŒçš„é•¿åº¦ã€‚</p>
<p><strong>GCM (Galois/Counter) Block Mode</strong></p>
<p>ä¸‹å›¾ç›´è§‚åœ°è¯´æ˜äº†GCMå—æ¨¡å¼ï¼ˆGalois /Counterï¼‰çš„å·¥ä½œæ–¹å¼ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/GCM.png" alt="GC" /></p>
<p>GCMæ¨¡å¼ä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè¯¥è®¡æ•°å™¨é’ˆå¯¹æ¯ä¸ªå—å¢åŠ ï¼Œå¹¶åœ¨æ¯ä¸ªå·²å¤„ç†çš„å—ä¹‹åè®¡ç®—æ¶ˆæ¯èº«ä»½éªŒè¯æ ‡ç­¾ï¼ˆMACä»£ç ï¼‰ã€‚ æœ€ç»ˆçš„èº«ä»½éªŒè¯æ ‡ç­¾æ˜¯ä»æœ€åä¸€ä¸ªå—è®¡ç®—å¾—å‡ºçš„ã€‚ ä¸æ‰€æœ‰è®¡æ•°å™¨æ¨¡å¼ä¸€æ ·ï¼ŒGCMç”¨ä½œæµå¯†ç ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªåŠ å¯†çš„æµï¼Œåœ¨å¼€å§‹æ—¶ä½¿ç”¨ä¸åŒçš„IVè‡³å…³é‡è¦ã€‚</p>
<p><code>æ³¨</code>ï¼šè¯·æ³¨æ„ï¼ŒGCMï¼ŒCTRå’Œå…¶ä»–åˆ†ç»„æ¨¡å¼ä¼šæ˜¾ç¤ºåŸå§‹æ¶ˆæ¯çš„é•¿åº¦ï¼Œ å› ä¸ºæ˜æ–‡æ¶ˆæ¯çš„é•¿åº¦ä¸å¯†æ–‡é•¿åº¦ç›¸åŒã€‚ å¦‚æœæ‚¨æƒ³é¿å…æš´éœ²åŸå§‹çš„çº¯æ–‡æœ¬é•¿åº¦ï¼Œå¯ä»¥åœ¨åŠ å¯†ä¹‹å‰å‘çº¯æ–‡æœ¬æ·»åŠ ä¸€äº›éšæœºå­—èŠ‚ï¼Œå¹¶åœ¨è§£å¯†ä¹‹åå°†å…¶åˆ é™¤ã€‚</p>
<h2 id="73-åˆå§‹åŒ–å‘é‡iv"><a class="markdownIt-Anchor" href="#73-åˆå§‹åŒ–å‘é‡iv"></a> 7.3 åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰</h2>
<p>â€‹å¯¹æ¯ä¸ªåŠ å¯†æ¶ˆæ¯ä½¿ç”¨éšæœºä¸”ä¸å¯é¢„æµ‹çš„åˆå§‹åŒ–å‘é‡ ï¼ˆInitialization Vectorï¼ŒIV)ã€‚ ç”¨ç›¸åŒçš„å¯¹ç§°å¯†é’¥å’Œç›¸åŒçš„IVåŠ å¯†å¤šä¸ªæ¶ˆæ¯æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ã€‚ è¿™ä¸ºå¤§å¤šæ•°å—æ¨¡å¼å¼•å…¥äº†å„ç§è¢«æ”»å‡»çš„å¯èƒ½ã€‚ IVçš„å¤§å°åº”ä¸å¯†ç å—çš„å¤§å°ç›¸åŒï¼Œä¾‹å¦‚ AESï¼ŒSerpentå’ŒCamelliaçš„128ä½ã€‚</p>
<p>å¯¹äºGCMæ¨¡å¼ï¼ŒIVå¯èƒ½ä¸æ˜¯ç§˜å¯†ä¸”ä¸å¯é¢„æµ‹çš„ï¼Œä½†å¯¹äºæ¯ä¸ªæ¶ˆæ¯ï¼ŒIVåº”å½“ä¸åŒã€‚</p>
<h2 id="74-è®¤è¯åŠ å¯†"><a class="markdownIt-Anchor" href="#74-è®¤è¯åŠ å¯†"></a> 7.4 è®¤è¯åŠ å¯†</h2>
<p>â€‹åœ¨å¯†ç å­¦ä¸­ï¼Œâ€œè®¤è¯åŠ å¯†â€ï¼ˆ<a href="https://en.wikipedia.org/wiki/Authenticated_encryption" target="_blank" rel="noopener"><strong>authenticated encryption</strong></a>ï¼ŒAEï¼‰çš„æ¦‚å¿µæ˜¯æŒ‡åŠ å¯†æ•°æ®çš„åŒæ—¶è®¡ç®—ç”¨äºæä¾›æ¶ˆæ¯çœŸå®æ€§å’Œå®Œæ•´æ€§çš„è®¤è¯ç ï¼ˆè®¤è¯æ ‡ç­¾/ MACï¼‰çš„æ–¹æ¡ˆã€‚ å¦‚æœä½¿ç”¨è®¤è¯çš„åŠ å¯†æ–¹æ¡ˆï¼Œåˆ™åœ¨è§£å¯†æ—¶å°†çŸ¥é“è§£å¯†æ˜¯å¦æˆåŠŸï¼ˆå³è§£å¯†å¯†é’¥/å¯†ç æ˜¯å¦æ­£ç¡®ä»¥åŠåŠ å¯†æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ï¼‰ã€‚</p>
<p>â€‹èº«ä»½éªŒè¯åŠ å¯†ï¼ˆAEï¼‰ä¸å¸¦æœ‰å…³è”æ•°æ®çš„è®¤è¯åŠ å¯†ï¼ˆ<a href="https://en.wikipedia.org/wiki/Authenticated_encryption#Authenticated_encryption_with_associated_data_(AEAD)" target="_blank" rel="noopener"><strong>authenticated encryption with associated data</strong></a>ï¼Œ<strong>AEAD</strong>ï¼‰ç±»ä¼¼æ¦‚å¿µæœ‰å…³ï¼ŒAEADæ˜¯AEçš„ä¸€ç§æ›´å®‰å…¨çš„å˜ä½“ã€‚AEADä¼šå°†å…³è”æ•°æ®ï¼ˆADï¼‰ç»‘å®šåˆ°å¯†æ–‡ä»¥åŠåº”è¯¥å‡ºç°çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä»¥ä¾¿å¯ä»¥æ£€æµ‹åˆ°å¹¶æ‹’ç»å°†æœ‰æ•ˆå¯†æ–‡â€œå‰ªåˆ‡å¹¶ç²˜è´´â€åˆ°å…¶ä»–ä¸Šä¸‹æ–‡ä¸­çš„å°è¯•ã€‚AEADç”¨äºåŠ å¯†å’ŒæœªåŠ å¯†çš„æ•°æ®ä¸€èµ·ä½¿ç”¨çš„åœºæ™¯ï¼ˆä¾‹å¦‚åœ¨åŠ å¯†çš„ç½‘ç»œåè®®ä¸­ï¼‰ï¼Œå¹¶ç¡®ä¿æ•´ä¸ªæ•°æ®æµéƒ½ç»è¿‡èº«ä»½éªŒè¯å’Œå®Œæ•´æ€§ä¿æŠ¤ã€‚</p>
<p>â€‹ä¸€äº›åŠ å¯†æ–¹æ¡ˆï¼ˆå¦‚ChaCha20-Poly1305å’ŒAES-GCMï¼‰æä¾›é›†æˆçš„èº«ä»½éªŒè¯åŠ å¯†ï¼ˆAEADï¼‰ï¼Œè€Œå¦ä¸€äº›æ–¹æ¡ˆï¼ˆå¦‚AES-CBCå’ŒAES-CTRï¼‰åˆ™éœ€è¦é¢å¤–æ·»åŠ èº«ä»½éªŒè¯ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gogocoding.github.io/2020/03/05/CryptoGraphy/06.%20Symmetric%20and%20Asymmetric%20Encryption%20-%20Overview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hao Qi">
      <meta itemprop="description" content="Mobile developer, also want to be a Gopher">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GoGoCoding">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/05/CryptoGraphy/06.%20Symmetric%20and%20Asymmetric%20Encryption%20-%20Overview/" class="post-title-link" itemprop="url">06. Symmetric and Asymmetric Encryption - Overview</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-05 14:37:17" itemprop="dateCreated datePublished" datetime="2020-03-05T14:37:17+08:00">2020-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-09-08 17:12:44" itemprop="dateModified" datetime="2020-09-08T17:12:44+08:00">2020-09-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CryptoGraphy/" itemprop="url" rel="index"><span itemprop="name">CryptoGraphy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>â€‹åœ¨å¯†ç å­¦ä¸­ï¼Œå¹¿æ³›ä½¿ç”¨äº†ä¸¤ç§ä¸»è¦çš„åŠ å¯†æ–¹æ¡ˆï¼š<code>å¯¹ç§°åŠ å¯†</code>ï¼ˆä½¿ç”¨å•ä¸ªå¯†é’¥æ¥åŠ å¯†å’Œè§£å¯†æ•°æ®ï¼‰å’Œ<code>éå¯¹ç§°åŠ å¯†</code>ï¼ˆä½¿ç”¨å…¬é’¥åŠ å¯†ï¼Œå¹¶ä¸”ä½¿ç”¨å…¬é’¥å¯¹åº”çš„ç§é’¥è¿›è¡Œè§£å¯†ï¼‰ï¼Œä¸‹é¢è¯¦ç»†è§£é‡Šè¿™äº›åŸºæœ¬çš„åŠ å¯†æ¦‚å¿µã€‚<br />
â€‹</p>
<h2 id="61-å¯¹ç§°åŠ å¯†-æ¦‚å¿µå’Œç®—æ³•"><a class="markdownIt-Anchor" href="#61-å¯¹ç§°åŠ å¯†-æ¦‚å¿µå’Œç®—æ³•"></a> 6.1 å¯¹ç§°åŠ å¯†-æ¦‚å¿µå’Œç®—æ³•</h2>
<p>å¯¹ç§°åŠ å¯†æ–¹æ¡ˆä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼ˆæˆ–å¯†ç ï¼‰æ¥åŠ å¯†æ•°æ®å¹¶å°†æ•°æ®è§£å¯†å›å…¶åŸå§‹å½¢å¼ï¼š</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/symmetric%20key%20ciphers.png" alt="symmetric key ciphers -c400" /></p>
<p>å¯¹ç§°åŠ å¯†é€šå¸¸å°†å‡ ç§å¯†ç ç®—æ³•ç»„åˆæˆä¸€ä¸ªå¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼Œä¾‹å¦‚ <code>AES-256-CTR-HMAC-SHA256</code>ã€‚</p>
<p><strong>åŠ å¯†æ–¹æ¡ˆå¯èƒ½åŒ…æ‹¬ï¼š</strong></p>
<ol>
<li>password to <strong>key derivation</strong> algorithm</li>
<li><strong>symmetric cipher</strong> algorithm</li>
<li><strong>cipher block mode</strong> algorithm</li>
<li><strong>message authentication</strong> (MAC) algorithm</li>
</ol>
<p>è¿™æ„å‘³ç€ä¸Šé¢æ˜¾ç¤ºçš„å›¾æ˜¯ç®€åŒ–çš„ï¼Œå¹¶ä¸å®Œå…¨ä»£è¡¨è¯¥è¿‡ç¨‹ã€‚</p>
<h3 id="611-ç§˜é’¥"><a class="markdownIt-Anchor" href="#611-ç§˜é’¥"></a> 6.1.1 ç§˜é’¥</h3>
<p>â€‹ç”¨äºåŠ å¯†ï¼ˆåŠ å¯†ï¼‰å’Œè§£å¯†ï¼ˆè§£å¯†ï¼‰æ•°æ®çš„ç§˜å¯†å¯†é’¥é€šå¸¸å¤§å°ä¸º128ã€192æˆ–256ä½ï¼Œæœ‰æ—¶è¢«ç§°ä¸ºâ€œåŠ å¯†å¯†é’¥â€æˆ–â€œå…±äº«å¯†é’¥â€ï¼Œå› ä¸ºå‘é€æ–¹å’Œæ¥æ”¶æ–¹éƒ½åº”è¯¥çŸ¥é“å®ƒã€‚å¤§å¤šæ•°åº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨ <a href="https://wizardforcel.gitbooks.io/practical-cryptography-for-developers-book/content/part-1-blockchain-networks-concepts/blockchain-cryptography/blockchain-cryptography-overview/hmac-and-key-derivation.html" target="_blank" rel="noopener"><strong>password-to-key-derivation</strong></a>ç”Ÿæ–¹æ¡ˆä»æŸäº›å¯†ç ä¸­æå–ç§˜é’¥ï¼Œå› ä¸ºç”¨æˆ·ç›¸æ¯”äºŒè¿›åˆ¶æ•°æ®æ›´å®¹æ˜“è®°ä½å¯†ç ã€‚æ­¤å¤–ï¼Œæ¶ˆæ¯èº«ä»½éªŒè¯é€šå¸¸ä¸åŠ å¯†ç»“åˆåœ¨ä¸€èµ·ä»¥æä¾›å®Œæ•´æ€§å’ŒçœŸå®æ€§éªŒè¯ã€‚</p>
<p><strong>256-bit secret key</strong> ï¼š<code>02c324648931b89e3e8a0fc42c96e8e3be2e42812986573a40d46563bceaf75110</code></p>
<p><strong>base58</strong>:<code>pbPRqYDxnKZfs8j4KKiqYmx6nzipAjTJf1oCD1WKgy99</code></p>
<p><strong>base64</strong>:<code>AsMkZIkxuJ4+ig/ELJbo474uQoEphlc6QNRlY7zq91EQ</code></p>
<p>åœ¨è®¸å¤šç³»ç»Ÿä¸­ï¼ˆä¾‹å¦‚ï¼Œå…¬å…±åŒºå—é“¾ï¼ŒPGPï¼ŒOpenSSLç­‰ï¼‰ï¼Œå¯†é’¥è¢«ç¼–ç ä¸ºbase58æˆ–base64ï¼Œä»¥ä¾¿äºç”¨è¾ƒçŸ­çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</p>
<h3 id="612-ç°ä»£å¯¹ç§°åŠ å¯†ç®—æ³•"><a class="markdownIt-Anchor" href="#612-ç°ä»£å¯¹ç§°åŠ å¯†ç®—æ³•"></a> 6.1.2 ç°ä»£å¯¹ç§°åŠ å¯†ç®—æ³•</h3>
<p>â€‹åœ¨ç°ä»£å¯†ç å­¦ä¸­ï¼Œå¹¿æ³›ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼š</p>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank" rel="noopener"><strong>AES</strong></a> (AES-128, AES-192, AES-256)ï¼›</li>
<li><a href="https://legacy.gitbook.com/book/svetlin-nakov/practical-blockchain-for-developers-the-big-book/edit#" target="_blank" rel="noopener"><strong>ChaCha20</strong></a>ï¼›</li>
<li><a href="https://en.wikipedia.org/wiki/Twofish" target="_blank" rel="noopener"><strong>Twofish</strong></a>ï¼›</li>
<li><a href="https://en.wikipedia.org/wiki/International_Data_Encryption_Algorithm" target="_blank" rel="noopener"><strong>IDEA</strong></a>ï¼›</li>
<li><a href="https://en.wikipedia.org/wiki/Serpent_(cipher)" target="_blank" rel="noopener"><strong>Serpent</strong></a>ï¼›</li>
<li><a href="https://en.wikipedia.org/wiki/Camellia_(cipher)" target="_blank" rel="noopener"><strong>Camelia</strong></a>ï¼›</li>
</ol>
<p>â€‹å®ƒä»¬ä¸­çš„å¤§å¤šæ•°æ˜¯å—å¯†ç ï¼ˆé€šè¿‡å›ºå®šå¤§å°çš„å—ï¼ˆä¾‹å¦‚128ä½ï¼‰åŠ å¯†æ•°æ®ï¼‰ï¼Œè€Œå¦ä¸€äº›æ˜¯æµå¯†ç ï¼ˆå°†å­—èŠ‚ä½œä¸ºæ•°æ®æµé€å­—èŠ‚åŠ å¯†ï¼‰ã€‚</p>
<p><code>æ³¨</code>ï¼šåœ¨çº¿å¯¹ç§°åŠ å¯†å·¥å…· <a href="https://aesencryption.net/" target="_blank" rel="noopener"><strong>https://aesencryption.net</strong></a>.</p>
<h2 id="62-å…¬é’¥å¯†ç -æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#62-å…¬é’¥å¯†ç -æ¦‚å¿µ"></a> 6.2 å…¬é’¥å¯†ç -æ¦‚å¿µ</h2>
<p>â€‹åœ¨ä»‹ç»éå¯¹ç§°å¯†é’¥åŠ å¯†æ–¹æ¡ˆå’Œç®—æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥é¦–å…ˆäº†è§£å…¬é’¥åŠ å¯†ï¼ˆ<a href="https://en.wikipedia.org/wiki/Public-key_cryptography" target="_blank" rel="noopener"><strong>public key cryptography</strong></a>ï¼Œéå¯¹ç§°ç§˜é’¥ï¼‰çš„æ¦‚å¿µã€‚ ä»–ä½¿ç”¨ä¸åŒçš„å¯†é’¥æ¥åŠ å¯†å’Œè§£å¯†æ•°æ®ï¼ˆæˆ–ç­¾åå’ŒéªŒè¯æ¶ˆæ¯ï¼‰ã€‚å¯†é’¥æ€»æ˜¯ä»¥å…¬é’¥+ç§é’¥å¯¹çš„å½¢å¼å‡ºç°ã€‚éå¯¹ç§°å¯†ç å¤„ç†ä½¿ç”¨å…¬é’¥/ç§é’¥å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œå¯¹æ¶ˆæ¯ç­¾åï¼ŒéªŒè¯ç­¾åå’Œå®‰å…¨åœ°äº¤æ¢<code>å¯†é’¥</code>ã€‚</p>
<p>â€‹æµè¡Œçš„å…¬é’¥å¯†ç ç³»ç»Ÿï¼ˆéå¯¹ç§°å¯†ç ç®—æ³•ï¼‰ï¼Œä¾‹å¦‚<strong>RSA</strong>ï¼ˆRivestâ€“Shamirâ€“Adlemanï¼‰ï¼Œ<strong>ECC</strong>ï¼ˆæ¤­åœ†æ›²çº¿åŠ å¯†ï¼‰ï¼Œ<strong>Diffie-Hellman</strong>ï¼Œ<strong>ECDH</strong>ï¼Œ<strong>ECDSA</strong>å’Œ<strong>EdDSA</strong>ï¼Œå·²å¹¿æ³›ç”¨äºç°ä»£å¯†ç å­¦ä¸­ã€‚</p>
<p>â€‹éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆä½¿ç”¨ä¸€å¯¹ä¸å¯†ç ç›¸å…³çš„å…¬é’¥å’Œç§é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†è§£å¯†ï¼Œå…¶ä¸­å…¬é’¥ç”¨äºåŠ å¯†ï¼Œç§é’¥ç”¨äºè§£å¯†ã€‚</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/public%20key%20encryption%20and%20decryption.png" alt="public key encryption and decryption -c400" /></p>
<p>â€‹ä½œä¸ºåŠ å¯†ç»“æœè€Œè·å¾—çš„åŠ å¯†æ•°æ®è¢«ç§°ä¸ºâ€œ<strong>å¯†æ–‡</strong>â€ã€‚ å¯†æ–‡æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åºåˆ—ï¼Œäººç±»ä¸å¯è¯»ï¼Œå¹¶ä¸”è®¾è®¡ä¸Šå¦‚æœæ²¡æœ‰å¯¹åº”ç§é’¥å°±æ— æ³•è§£å¯†ã€‚</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/asymmetric%20encryption.png" alt="asymmetric encryption -c400" /></p>
<blockquote>
<p>â€‹æ³¨æ„ï¼Œä¸Šé¢æ˜¾ç¤ºçš„å›¾æ˜¯é«˜åº¦ç®€åŒ–çš„ï¼Œå¹¶ä¸å®Œå…¨ä»£è¡¨éå¯¹ç§°åŠ å¯†/è§£å¯†è¿‡ç¨‹ã€‚é€šå¸¸ï¼Œéå¯¹ç§°åŠ å¯†ç³»ç»Ÿåªèƒ½åŠ å¯†æœ‰é™é•¿åº¦çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”æ¯”å¯¹ç§°åŠ å¯†æ…¢ã€‚ ä¸ºäº†åŠ å¯†è¾ƒé•¿çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚PDFæ–‡æ¡£ï¼‰ï¼Œé€šå¸¸ä½¿ç”¨<strong>å…¬é’¥åŠ å¯†æ–¹æ¡ˆ</strong>ï¼ˆä¹Ÿç§°ä¸ºæ··åˆåŠ å¯†æ–¹æ¡ˆï¼‰ï¼Œè¯¥æ–¹æ¡ˆç»“åˆäº†å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
</blockquote>
<ol>
<li>ä¸ºäº†è¿›è¡ŒåŠ å¯†ï¼Œå°†ç”Ÿæˆéšæœºå¯¹ç§°å¯†é’¥<code>sk</code>ï¼Œæ¶ˆæ¯å°†ç”±<code>sk</code>å¯¹ç§°åŠ å¯†ï¼Œç„¶åä½¿ç”¨æ”¶ä»¶äººçš„å…¬é’¥å¯¹<code>sk</code>è¿›è¡Œéå¯¹ç§°åŠ å¯†ã€‚</li>
<li>å¯¹äºè§£å¯†ï¼Œé¦–å…ˆä½¿ç”¨æ¥æ”¶è€…çš„ç§é’¥å¯¹<code>sk</code>å¯†é’¥è¿›è¡Œéå¯¹ç§°è§£å¯†ï¼Œç„¶ååç»­çš„å¯†æ–‡ä½¿ç”¨<code>sk</code>å¯¹ç§°ç§˜é’¥å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ã€‚</li>
</ol>
<p>ä»¥ä¸Šè¿‡ç¨‹ç§°ä¸º <a href="https://en.wikipedia.org/wiki/Key_encapsulation" target="_blank" rel="noopener"><strong>key encapsulation mechanism (KEM)</strong></a>ã€‚</p>
<p>â€‹å…¬é’¥åŠ å¯†ä¹Ÿå¯ä»¥åœ¨ç›¸åçš„æƒ…å†µä¸‹å·¥ä½œï¼šé€šè¿‡ç§é’¥åŠ å¯†æ•°æ®ï¼Œå¹¶é€šè¿‡å…¬é’¥è§£å¯†æ•°æ®ã€‚ å› æ­¤ï¼ŒæŸäººå¯ä»¥è¯æ˜è‡ªå·±æ˜¯æŸäº›ç§é’¥çš„æ‰€æœ‰è€…ã€‚ä¸€äº›æ•°å­—ç­¾åæ–¹æ¡ˆä½¿ç”¨æ­¤æ–¹æ³•ã€‚</p>
<h2 id="63-ç­¾åä¸å¯¹ç§°ç­¾åéªŒè¯"><a class="markdownIt-Anchor" href="#63-ç­¾åä¸å¯¹ç§°ç­¾åéªŒè¯"></a> 6.3 ç­¾åï¼šä¸å¯¹ç§°ç­¾å/éªŒè¯</h2>
<p>â€‹<a href="https://en.wikipedia.org/wiki/Digital_signature" target="_blank" rel="noopener"><strong>digital signatures</strong></a>ï¼šç”±ç§é’¥ç­¾åçš„æ¶ˆæ¯ï¼ˆæ•°å­—ç­¾åï¼‰éšåå°†ç”±ç›¸åº”çš„å…¬é’¥éªŒè¯ã€‚</p>
<p><img src="http://q6r9jgptb.bkt.clouddn.com/mweb/signatures.png" alt="signatures -c400" /></p>
<p>â€‹ç­¾ååä¸èƒ½æ›´æ”¹å·²ç­¾åçš„æ¶ˆæ¯ã€‚ æ¶ˆæ¯ç­¾åè¯æ˜æŸäº›æ¶ˆæ¯ï¼ˆä¾‹å¦‚åŒºå—é“¾äº¤æ˜“ï¼‰æ˜¯ç”±æŸäº›ç§é’¥çš„æ‰€æœ‰è€…åˆ›å»ºçš„ã€‚ æ•°å­—ç­¾åæä¾›æ¶ˆæ¯èº«ä»½éªŒè¯ï¼Œæ¶ˆæ¯å®Œæ•´æ€§å’Œä¸å¯å¦è®¤æ€§ã€‚<br />
â€‹<br />
â€‹æ•°å­—ç­¾ååœ¨é‡‘èè¡Œä¸šä¸­å¹¿æ³›ç”¨äºæˆæƒä»˜æ¬¾ã€‚ åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ“ä½œç³»ç»Ÿç»„ä»¶å’Œè®¾å¤‡é©±åŠ¨ç¨‹åºé€šå¸¸ç»è¿‡æ•°å­—ç­¾åï¼Œä»¥é¿å…åœ¨æ“ä½œç³»ç»Ÿä¸­æ³¨å…¥ä¸å®‰å…¨çš„ä»£ç ï¼Œæœ¨é©¬æˆ–ç—…æ¯’ã€‚åœ¨åŒºå—é“¾ç³»ç»Ÿä¸­ï¼Œäº¤æ˜“é€šå¸¸ç”±æŸäº›åŒºå—é“¾åœ°å€çš„æ‰€æœ‰è€…ç­¾åã€‚</p>
<h2 id="64-å¯†é’¥å¯¹"><a class="markdownIt-Anchor" href="#64-å¯†é’¥å¯¹"></a> 6.4 å¯†é’¥å¯¹</h2>
<p>â€‹å…¬é’¥åŠ å¯†ä½¿ç”¨ä¸€å¯¹å¯†é’¥ï¼š<code>å…¬é’¥</code> + <code>ç§é’¥</code>ã€‚ è¿™äº›å¯†é’¥åœ¨æ•°å­¦ä¸Šæ˜¯ç›¸å…³çš„ï¼Œå¹¶ä¸”è¦æˆå¯¹ä½¿ç”¨ã€‚</p>
<p>åœ¨æŸäº›å…¬é’¥å¯†ç ç³»ç»Ÿï¼ˆä¾‹å¦‚ï¼Œæ¤­åœ†æ›²çº¿å¯†ç -ECCï¼‰ä¸­ï¼Œå¯ä»¥æ ¹æ®ç§é’¥æ¥è®¡ç®—å‡ºå…¬é’¥ã€‚ è€Œåœ¨å…¶ä»–å¯†ç ç³»ç»Ÿï¼ˆå¦‚RSAï¼‰ä¸­ï¼Œå…¬é’¥å’Œç§é’¥æ˜¯ä¸€èµ·ç”Ÿæˆçš„ï¼Œä½†ä¸èƒ½ç›´æ¥ç›¸äº’è®¡ç®—ã€‚</p>
<h3 id="641-ç§é’¥"><a class="markdownIt-Anchor" href="#641-ç§é’¥"></a> 6.4.1 ç§é’¥</h3>
<p>â€‹æ¶ˆæ¯åŠ å¯†å’Œç­¾åæ˜¯é€šè¿‡ç§é’¥å®Œæˆçš„ã€‚ç§é’¥å§‹ç»ˆåƒå¯†ç ä¸€æ ·ç”±å…¶æ‰€æœ‰è€…ä¿å¯†ã€‚åœ¨æœåŠ¡å™¨åŸºç¡€ç»“æ„ä¸­ï¼Œç§é’¥é€šå¸¸é©»ç•™åœ¨åŠ å¯†å’Œå—ä¿æŠ¤çš„å¯†é’¥åº“ä¸­ã€‚åœ¨åŒºå—é“¾ç³»ç»Ÿä¸­ï¼Œç§é’¥é€šå¸¸ä½äºç‰¹å®šçš„è½¯ä»¶æˆ–ç¡¬ä»¶åº”ç”¨ç¨‹åºä¸­ï¼Œç§°ä¸ºâ€œåŠ å¯†é’±åŒ…â€ï¼Œè¿™äº›åº”ç”¨å®‰å…¨åœ°å­˜å‚¨ä¸€ç»„ç§é’¥ã€‚</p>
<h3 id="642-å…¬é’¥"><a class="markdownIt-Anchor" href="#642-å…¬é’¥"></a> 6.4.2 å…¬é’¥</h3>
<p>â€‹æ¶ˆæ¯è§£å¯†å’Œç­¾åéªŒè¯ç”±å…¬ç”¨å¯†é’¥å®Œæˆã€‚ å…¬é’¥åœ¨è®¾è®¡ä¸Šå°±æ˜¯å¯ä»¥è¢«å…±äº«çš„ä¿¡æ¯ï¼ˆä¸æ˜¯ç§˜å¯†ï¼‰ã€‚ ä»ç›¸åº”çš„å…¬é’¥æ¥è®¡ç®—ç§é’¥åœ¨æ•°å­¦ä¸Šæ˜¯ä¸å¯è¡Œçš„ã€‚åœ¨è®¸å¤šç³»ç»Ÿä¸­ï¼Œå…¬é’¥è¢«å°è£…åœ¨æ•°å­—è¯ä¹¦ä¸­ï¼Œè¯¥è¯ä¹¦å°†æŸäº›èº«ä»½ï¼ˆä¾‹å¦‚äººæˆ–äº’è”ç½‘åŸŸåï¼‰ç»‘å®šåˆ°å…¬é’¥ä¸Šã€‚åœ¨åŒºå—é“¾ç³»ç»Ÿä¸­ï¼Œå…¬é’¥é€šå¸¸ä½œä¸ºåŒºå—é“¾äº¤æ˜“çš„ä¸€éƒ¨åˆ†å‘å¸ƒï¼Œä»¥å¸®åŠ©è¯†åˆ«è°ç­¾ç½²äº†è¿™ä¸ªäº¤æ˜“ã€‚åœ¨PGPå’ŒSSHä¹‹ç±»çš„ç³»ç»Ÿä¸­ï¼Œå…¬é’¥æ˜¯ä»æœåŠ¡å™¨ä¸‹è½½ä¸€æ¬¡çš„ï¼ˆåœ¨æ‰‹åŠ¨ç”¨æˆ·éªŒè¯ä¹‹åï¼‰ï¼Œå¹¶ä¸”ä¼šè¢«è®°ä½ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚åœ¨å¤§å¤šæ•°åŒºå—é“¾ç³»ç»Ÿä¸­ï¼ŒåŒºå—é“¾åœ°å€æ˜¯ä»å…¬é’¥æ´¾ç”Ÿçš„ï¼ˆé€šè¿‡å“ˆå¸Œå’Œå…¶ä»–è½¬æ¢ï¼‰ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨æ‹¥æœ‰æŸäººçš„å…¬é’¥ï¼Œåˆ™å‡å®šæ‚¨ä¹Ÿæ‹¥æœ‰ä»–çš„åŒºå—é“¾åœ°å€ã€‚</p>
<p>â€‹æŸä¸ªå…¬é’¥å¯ä»¥è¿æ¥åˆ°æŸä¸ªäººæˆ–ç»„ç»‡ï¼Œä¹Ÿå¯ä»¥åŒ¿åä½¿ç”¨ã€‚é™¤éæ‚¨æœ‰å…¶ä»–è¯æ˜ï¼Œå¦åˆ™æ‚¨æ°¸è¿œä¸ä¼šçŸ¥é“è°æ˜¯ä¸æŸäº›å…¬é’¥ç›¸å¯¹åº”çš„ç§é’¥çš„æ‰€æœ‰è€…ï¼Œè¯æ˜å¦‚ æ•°å­—è¯ä¹¦ <a href="https://en.wikipedia.org/wiki/Public_key_certificate" target="_blank" rel="noopener"><strong>digital certificate</strong></a>ã€‚</p>
<h3 id="643-æµè¡Œçš„éå¯¹ç§°åŠ å¯†ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#643-æµè¡Œçš„éå¯¹ç§°åŠ å¯†ç³»ç»Ÿ"></a> 6.4.3 æµè¡Œçš„éå¯¹ç§°åŠ å¯†ç³»ç»Ÿ</h3>
<p>â€‹ä¼—æ‰€å‘¨çŸ¥çš„éå¯¹ç§°åŠ å¯†ç³»ç»Ÿæœ‰ï¼š<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener"><strong>RSA</strong></a>, <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" target="_blank" rel="noopener"><strong>ECC</strong></a> and <a href="https://en.wikipedia.org/wiki/ElGamal_encryption" target="_blank" rel="noopener"><strong>ElGamal</strong></a>ã€‚</p>
<p><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener">**RSA **</a> ï¼šåŸºäºæ¨¡å¹‚çš„æ•°å­¦è¿ç®—ï¼ˆæ•°å­—ä¹˜ä»¥æ¨¡çš„å¹‚ï¼‰å’Œä¸€äº›å…¶ä»–å‡è®¾ä»¥åŠæ•´æ•°åˆ†è§£é—®é¢˜çš„è®¡ç®—éš¾åº¦ã€‚</p>
<p><a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" target="_blank" rel="noopener"><strong>elliptic-curve cryptography (ECC) public-key cryptosystem</strong></a> ï¼šåŸºäºæœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿çš„ä»£æ•°ç»“æ„çš„æ•°å­¦æ¨¡å‹å’Œæ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆ <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Rationale" target="_blank" rel="noopener"><strong>elliptic curve discrete logarithm problem ï¼ŒECDLP</strong></a>ï¼‰çš„éš¾åº¦ã€‚</p>
<p><code>æ³¨</code>ï¼šä¸€èˆ¬æƒ…å†µä¸‹å»ºè®®ä½¿ç”¨<code>ECC</code>ï¼Œ<code>ECC</code>ä½¿ç”¨çš„å¯†é’¥ï¼Œå¯†æ–‡å’Œç­¾åæ¯”RSAå°ã€‚ åœ¨æ•°å­¦ä¸Šå·²è¯æ˜3072ä½<code>RSA</code>å¯†é’¥å…·æœ‰ä¸256ä½<code>ECC</code>å¯†é’¥ç›¸ä¼¼çš„åŠ å¯†å¼ºåº¦ã€‚ <code>ECC</code>ä¸­çš„å¯†é’¥æ•ˆç‡æ˜¾è‘—é«˜äº<code>RSA</code>ã€‚ç”±äºä¸Šè¿°åŸå› ï¼Œå¤§å¤šæ•°åŒºå—é“¾ç½‘ç»œï¼ˆå¦‚æ¯”ç‰¹å¸å’Œä»¥å¤ªåŠï¼‰éƒ½ä½¿ç”¨åŸºäºæ¤­åœ†æ›²çº¿çš„å¯†ç å­¦ï¼ˆECCï¼‰æ¥ä¿æŠ¤äº¤æ˜“ã€‚æ³¨æ„ï¼Œ<code>RSA</code>å’Œ<code>ECC</code>å¯†ç ç³»ç»Ÿéƒ½ä¸æ˜¯é‡å­å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœæŸäººæ‹¥æœ‰è¶³å¤Ÿå¼ºå¤§çš„é‡å­è®¡ç®—æœºï¼Œåˆ™ä»–å°†èƒ½å¤Ÿåœ¨çŸ­çŸ­å‡ ç§’é’Ÿå†…ä»ç»™å®šçš„å…¬é’¥ä¸­å¯¼å‡ºç§é’¥ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Hao Qi</p>
  <div class="site-description" itemprop="description">Mobile developer, also want to be a Gopher</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/GoGoCoding" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;GoGoCoding" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:it_haoqi@163.com" title="E-Mail â†’ mailto:it_haoqi@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hao Qi</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">


  

</body>
</html>
